<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>1001-1031æ¨™ç±¤æ¥­ç¸¾ç«¶è³½æˆ°å ±</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Microsoft JhengHei', Arial, sans-serif;
            background: linear-gradient(135deg, #d3d3d3 0%, #797979 100%);
            padding: 20px;
            min-height: 100vh;
        }
        
        .container {
            max-width: 1600px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            overflow: hidden;
        }
        
        .header {
            background: #00548b;
            color: white;
            padding: 5px;
            text-align: center;
        }
        
        .header h1 {
            font-size: 2em;
        }
        
        .statistics-info {
            margin-top: 0px;
            font-size: 1em;
            color: #666;
        }

        .total-amount {
            color: #2196f3;
            font-weight: bold;
        }

        .baseline {
            color: #666;
        }

        .growth-rate {
            font-weight: bold;
        }

        .growth-rate.positive {
            color: #4caf50;
        }

        .growth-rate.negative {
            color: #f44336;
        }

        .update-time {
            background: #e3f2fd;
            padding: 5px;
            text-align: center;
            font-weight: bold;
            color: #1976d2;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }
        
        .calendar-icon {
            color: #dc3545;
            font-size: 16px;
        }


        /* ä¸»å°èˆª - é‡‘é¡ç©åˆ† vs å®¢æˆ¶æ•¸ç©åˆ† */
        .main-nav {
            display: flex;
            background: #595959;
            color: white;
            overflow: hidden;
        }
        
        .main-nav-item {
            flex: 1;
            padding: 4px 20px;
            background: #585858;
            color: white;
            border: none;
            border-bottom: 3px solid transparent;
            font-size: 0.95em;
            cursor: pointer;
            transition: all 0.3s ease;
            white-space: nowrap;
        }
        
        .main-nav-item:hover {
            background: #323232;
        }
        
        .main-nav-item.active {
            background: #909090;
            border-bottom: 3px solid #ffdd00;
        }
        
        .main-nav-item:not(:last-child)::after {
            content: '';
            position: absolute;
            right: 0;
            top: 25%;
            height: 50%;
            width: 1px;
            background: rgba(255,255,255,0.3);
        }
        
        /* å­å°èˆª - çµ„åˆ¥é¸æ“‡ */
        .sub-nav {
            background: #979797;
            padding: 0;
        }
        
        /* æ¨™ç±¤çµ„é¡¯ç¤ºæ§åˆ¶ */
        .tab-group {
            display: none;
            gap: 0;
        }
        
        .tab-group.active {
            display: flex;
        }
        
        .group-tabs {
            display: flex;
            justify-content: center;
            gap: 0;
            overflow-x: auto;
        }
        
        .group-tab {
            padding: 4px 20px;
            background: #979797;
            color: white;
            border: none;
            border-bottom: 3px solid transparent;
            font-size: 0.95em;
            cursor: pointer;
            transition: all 0.3s ease;
            white-space: nowrap;
        }
        
        .group-tab span {
            font-weight: normal;
            opacity: 0.9;
            margin-left: 5px;
            font-size: 0.9em;
        }
        
        .group-tab:hover {
            background: #2c3e50;
        }
        
        .group-tab.active {
            background: #3498db;
            border-bottom-color: #ffdd00;
        }
        
        .tab-content {
            display: none;
            padding: 0;
        }

        /* çµ±è¨ˆå„€è¡¨ç‰ˆæ¨£å¼ */
        .dashboard {
            padding: 20px;
        }
        .kpi-grid {
            display: grid;
            grid-template-columns: repeat(6, minmax(160px, 1fr));
            gap: 14px;
            margin-bottom: 20px;
        }
        .kpi-card {
            background: #ffffff;
            border: 1px solid #818181;
            border-radius: 10px;
            padding: 12px 14px;
            box-shadow: 0 4px 10px rgba(0,0,0,0.05);
        }
        .kpi-title {
            font-size: 0.85em;
            color: #666;
            margin-bottom: 6px;
        }
        .kpi-value {
            font-size: 1.5em;
            font-weight: bold;
            color: #333;
        }
        .kpi-sub {
            font-size: 0.8em;
            color: #888;
            margin-top: 4px;
        }
        .chart-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 16px;
        }
        .chart-placeholder {
            background: #fafafa;
            border: 1px dashed #ccc;
            border-radius: 10px;
            min-height: 260px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #999;
        }
        
        .tab-content.active {
            display: block;
        }
        
        .table-container {
            overflow-x: auto;
            max-height: 680px;
            overflow-y: auto;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
            font-size: 13px;
        }
        
        th {
            background: linear-gradient(135deg, #34495e 0%, #2c3e50 100%);
            color: white;
            padding: 12px 6px;
            text-align: center;
            font-weight: bold;
            position: sticky;
            top: 0;
            z-index: 10;
            border-right: 1px solid #2c3e50;
            font-size: 12px;
            cursor: pointer;
            -webkit-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            user-select: none;
            transition: background-color 0.2s ease;
        }
        
        th:hover {
            background: linear-gradient(135deg, #3498db 0%, #2980b9 100%);
        }
        
        th.sortable {
            -webkit-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            user-select: none;
        }
        
        th.sortable::after {
            content: ' â†•ï¸';
            font-size: 12px;
            margin-left: 5px;
        }
        
        th.sort-asc::after {
            content: ' â†‘';
            color: #e74c3c;
            font-weight: bold;
        }
        
        th.sort-desc::after {
            content: ' â†“';
            color: #e74c3c;
            font-weight: bold;
        }
        
        td {
            padding: 8px 6px;
            text-align: center;
            border-bottom: 1px solid #ecf0f1;
            border-right: 1px solid #ecf0f1;
            font-size: 14px;
        }
        
        tr:nth-child(even) {
            background-color: #f8f9fa;
        }
        
        tr:hover {
            background-color: #e3f2fd;
            transition: all 0.2s ease;
        }
        
        .group-a { border-left: 4px solid #2196F3; }
        .group-b { border-left: 4px solid #FF9800; }
        .group-c { border-left: 4px solid #9C27B0; }
        
        .score-excellent { color: #27ae60; font-weight: bold; }
        .score-good { color: #f39c12; font-weight: bold; }
        .score-poor { color: #e74c3c; }
        
        .performance-status {
            font-weight: bold;
            padding: 2px 4px;
            border-radius: 3px;
            font-size: 0.9em;
            background: #f8d7da;
            color: #721c24;
        }
        
        .store-name {
            font-weight: bold;
            color: #2c3e50;
            text-align: center;
            max-width: 140px;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }
        
        .group-badge {
            display: inline-block;
            padding: 3px 6px;
            border-radius: 12px;
            font-size: 12px;
            font-weight: bold;
            color: white;
            margin-left: 3px;
        }
        
        .badge-a { background: #2196F3; }
        .badge-b { background: #FF9800; }
        .badge-c { background: #9C27B0; }
        
        .region-badge {
            display: inline-block;
            padding: 2px 5px;
            border-radius: 8px;
            font-size: 12px;
            font-weight: bold;
            color: white;
            margin-left: 2px;
        }
        
        .region-æ–°å‰µ { background: #e74c3c; }
        .region-ç‡Ÿä¸€ { background: #9b59b6; }
        .region-ç‡ŸäºŒ { background: #3498db; }
        .region-ç‡Ÿä¸‰ { background: #1abc9c; }
        .region-åŒ—å€ { background: #f39c12; }
        .region-ä¸­å€ { background: #27ae60; }
        .region-å—å€ { background: #e67e22; }
        
        .number-cell {
            font-family: 'Courier New', monospace;
            font-weight: bold;
        }
        
        .qualified {
            background: #d4edda !important;
            color: #155724;
            font-weight: bold;
        }
        
        .threshold-info {
            font-size: 16px;
            color: #6c757d;
            margin-top: 10px;
            padding: 2px;
            background: #f8f9fa;
            border-radius: 5px;
        }
        
        .sort-info {
            font-size: 12px;
            color: #3498db;
            background: #ebf3fd;
            padding: 8px;
            border-radius: 5px;
            margin-bottom: 5px;
            text-align: center;
        }
        
        /* è‡ªæˆ‘å®£å‘Šé”æˆç‡æ¨£å¼ */
        .self-declared-rate {
            font-weight: bold;
            padding: 2px 4px;
            border-radius: 3px;
        }

        .performance-status {
            display: inline-block;
            padding: 2px 6px;
            border-radius: 3px;
            background-color: #fff3cd;
            color: #856404;
            font-size: 0.9em;
        }
        
        .rate-excellent { background: #d4edda; color: #155724; }
        .rate-good { background: #fff3cd; color: #856404; }
        .rate-poor { background: #f8d7da; color: #721c24; }
        
        /* ä¸­å’Œæ¯”ä¾‹æ¨£å¼ */
        .zhonghe-ratio {
            font-size: 13px;
            padding: 2px 4px;
            border-radius: 3px;
            font-weight: bold;
        }
        
        .ratio-high { background: #d4edda; color: #155724; }
        .ratio-medium { background: #fff3cd; color: #856404; }
        .ratio-low { background: #f8d7da; color: #721c24; }
        
        .ratio-high::after {
            content: ' âœ…';
            margin-left: 4px;
        }

        /* ç¸½è¨ˆåˆ—æ¨£å¼ */
        .total-row {
            background-color: #f8f9fa !important;
            font-weight: bold;
        }
        
        .total-row td {
            border-top: 2px solid #dee2e6;
        }

        /* çµ„åˆ¥çµ±è¨ˆä¿¡æ¯æ¨£å¼ */
        [id$="-stats"] {
            margin: 5px 0;
            font-size: 0.9em;
            color: #1976d2;
            background-color: #e3f2fd;
            padding: 3px 8px;
            border-radius: 4px;
            display: inline-block;
        }
        
        /* æ–°å¢é”æ¨™çµ±è¨ˆå€å¡Š */
        .achievement-stats {
            background: #fff3e0;
            padding: 15px;
            margin: 15px 20px;
            border-radius: 8px;
            border-left: 4px solid #ff9800;
        }
        
        .achievement-stats h4 {
            color: #e65100;
            margin-bottom: 10px;
            font-size: 14px;
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 10px;
        }
        
        .stat-item {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 12px;
        }
        
        .stat-icon {
            font-size: 16px;
        }
        .qualified::after {
            content: ' âœ…';
            margin-left: 4px;
        }

        @media (max-width: 768px) {
            .header h1 { font-size: 1.8em; }
            table { font-size: 11px; }
            th, td { padding: 6px 3px; }
            .store-name { max-width: 100px; }
            .group-tab { padding: 10px 15px; font-size: 0.9em; }
            .main-nav { flex-direction: column; }
            .group-tabs { flex-wrap: wrap; }
        }

    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸ† 1001-1031æ¨™ç±¤ç«¶è³½æˆ°å ±</h1>
        </div>
        
        <!-- æ•¸æ“šæ›´æ–°æ™‚é–“ -->
        <div class="update-time">
            <span class="calendar-icon">ğŸ“…</span>
            æ•¸æ“šæ›´æ–°æ™‚é–“ï¼š2024å¹´11æœˆ7æ—¥
        </div>
        
        <!-- ä¸»å°èˆª - é‡‘é¡ç©åˆ† vs å®¢æˆ¶æ•¸ç©åˆ† -->
        <div class="main-nav">
            <button class="main-nav-item active" onclick="switchMainTab('amount')">
                é‡‘é¡ç©åˆ†è³½
            </button>
            <button class="main-nav-item" onclick="switchMainTab('customer')">
                å®¢æˆ¶æ•¸ç©åˆ†è³½
            </button>
            <button class="main-nav-item" onclick="switchMainTab('region')">
                å€åŸŸåˆ†æ
            </button>
            <button class="main-nav-item" onclick="switchMainTab('outsource')">
                å§”å¤–/ä¸­å’Œåˆ†æ
            </button>
            <button class="main-nav-item" onclick="switchMainTab('statistics')">
                çµ±è¨ˆå„€è¡¨ç‰ˆ
            </button>
        </div>
        
        <!-- å­å°èˆª - çµ„åˆ¥é¸æ“‡ -->
        <div class="sub-nav">
            <div class="group-tabs">
                <!-- é‡‘é¡ç©åˆ†æ™‚é¡¯ç¤ºçš„æ¨™ç±¤ -->
                <div id="amount-tabs" class="tab-group active">
                    <button class="group-tab active" onclick="switchGroupTab('group-a')">â­ Açµ„-æ–°æ˜ŸæŒ‘æˆ°çµ„(é–€æª»:25000) | æœ¬æœŸé‡‘é¡ç©åˆ†ç¸½åˆï¼š<span id="group-a-amount">è¼‰å…¥ä¸­...</span></button>
                    <button class="group-tab" onclick="switchGroupTab('group-b')">ğŸš€ Bçµ„-é£›è€€æˆé•·çµ„(é–€æª»ï¼š35000) | æœ¬æœŸé‡‘é¡ç©åˆ†ç¸½åˆï¼š<span id="group-b-amount">è¼‰å…¥ä¸­...</span></button>
                    <button class="group-tab" onclick="switchGroupTab('group-c')">ğŸ‘‘ Cçµ„-ç¶“å…¸èè‹±çµ„(é–€æª»ï¼š45000) | æœ¬æœŸé‡‘é¡ç©åˆ†ç¸½åˆï¼š<span id="group-c-amount">è¼‰å…¥ä¸­...</span></button>
                </div>
                
                <!-- å®¢æˆ¶æ•¸ç©åˆ†æ™‚é¡¯ç¤ºçš„æ¨™ç±¤ -->
                <div id="customer-tabs" class="tab-group">
                    <button class="group-tab active" onclick="switchGroupTab('customer-ab')">â­ğŸš€ A+Bçµ„åˆä½µåˆ†è³½(ç©åˆ†é–€æª»:60åˆ†)</button>
                    <button class="group-tab" onclick="switchGroupTab('customer-c')">ğŸ‘‘ Cçµ„åˆ†è³½(ç©åˆ†é–€æª»30åˆ†)</button>
                </div>
                <!-- å€åŸŸåˆ†ææ™‚é¡¯ç¤ºçš„æ¨™ç±¤ -->
                <div id="region-tabs" class="tab-group">
                    <button class="group-tab active" onclick="switchGroupTab('region-ç‡Ÿä¸€')">ğŸ¢ ç‡Ÿä¸€</button>
                    <button class="group-tab" onclick="switchGroupTab('region-ç‡ŸäºŒ')">ğŸ¢ ç‡ŸäºŒ</button>
                    <button class="group-tab" onclick="switchGroupTab('region-ç‡Ÿä¸‰')">ğŸ¢ ç‡Ÿä¸‰</button>
                    <button class="group-tab" onclick="switchGroupTab('region-åŒ—å€')">ğŸŒ åŒ—å€</button>
                    <button class="group-tab" onclick="switchGroupTab('region-ä¸­å€')">ğŸŒ ä¸­å€</button>
                    <button class="group-tab" onclick="switchGroupTab('region-å—å€')">ğŸŒ å—å€</button>
                    <button class="group-tab" onclick="switchGroupTab('region-æ–°å‰µ')">ğŸš€ æ–°å‰µ</button>
                </div>

                <!-- çµ±è¨ˆå„€è¡¨ç‰ˆæ™‚é¡¯ç¤ºçš„æ¨™ç±¤ï¼ˆé ç•™ï¼Œæš«ç„¡å­æ¨™ç±¤ï¼‰ -->
                <div id="statistics-tabs" class="tab-group">
                </div>
            </div>
        </div>
        
        <!-- é‡‘é¡ç©åˆ†å…§å®¹å€ -->
        <div id="amount-content" class="tab-content active">
            <!-- Açµ„åˆ†é  -->
            <div id="group-a" class="tab-content active">
                <div class="sort-info" id="sort-info-group-a">ç›®å‰æ’åºï¼šä¾å¹³å‡ç©åˆ†æ’å</div>
                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th class="sortable" data-field="avgRank">å¹³å‡ç©åˆ†æ’å</th>
                                <th class="sortable" data-field="storeName">é–€å¸‚åç¨±</th>
                                <th class="sortable" data-field="region">å€åŸŸ</th>
                                <th class="sortable" data-field="augustScore">8æœˆé‡‘é¡ç©åˆ†</th>
                                <th class="sortable" data-field="septemberScore">9æœˆé‡‘é¡ç©åˆ†</th>
                                <th class="sortable" data-field="amountScore">10æœˆé‡‘é¡ç©åˆ†</th>
                                <th class="sortable" data-field="avgScore">å¹³å‡ç©åˆ†</th>
                                <th class="sortable" data-field="è‡ªæˆ‘å®£å‘Šç›®æ¨™">è‡ªæˆ‘å®£å‘Šç›®æ¨™</th>
                                <th class="sortable" data-field="è‡ªæˆ‘å®£å‘Šé”æˆç‡">è‡ªæˆ‘å®£å‘Šé”æˆç‡</th>
                                <th class="sortable" data-field="augä¸­å’Œé‡‘é¡ä½”æ¯”">8æœˆä¸­å’Œé‡‘é¡ä½”æ¯”</th>
                                <th class="sortable" data-field="sepä¸­å’Œé‡‘é¡ä½”æ¯”">9æœˆä¸­å’Œé‡‘é¡ä½”æ¯”</th>
                                <th class="sortable" data-field="octä¸­å’Œé‡‘é¡ä½”æ¯”">10æœˆä¸­å’Œé‡‘é¡ä½”æ¯”</th>
                                <th class="sortable" data-field="totalä¸­å’Œé‡‘é¡ä½”æ¯”">ä¸‰å€‹æœˆä¸­å’Œé‡‘é¡ä½”æ¯”</th>
                            </tr>
                        </thead>
                        <tbody id="group-a-table">
                        </tbody>
                    </table>
                </div>
            </div>
            
            <!-- Bçµ„åˆ†é  -->
            <div id="group-b" class="tab-content">
                <div class="sort-info" id="sort-info-group-b">ç›®å‰æ’åºï¼šä¾å¹³å‡ç©åˆ†æ’å</div>
                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th class="sortable" data-field="avgRank">å¹³å‡ç©åˆ†æ’å</th>
                                <th class="sortable" data-field="storeName">é–€å¸‚åç¨±</th>
                                <th class="sortable" data-field="region">å€åŸŸ</th>
                                <th class="sortable" data-field="augustScore">8æœˆé‡‘é¡ç©åˆ†</th>
                                <th class="sortable" data-field="septemberScore">9æœˆé‡‘é¡ç©åˆ†</th>
                                <th class="sortable" data-field="amountScore">10æœˆé‡‘é¡ç©åˆ†</th>
                                <th class="sortable" data-field="avgScore">å¹³å‡ç©åˆ†</th>
                                <th class="sortable" data-field="è‡ªæˆ‘å®£å‘Šç›®æ¨™">è‡ªæˆ‘å®£å‘Šç›®æ¨™</th>
                                <th class="sortable" data-field="è‡ªæˆ‘å®£å‘Šé”æˆç‡">è‡ªæˆ‘å®£å‘Šé”æˆç‡</th>
                                <th class="sortable" data-field="augä¸­å’Œé‡‘é¡ä½”æ¯”">8æœˆä¸­å’Œé‡‘é¡ä½”æ¯”</th>
                                <th class="sortable" data-field="sepä¸­å’Œé‡‘é¡ä½”æ¯”">9æœˆä¸­å’Œé‡‘é¡ä½”æ¯”</th>
                                <th class="sortable" data-field="octä¸­å’Œé‡‘é¡ä½”æ¯”">10æœˆä¸­å’Œé‡‘é¡ä½”æ¯”</th>
                                <th class="sortable" data-field="totalä¸­å’Œé‡‘é¡ä½”æ¯”">ä¸‰å€‹æœˆä¸­å’Œé‡‘é¡ä½”æ¯”</th>
                                
                            </tr>
                        </thead>
                        <tbody id="group-b-table">
                        </tbody>
                    </table>
                </div>
            </div>
            
            <div id="group-c" class="tab-content">
                <div class="sort-info" id="sort-info-group-c">ç›®å‰æ’åºï¼šä¾å¹³å‡ç©åˆ†æ’å</div>
                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th class="sortable" data-field="avgRank">å¹³å‡ç©åˆ†æ’å</th>
                                <th class="sortable" data-field="storeName">é–€å¸‚åç¨±</th>
                                <th class="sortable" data-field="region">å€åŸŸ</th>
                                <th class="sortable" data-field="augustScore">8æœˆé‡‘é¡ç©åˆ†</th>
                                <th class="sortable" data-field="septemberScore">9æœˆé‡‘é¡ç©åˆ†</th>
                                <th class="sortable" data-field="amountScore">10æœˆé‡‘é¡ç©åˆ†</th>
                                <th class="sortable" data-field="avgScore">å¹³å‡ç©åˆ†</th>
                                <th class="sortable" data-field="è‡ªæˆ‘å®£å‘Šç›®æ¨™">è‡ªæˆ‘å®£å‘Šç›®æ¨™</th>
                                <th class="sortable" data-field="è‡ªæˆ‘å®£å‘Šé”æˆç‡">è‡ªæˆ‘å®£å‘Šé”æˆç‡</th>
                                <th class="sortable" data-field="augä¸­å’Œé‡‘é¡ä½”æ¯”">8æœˆä¸­å’Œé‡‘é¡ä½”æ¯”</th>
                                <th class="sortable" data-field="sepä¸­å’Œé‡‘é¡ä½”æ¯”">9æœˆä¸­å’Œé‡‘é¡ä½”æ¯”</th>
                                <th class="sortable" data-field="octä¸­å’Œé‡‘é¡ä½”æ¯”">10æœˆä¸­å’Œé‡‘é¡ä½”æ¯”</th>
                                <th class="sortable" data-field="totalä¸­å’Œé‡‘é¡ä½”æ¯”">ä¸‰å€‹æœˆä¸­å’Œé‡‘é¡ä½”æ¯”</th>
                                
                            </tr>
                        </thead>
                        <tbody id="group-c-table">
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
        
        <!-- å®¢æˆ¶æ•¸ç©åˆ†å…§å®¹å€ -->
        <div id="customer-content" class="tab-content">            
            <!-- A+Bçµ„åˆä½µåˆ†è³½ -->
            <div id="customer-ab" class="tab-content active">
                <div class="sort-info">ç›®å‰æ’åºï¼šä¾å¹³å‡å®¢æˆ¶æ•¸æ’å (å›ºå®š)</div>
                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th class="sortable" data-field="customerAvgRank">å®¢æˆ¶æ•¸ç©åˆ†å¹³å‡æ’å</th>
                                <th class="sortable" data-field="storeName">é–€å¸‚åç¨±</th>
                                <th class="sortable" data-field="group">çµ„åˆ¥</th>
                                <th class="sortable" data-field="region">å€åŸŸ</th>
                                <th class="sortable" data-field="augustCustomerScore">8æœˆå®¢æˆ¶æ•¸ç©åˆ†</th>
                                <th class="sortable" data-field="septemberCustomerScore">9æœˆå®¢æˆ¶æ•¸ç©åˆ†</th>
                                <th class="sortable" data-field="customerScore">10æœˆå®¢æˆ¶æ•¸ç©åˆ†</th>
                                <th class="sortable" data-field="averageCustomerScore">å¹³å‡å®¢æˆ¶æ•¸ç©åˆ†</th>
                                <th class="sortable" data-field="augä¸­å’Œé‡‘é¡ä½”æ¯”">8æœˆä¸­å’Œé‡‘é¡ä½”æ¯”</th>
                                <th class="sortable" data-field="sepä¸­å’Œé‡‘é¡ä½”æ¯”">9æœˆä¸­å’Œé‡‘é¡ä½”æ¯”</th>
                                <th class="sortable" data-field="octä¸­å’Œé‡‘é¡ä½”æ¯”">10æœˆä¸­å’Œé‡‘é¡ä½”æ¯”</th>
                                <th class="sortable" data-field="totalä¸­å’Œé‡‘é¡ä½”æ¯”">ä¸‰å€‹æœˆä¸­å’Œé‡‘é¡ä½”æ¯”</th>
                            </tr>
                        </thead>
                        <tbody id="customer-ab-table">
                        </tbody>
                    </table>
                </div>
            </div>
            
            <!-- Cçµ„ç¨ç«‹åˆ†è³½ -->
            <div id="customer-c" class="tab-content">
                <div class="sort-info">ç›®å‰æ’åºï¼šä¾å¹³å‡å®¢æˆ¶æ•¸æ’å (å›ºå®š)</div>
                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th class="sortable" data-field="customerAvgRank">å®¢æˆ¶æ•¸ç©åˆ†å¹³å‡æ’å</th>
                                <th class="sortable" data-field="storeName">é–€å¸‚åç¨±</th>
                                <th class="sortable" data-field="group">çµ„åˆ¥</th>
                                <th class="sortable" data-field="region">å€åŸŸ</th>
                                <th class="sortable" data-field="augustCustomerScore">8æœˆå®¢æˆ¶æ•¸ç©åˆ†</th>
                                <th class="sortable" data-field="septemberCustomerScore">9æœˆå®¢æˆ¶æ•¸ç©åˆ†</th>
                                <th class="sortable" data-field="customerScore">10æœˆå®¢æˆ¶æ•¸ç©åˆ†</th>
                                <th class="sortable" data-field="averageCustomerScore">å¹³å‡å®¢æˆ¶æ•¸ç©åˆ†</th>
                                <th class="sortable" data-field="augä¸­å’Œé‡‘é¡ä½”æ¯”">8æœˆä¸­å’Œé‡‘é¡ä½”æ¯”</th>
                                <th class="sortable" data-field="sepä¸­å’Œé‡‘é¡ä½”æ¯”">9æœˆä¸­å’Œé‡‘é¡ä½”æ¯”</th>
                                <th class="sortable" data-field="octä¸­å’Œé‡‘é¡ä½”æ¯”">10æœˆä¸­å’Œé‡‘é¡ä½”æ¯”</th>
                                <th class="sortable" data-field="totalä¸­å’Œé‡‘é¡ä½”æ¯”">ä¸‰å€‹æœˆä¸­å’Œé‡‘é¡ä½”æ¯”</th>
                            </tr>
                        </thead>
                        <tbody id="customer-c-table">
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
        <!-- å€åŸŸåˆ†æå…§å®¹å€ -->
        <div id="region-content" class="tab-content">
            <!-- ç‡Ÿä¸€ -->
            <div id="region-ç‡Ÿä¸€" class="tab-content active">
                <div class="sort-info" id="sort-info-region-ç‡Ÿä¸€">ç›®å‰æ’åºï¼šä¾é–€å¸‚åç¨± (å›ºå®š)</div>
                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th class="sortable" data-field="storeName">é–€å¸‚åç¨±</th>
                                <th class="sortable" data-field="group">çµ„åˆ¥</th>
                                <th class="sortable" data-field="augustScore">8æœˆé‡‘é¡ç©åˆ†</th>
                                <th class="sortable" data-field="septemberScore">9æœˆé‡‘é¡ç©åˆ†</th>
                                <th class="sortable" data-field="amountScore">10æœˆé‡‘é¡ç©åˆ†</th>
                                <th class="sortable" data-field="avgScore">å¹³å‡é‡‘é¡ç©åˆ†</th>
                                <th class="sortable" data-field="augustCustomerScore">8æœˆå®¢æˆ¶æ•¸ç©åˆ†</th>
                                <th class="sortable" data-field="septemberCustomerScore">9æœˆå®¢æˆ¶æ•¸ç©åˆ†</th>
                                <th class="sortable" data-field="customerScore">10æœˆå®¢æˆ¶æ•¸ç©åˆ†</th>
                                <th class="sortable" data-field="averageCustomerScore">å¹³å‡å®¢æˆ¶æ•¸ç©åˆ†</th>
                                <th class="sortable" data-field="auguståŸå§‹æ¥­ç¸¾">8æœˆåŸå§‹æ¥­ç¸¾</th>
                                <th class="sortable" data-field="septåŸå§‹æ¥­ç¸¾">9æœˆåŸå§‹æ¥­ç¸¾</th>
                                <th class="sortable" data-field="octåŸå§‹æ¥­ç¸¾">10æœˆåŸå§‹æ¥­ç¸¾</th>
                                <th class="sortable" data-field="è‡ªæˆ‘å®£å‘Šç›®æ¨™">è‡ªæˆ‘å®£å‘Šç›®æ¨™</th>
                                <th class="sortable" data-field="è‡ªæˆ‘å®£å‘Šé”æˆç‡">è‡ªæˆ‘å®£å‘Šé”æˆç‡</th>
                                <th class="sortable" data-field="totalä¸­å’Œé‡‘é¡ä½”æ¯”">ä¸‰å€‹æœˆä¸­å’Œé‡‘é¡ä½”æ¯”</th>
                            </tr>
                        </thead>
                        <tbody id="region-ç‡Ÿä¸€-table">
                        </tbody>
                    </table>
                </div>
            </div>
            
            <!-- ç‡ŸäºŒ -->
            <div id="region-ç‡ŸäºŒ" class="tab-content">
                <div class="sort-info" id="sort-info-region-ç‡ŸäºŒ">ç›®å‰æ’åºï¼šä¾é–€å¸‚åç¨± (å›ºå®š)</div>
                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th class="sortable" data-field="storeName">é–€å¸‚åç¨±</th>
                                <th class="sortable" data-field="group">çµ„åˆ¥</th>
                                <th class="sortable" data-field="augustScore">8æœˆé‡‘é¡ç©åˆ†</th>
                                <th class="sortable" data-field="septemberScore">9æœˆé‡‘é¡ç©åˆ†</th>
                                <th class="sortable" data-field="amountScore">10æœˆé‡‘é¡ç©åˆ†</th>
                                <th class="sortable" data-field="avgScore">å¹³å‡é‡‘é¡ç©åˆ†</th>
                                <th class="sortable" data-field="augustCustomerScore">8æœˆå®¢æˆ¶æ•¸ç©åˆ†</th>
                                <th class="sortable" data-field="septemberCustomerScore">9æœˆå®¢æˆ¶æ•¸ç©åˆ†</th>
                                <th class="sortable" data-field="customerScore">10æœˆå®¢æˆ¶æ•¸ç©åˆ†</th>
                                <th class="sortable" data-field="averageCustomerScore">å¹³å‡å®¢æˆ¶æ•¸ç©åˆ†</th>
                                <th class="sortable" data-field="auguståŸå§‹æ¥­ç¸¾">8æœˆåŸå§‹æ¥­ç¸¾</th>
                                <th class="sortable" data-field="septåŸå§‹æ¥­ç¸¾">9æœˆåŸå§‹æ¥­ç¸¾</th>
                                <th class="sortable" data-field="octåŸå§‹æ¥­ç¸¾">10æœˆåŸå§‹æ¥­ç¸¾</th>
                                <th class="sortable" data-field="è‡ªæˆ‘å®£å‘Šç›®æ¨™">è‡ªæˆ‘å®£å‘Šç›®æ¨™</th>
                                <th class="sortable" data-field="è‡ªæˆ‘å®£å‘Šé”æˆç‡">è‡ªæˆ‘å®£å‘Šé”æˆç‡</th>
                                <th class="sortable" data-field="totalä¸­å’Œé‡‘é¡ä½”æ¯”">ä¸‰å€‹æœˆä¸­å’Œé‡‘é¡ä½”æ¯”</th>
                            </tr>
                        </thead>
                        <tbody id="region-ç‡ŸäºŒ-table">
                        </tbody>
                    </table>
                </div>
            </div>
            
            <!-- ç‡Ÿä¸‰ -->
            <div id="region-ç‡Ÿä¸‰" class="tab-content">
                <div class="sort-info" id="sort-info-region-ç‡Ÿä¸‰">ç›®å‰æ’åºï¼šä¾é–€å¸‚åç¨± (å›ºå®š)</div>
                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th class="sortable" data-field="storeName">é–€å¸‚åç¨±</th>
                                <th class="sortable" data-field="group">çµ„åˆ¥</th>
                                <th class="sortable" data-field="augustScore">8æœˆé‡‘é¡ç©åˆ†</th>
                                <th class="sortable" data-field="septemberScore">9æœˆé‡‘é¡ç©åˆ†</th>
                                <th class="sortable" data-field="amountScore">10æœˆé‡‘é¡ç©åˆ†</th>
                                <th class="sortable" data-field="avgScore">å¹³å‡é‡‘é¡ç©åˆ†</th>
                                <th class="sortable" data-field="augustCustomerScore">8æœˆå®¢æˆ¶æ•¸ç©åˆ†</th>
                                <th class="sortable" data-field="septemberCustomerScore">9æœˆå®¢æˆ¶æ•¸ç©åˆ†</th>
                                <th class="sortable" data-field="customerScore">10æœˆå®¢æˆ¶æ•¸ç©åˆ†</th>
                                <th class="sortable" data-field="averageCustomerScore">å¹³å‡å®¢æˆ¶æ•¸ç©åˆ†</th>
                                <th class="sortable" data-field="auguståŸå§‹æ¥­ç¸¾">8æœˆåŸå§‹æ¥­ç¸¾</th>
                                <th class="sortable" data-field="septåŸå§‹æ¥­ç¸¾">9æœˆåŸå§‹æ¥­ç¸¾</th>
                                <th class="sortable" data-field="octåŸå§‹æ¥­ç¸¾">10æœˆåŸå§‹æ¥­ç¸¾</th>
                                <th class="sortable" data-field="è‡ªæˆ‘å®£å‘Šç›®æ¨™">è‡ªæˆ‘å®£å‘Šç›®æ¨™</th>
                                <th class="sortable" data-field="è‡ªæˆ‘å®£å‘Šé”æˆç‡">è‡ªæˆ‘å®£å‘Šé”æˆç‡</th>
                                <th class="sortable" data-field="totalä¸­å’Œé‡‘é¡ä½”æ¯”">ä¸‰å€‹æœˆä¸­å’Œé‡‘é¡ä½”æ¯”</th>
                            </tr>
                        </thead>
                        <tbody id="region-ç‡Ÿä¸‰-table">
                        </tbody>
                    </table>
                </div>
            </div>
            
            <!-- åŒ—å€ -->
            <div id="region-åŒ—å€" class="tab-content">
                <div class="sort-info" id="sort-info-region-åŒ—å€">ç›®å‰æ’åºï¼šä¾é–€å¸‚åç¨± (å›ºå®š)</div>
                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th class="sortable" data-field="storeName">é–€å¸‚åç¨±</th>
                                <th class="sortable" data-field="group">çµ„åˆ¥</th>
                                <th class="sortable" data-field="augustScore">8æœˆé‡‘é¡ç©åˆ†</th>
                                <th class="sortable" data-field="septemberScore">9æœˆé‡‘é¡ç©åˆ†</th>
                                <th class="sortable" data-field="amountScore">10æœˆé‡‘é¡ç©åˆ†</th>
                                <th class="sortable" data-field="avgScore">å¹³å‡é‡‘é¡ç©åˆ†</th>
                                <th class="sortable" data-field="augustCustomerScore">8æœˆå®¢æˆ¶æ•¸ç©åˆ†</th>
                                <th class="sortable" data-field="septemberCustomerScore">9æœˆå®¢æˆ¶æ•¸ç©åˆ†</th>
                                <th class="sortable" data-field="customerScore">10æœˆå®¢æˆ¶æ•¸ç©åˆ†</th>
                                <th class="sortable" data-field="averageCustomerScore">å¹³å‡å®¢æˆ¶æ•¸ç©åˆ†</th>
                                <th class="sortable" data-field="auguståŸå§‹æ¥­ç¸¾">8æœˆåŸå§‹æ¥­ç¸¾</th>
                                <th class="sortable" data-field="septåŸå§‹æ¥­ç¸¾">9æœˆåŸå§‹æ¥­ç¸¾</th>
                                <th class="sortable" data-field="octåŸå§‹æ¥­ç¸¾">10æœˆåŸå§‹æ¥­ç¸¾</th>
                                <th class="sortable" data-field="è‡ªæˆ‘å®£å‘Šç›®æ¨™">è‡ªæˆ‘å®£å‘Šç›®æ¨™</th>
                                <th class="sortable" data-field="è‡ªæˆ‘å®£å‘Šé”æˆç‡">è‡ªæˆ‘å®£å‘Šé”æˆç‡</th>
                                <th class="sortable" data-field="totalä¸­å’Œé‡‘é¡ä½”æ¯”">ä¸‰å€‹æœˆä¸­å’Œé‡‘é¡ä½”æ¯”</th>
                            </tr>
                        </thead>
                        <tbody id="region-åŒ—å€-table">
                        </tbody>
                    </table>
                </div>
            </div>
            
            <!-- ä¸­å€ -->
            <div id="region-ä¸­å€" class="tab-content">
                <div class="sort-info" id="sort-info-region-ä¸­å€">ç›®å‰æ’åºï¼šä¾é–€å¸‚åç¨± (å›ºå®š)</div>
                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th class="sortable" data-field="storeName">é–€å¸‚åç¨±</th>
                                <th class="sortable" data-field="group">çµ„åˆ¥</th>
                                <th class="sortable" data-field="augustScore">8æœˆé‡‘é¡ç©åˆ†</th>
                                <th class="sortable" data-field="septemberScore">9æœˆé‡‘é¡ç©åˆ†</th>
                                <th class="sortable" data-field="amountScore">10æœˆé‡‘é¡ç©åˆ†</th>
                                <th class="sortable" data-field="avgScore">å¹³å‡é‡‘é¡ç©åˆ†</th>
                                <th class="sortable" data-field="augustCustomerScore">8æœˆå®¢æˆ¶æ•¸ç©åˆ†</th>
                                <th class="sortable" data-field="septemberCustomerScore">9æœˆå®¢æˆ¶æ•¸ç©åˆ†</th>
                                <th class="sortable" data-field="customerScore">10æœˆå®¢æˆ¶æ•¸ç©åˆ†</th>
                                <th class="sortable" data-field="averageCustomerScore">å¹³å‡å®¢æˆ¶æ•¸ç©åˆ†</th>
                                <th class="sortable" data-field="auguståŸå§‹æ¥­ç¸¾">8æœˆåŸå§‹æ¥­ç¸¾</th>
                                <th class="sortable" data-field="septåŸå§‹æ¥­ç¸¾">9æœˆåŸå§‹æ¥­ç¸¾</th>
                                <th class="sortable" data-field="octåŸå§‹æ¥­ç¸¾">10æœˆåŸå§‹æ¥­ç¸¾</th>
                                <th class="sortable" data-field="è‡ªæˆ‘å®£å‘Šç›®æ¨™">è‡ªæˆ‘å®£å‘Šç›®æ¨™</th>
                                <th class="sortable" data-field="è‡ªæˆ‘å®£å‘Šé”æˆç‡">è‡ªæˆ‘å®£å‘Šé”æˆç‡</th>
                                <th class="sortable" data-field="totalä¸­å’Œé‡‘é¡ä½”æ¯”">ä¸‰å€‹æœˆä¸­å’Œé‡‘é¡ä½”æ¯”</th>
                            </tr>
                        </thead>
                        <tbody id="region-ä¸­å€-table">
                        </tbody>
                    </table>
                </div>
            </div>
            
            <!-- å—å€ -->
            <div id="region-å—å€" class="tab-content">
                <div class="sort-info" id="sort-info-region-å—å€">ç›®å‰æ’åºï¼šä¾é–€å¸‚åç¨± (å›ºå®š)</div>
                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th class="sortable" data-field="storeName">é–€å¸‚åç¨±</th>
                                <th class="sortable" data-field="group">çµ„åˆ¥</th>
                                <th class="sortable" data-field="augustScore">8æœˆé‡‘é¡ç©åˆ†</th>
                                <th class="sortable" data-field="septemberScore">9æœˆé‡‘é¡ç©åˆ†</th>
                                <th class="sortable" data-field="amountScore">10æœˆé‡‘é¡ç©åˆ†</th>
                                <th class="sortable" data-field="avgScore">å¹³å‡é‡‘é¡ç©åˆ†</th>
                                <th class="sortable" data-field="augustCustomerScore">8æœˆå®¢æˆ¶æ•¸ç©åˆ†</th>
                                <th class="sortable" data-field="septemberCustomerScore">9æœˆå®¢æˆ¶æ•¸ç©åˆ†</th>
                                <th class="sortable" data-field="customerScore">10æœˆå®¢æˆ¶æ•¸ç©åˆ†</th>
                                <th class="sortable" data-field="averageCustomerScore">å¹³å‡å®¢æˆ¶æ•¸ç©åˆ†</th>
                                <th class="sortable" data-field="auguståŸå§‹æ¥­ç¸¾">8æœˆåŸå§‹æ¥­ç¸¾</th>
                                <th class="sortable" data-field="septåŸå§‹æ¥­ç¸¾">9æœˆåŸå§‹æ¥­ç¸¾</th>
                                <th class="sortable" data-field="octåŸå§‹æ¥­ç¸¾">10æœˆåŸå§‹æ¥­ç¸¾</th>
                                <th class="sortable" data-field="è‡ªæˆ‘å®£å‘Šç›®æ¨™">è‡ªæˆ‘å®£å‘Šç›®æ¨™</th>
                                <th class="sortable" data-field="è‡ªæˆ‘å®£å‘Šé”æˆç‡">è‡ªæˆ‘å®£å‘Šé”æˆç‡</th>
                                <th class="sortable" data-field="totalä¸­å’Œé‡‘é¡ä½”æ¯”">ä¸‰å€‹æœˆä¸­å’Œé‡‘é¡ä½”æ¯”</th>
                            </tr>
                        </thead>
                        <tbody id="region-å—å€-table">
                        </tbody>
                    </table>
                </div>
            </div>
            
            <!-- æ–°å‰µ -->
            <div id="region-æ–°å‰µ" class="tab-content">
                <div class="sort-info" id="sort-info-region-æ–°å‰µ">ç›®å‰æ’åºï¼šä¾é–€å¸‚åç¨± (å›ºå®š)</div>
                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th class="sortable" data-field="storeName">é–€å¸‚åç¨±</th>
                                <th class="sortable" data-field="group">çµ„åˆ¥</th>
                                <th class="sortable" data-field="augustScore">8æœˆé‡‘é¡ç©åˆ†</th>
                                <th class="sortable" data-field="septemberScore">9æœˆé‡‘é¡ç©åˆ†</th>
                                <th class="sortable" data-field="amountScore">10æœˆé‡‘é¡ç©åˆ†</th>
                                <th class="sortable" data-field="avgScore">å¹³å‡é‡‘é¡ç©åˆ†</th>
                                <th class="sortable" data-field="augustCustomerScore">8æœˆå®¢æˆ¶æ•¸ç©åˆ†</th>
                                <th class="sortable" data-field="septemberCustomerScore">9æœˆå®¢æˆ¶æ•¸ç©åˆ†</th>
                                <th class="sortable" data-field="customerScore">10æœˆå®¢æˆ¶æ•¸ç©åˆ†</th>
                                <th class="sortable" data-field="averageCustomerScore">å¹³å‡å®¢æˆ¶æ•¸ç©åˆ†</th>
                                <th class="sortable" data-field="auguståŸå§‹æ¥­ç¸¾">8æœˆåŸå§‹æ¥­ç¸¾</th>
                                <th class="sortable" data-field="septåŸå§‹æ¥­ç¸¾">9æœˆåŸå§‹æ¥­ç¸¾</th>
                                <th class="sortable" data-field="octåŸå§‹æ¥­ç¸¾">10æœˆåŸå§‹æ¥­ç¸¾</th>
                                <th class="sortable" data-field="è‡ªæˆ‘å®£å‘Šç›®æ¨™">è‡ªæˆ‘å®£å‘Šç›®æ¨™</th>
                                <th class="sortable" data-field="è‡ªæˆ‘å®£å‘Šé”æˆç‡">è‡ªæˆ‘å®£å‘Šé”æˆç‡</th>
                                <th class="sortable" data-field="totalä¸­å’Œé‡‘é¡ä½”æ¯”">ä¸‰å€‹æœˆä¸­å’Œé‡‘é¡ä½”æ¯”</th>
                            </tr>
                        </thead>
                        <tbody id="region-æ–°å‰µ-table">
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- å§”å¤–/ä¸­å’Œåˆ†æå…§å®¹å€ -->
        <div id="outsource-content" class="tab-content">
            <div class="sort-info" id="sort-info-outsource">ç›®å‰æ’åºï¼šä¾é–€å¸‚åç¨±</div>
            <div class="table-container">
                <table>
                    <thead>
                        <tr>
                            <th class="sortable" data-field="storeName">é–€å¸‚åç¨±</th>
                            <th class="sortable" data-field="group">çµ„åˆ¥</th>
                            <th class="sortable" data-field="region">å€åŸŸ</th>
                            <th class="sortable" data-field="augä¸­å’Œé‡‘é¡ä½”æ¯”">8æœˆä¸­å’Œé‡‘é¡ä½”æ¯”</th>
                            <th class="sortable" data-field="sepä¸­å’Œé‡‘é¡ä½”æ¯”">9æœˆä¸­å’Œé‡‘é¡ä½”æ¯”</th>
                            <th class="sortable" data-field="octä¸­å’Œé‡‘é¡ä½”æ¯”">10æœˆä¸­å’Œé‡‘é¡ä½”æ¯”</th>
                            <th class="sortable" data-field="totalä¸­å’Œé‡‘é¡ä½”æ¯”">ä¸‰å€‹æœˆä¸­å’Œé‡‘é¡ä½”æ¯”</th>
                            <th>8æœˆ(ä¸­å’Œ/å§”å¤–)</th>
                            <th>9æœˆ(ä¸­å’Œ/å§”å¤–)</th>
                            <th>10æœˆ(ä¸­å’Œ/å§”å¤–)</th>
                            <th>8+9+10æœˆ(ä¸­å’Œ/å§”å¤–)</th>
                        </tr>
                    </thead>
                    <tbody id="outsource-table">
                    </tbody>
                </table>
            </div>
        </div>

        <!-- çµ±è¨ˆå„€è¡¨ç‰ˆå…§å®¹å€ï¼ˆé ç•™ï¼‰ -->
        <div id="statistics-content" class="tab-content">
            <div class="dashboard">
                <div class="kpi-grid">
                    <div class="kpi-card">
                        <div class="kpi-title">8æœˆåŸå§‹æ¥­ç¸¾åˆè¨ˆ</div>
                        <div class="kpi-value" id="kpi-aug-sum">â€”</div>
                        <div class="kpi-sub">å¹³å‡ï¼š<span id="kpi-aug-avg">â€”</span></div>
                    </div>
                    <div class="kpi-card">
                        <div class="kpi-title">8æœˆåŸå§‹æ¥­ç¸¾é”æˆç‡</div>
                        <div class="kpi-value" id="kpi-aug-achievement-rate">â€”</div>
                        <div class="kpi-sub">åŸºæº–ï¼š300,909</div>
                    </div>
                    <div class="kpi-card">
                        <div class="kpi-title">8æœˆæ–°å®¢æ•¸/èˆŠå®¢æ•¸</div>
                        <div class="kpi-value"><span id="kpi-aug-new-count">â€”</span> / <span id="kpi-aug-old-count">â€”</span></div>
                        <div class="kpi-sub">æ–°å®¢æ•¸ / èˆŠå®¢æ•¸ åˆè¨ˆ</div>
                    </div>
                    <div class="kpi-card">
                        <div class="kpi-title">8æœˆæ–°å®¢/èˆŠå®¢åŸå§‹æ¥­ç¸¾</div>
                        <div class="kpi-value"><span id="kpi-aug-new-rev">â€”</span> / <span id="kpi-aug-old-rev">â€”</span></div>
                        <div class="kpi-sub">æ–°å®¢åŸå§‹ / èˆŠå®¢åŸå§‹ æ¥­ç¸¾åˆè¨ˆ</div>
                    </div>
                    <div class="kpi-card">
                        <div class="kpi-title">8æœˆæ–°å®¢/èˆŠå®¢å®¢å–®åƒ¹</div>
                        <div class="kpi-value"><span id="kpi-aug-new-arpu">â€”</span> / <span id="kpi-aug-old-arpu">â€”</span></div>
                        <div class="kpi-sub">æ–°å®¢å®¢å–®/èˆŠå®¢å®¢å–®</div>
                    </div>
                    <div class="kpi-card">
                        <div class="kpi-title">8æœˆä¸­å’Œ/å§”å¤–</div>
                        <div class="kpi-value"><span id="kpi-aug-zh-amount">â€”</span> / <span id="kpi-aug-out-amount">â€”</span></div>
                        <div class="kpi-sub"><span id="kpi-aug-zh-count">â€”</span>ä»¶ / <span id="kpi-aug-out-count">â€”</span>ä»¶</div>
                    </div>
                </div>
                <div class="kpi-grid">
                    <div class="kpi-card">
                        <div class="kpi-title">9æœˆåŸå§‹æ¥­ç¸¾åˆè¨ˆ</div>
                        <div class="kpi-value" id="kpi-sept-sum">â€”</div>
                        <div class="kpi-sub">å¹³å‡ï¼š<span id="kpi-sept-avg">â€”</span></div>
                    </div>
                    <div class="kpi-card">
                        <div class="kpi-title">9æœˆåŸå§‹æ¥­ç¸¾é”æˆç‡</div>
                        <div class="kpi-value" id="kpi-sept-achievement-rate">â€”</div>
                        <div class="kpi-sub">åŸºæº–ï¼š300,909</div>
                    </div>
                    <div class="kpi-card">
                        <div class="kpi-title">9æœˆæ–°å®¢æ•¸/èˆŠå®¢æ•¸</div>
                        <div class="kpi-value"><span id="kpi-sept-new-count">â€”</span> / <span id="kpi-sept-old-count">â€”</span></div>
                        <div class="kpi-sub">æ–°å®¢æ•¸ / èˆŠå®¢æ•¸ åˆè¨ˆ</div>
                    </div>
                    <div class="kpi-card">
                        <div class="kpi-title">9æœˆæ–°å®¢/èˆŠå®¢åŸå§‹æ¥­ç¸¾</div>
                        <div class="kpi-value"><span id="kpi-sept-new-rev">â€”</span> / <span id="kpi-sept-old-rev">â€”</span></div>
                        <div class="kpi-sub">æ–°å®¢åŸå§‹ / èˆŠå®¢åŸå§‹ æ¥­ç¸¾åˆè¨ˆ</div>
                    </div>
                    <div class="kpi-card">
                        <div class="kpi-title">9æœˆæ–°å®¢/èˆŠå®¢å®¢å–®åƒ¹</div>
                        <div class="kpi-value"><span id="kpi-sept-new-arpu">â€”</span> / <span id="kpi-sept-old-arpu">â€”</span></div>
                        <div class="kpi-sub">æ–°å®¢å®¢å–®/èˆŠå®¢å®¢å–®</div>
                    </div>
                    <div class="kpi-card">
                        <div class="kpi-title">9æœˆä¸­å’Œ/å§”å¤–</div>
                        <div class="kpi-value"><span id="kpi-sept-zh-amount">â€”</span> / <span id="kpi-sept-out-amount">â€”</span></div>
                        <div class="kpi-sub"><span id="kpi-sept-zh-count">â€”</span>ä»¶ / <span id="kpi-sept-out-count">â€”</span>ä»¶</div>
                    </div>
                </div>
                <div class="kpi-grid">
                    <div class="kpi-card">
                        <div class="kpi-title">10æœˆåŸå§‹æ¥­ç¸¾åˆè¨ˆ</div>
                        <div class="kpi-value" id="kpi-oct-sum">â€”</div>
                        <div class="kpi-sub">å¹³å‡ï¼š<span id="kpi-oct-avg">â€”</span></div>
                    </div>
                    <div class="kpi-card">
                        <div class="kpi-title">10æœˆåŸå§‹æ¥­ç¸¾é”æˆç‡</div>
                        <div class="kpi-value" id="kpi-oct-achievement-rate">â€”</div>
                        <div class="kpi-sub">åŸºæº–ï¼š300,909</div>
                    </div>
                    <div class="kpi-card">
                        <div class="kpi-title">10æœˆæ–°å®¢æ•¸/èˆŠå®¢æ•¸</div>
                        <div class="kpi-value"><span id="kpi-oct-new-count">â€”</span> / <span id="kpi-oct-old-count">â€”</span></div>
                        <div class="kpi-sub">æ–°å®¢æ•¸ / èˆŠå®¢æ•¸ åˆè¨ˆ</div>
                    </div>
                    <div class="kpi-card">
                        <div class="kpi-title">10æœˆæ–°å®¢/èˆŠå®¢åŸå§‹æ¥­ç¸¾</div>
                        <div class="kpi-value"><span id="kpi-oct-new-rev">â€”</span> / <span id="kpi-oct-old-rev">â€”</span></div>
                        <div class="kpi-sub">æ–°å®¢åŸå§‹ / èˆŠå®¢åŸå§‹ æ¥­ç¸¾åˆè¨ˆ</div>
                    </div>
                    <div class="kpi-card">
                        <div class="kpi-title">10æœˆæ–°å®¢/èˆŠå®¢å®¢å–®åƒ¹</div>
                        <div class="kpi-value"><span id="kpi-oct-new-arpu">â€”</span> / <span id="kpi-oct-old-arpu">â€”</span></div>
                        <div class="kpi-sub">æ–°å®¢å®¢å–®/èˆŠå®¢å®¢å–®</div>
                    </div>
                    <div class="kpi-card">
                        <div class="kpi-title">10æœˆä¸­å’Œ/å§”å¤–</div>
                        <div class="kpi-value"><span id="kpi-oct-zh-amount">â€”</span> / <span id="kpi-oct-out-amount">â€”</span></div>
                        <div class="kpi-sub"><span id="kpi-oct-zh-count">â€”</span>ä»¶ / <span id="kpi-oct-out-count">â€”</span>ä»¶</div>
                    </div>
                </div>
                
                <!--
                //<div class="chart-grid">
                    <div class="chart-placeholder">åœ–è¡¨å€å¡Šï¼ˆå¾…è£œï¼‰</div>
                    <div class="chart-placeholder">åœ–è¡¨å€å¡Šï¼ˆå¾…è£œï¼‰</div>
                </div>
                -->
            </div>
        </div>
    </div>
    
    <!-- å¼•å…¥å¤–éƒ¨æ•¸æ“šæ–‡ä»¶ -->
    <script>
        // è¿½è¹¤å·²è¼‰å…¥çš„è…³æœ¬æ•¸é‡
        let loadedScripts = 0;
        const totalScripts = 4;
        
        // ç•¶è…³æœ¬è¼‰å…¥å®Œæˆæ™‚çš„è™•ç†å‡½æ•¸
        function onScriptsLoaded() {
            loadedScripts++;
            console.log(`è¼‰å…¥é€²åº¦: ${loadedScripts}/${totalScripts}`);
            console.log('competitionData:', typeof competitionData);
            console.log('augustCompetitionData:', typeof augustCompetitionData);
            console.log('septemberCompetitionData:', typeof septemberCompetitionData);
            console.log('storeData:', typeof storeData);
            
            if (loadedScripts >= totalScripts) {
                // ç¢ºèªæ‰€æœ‰è³‡æ–™éƒ½å·²è¼‰å…¥
                if (typeof competitionData !== 'undefined' && 
                    typeof augustCompetitionData !== 'undefined' && 
                    typeof septemberCompetitionData !== 'undefined' &&
                    typeof storeData !== 'undefined') {
                    console.log('æ‰€æœ‰è³‡æ–™è¼‰å…¥æˆåŠŸï¼Œåˆå§‹åŒ–é é¢');
                    initializePage();
                } else {
                    console.error('éƒ¨åˆ†è³‡æ–™è¼‰å…¥å¤±æ•—');
                }
            }
        }

        // åˆå§‹åŒ–é é¢
        function initializePage() {
            currentMainTab = 'amount';
            switchMainTab('amount');
        }
    </script>
    <script src="competition-data.js" onload="onScriptsLoaded()"></script>
    <script src="competition-data-aug.js" onload="onScriptsLoaded()"></script>
    <script src="competition-data-sep.js" onload="onScriptsLoaded()"></script>
    <script src="store_data_js.js" onload="onScriptsLoaded()"></script>
    
    <script>
        // ç•¶å‰æ´»å‹•åˆ†é 
        let currentMainTab = 'amount';
        let currentGroupTab = 'group-a';
        let currentSort = { field: null, direction: 'asc' };

        function getGroupBadge(group, isRegionView = false) {
            if (isRegionView) {
                // å€åŸŸåˆ†æä½¿ç”¨ç°¡åŒ–ç‰ˆæœ¬ï¼ˆåªé¡¯ç¤ºå­—æ¯ï¼‰
                const badges = {
                    'A': '<span class="group-badge badge-a">A</span>',
                    'B': '<span class="group-badge badge-b">B</span>',
                    'C': '<span class="group-badge badge-c">C</span>'
                };
                return badges[group] || '';
            } else {
                // å…¶ä»–é é¢ä½¿ç”¨å®Œæ•´ç‰ˆæœ¬
                const badges = {
                    'A': '<span class="group-badge badge-a">â­æ–°æ˜Ÿ</span>',
                    'B': '<span class="group-badge badge-b">ğŸš€é£›è€€</span>',
                    'C': '<span class="group-badge badge-c">ğŸ‘‘èè‹±</span>'
                };
                return badges[group] || '';
            }
        }

        function getRegionBadge(region) {
            return `<span class="region-badge region-${region}">${region}</span>`;
        }

        function getZhongheRatioClass(ratio) {
            const numRatio = parseFloat(ratio.replace('%', ''));
            if (numRatio >= 80) return 'ratio-high';
            if (numRatio >= 50) return 'ratio-medium';
            return 'ratio-low';
        }

        function getSelfDeclaredRateClass(rate) {
            const numRate = parseFloat(rate.replace('%', ''));
            if (numRate >= 80) return 'rate-excellent';
            if (numRate >= 50) return 'rate-good';
            return 'rate-poor';
        }

        function formatNumber(num) {
            return num.toLocaleString();
        }

        // æ ¹æ“šçµ„åˆ¥åˆ¤å®šæ¥­ç¸¾ç©åˆ†æ˜¯å¦é”æ¨™ï¼šA>=25000, B>=35000, C>=45000
        function isAmountQualifiedForStore(store) {
            const group = (store.group || '').toString().toUpperCase();
            const thresholds = { 'A': 25000, 'B': 35000, 'C': 45000 };
            const threshold = thresholds[group] || 0;
            const score = Number(store.amountScore) || 0;
            return score >= threshold;
        }

        // åˆ¤å®šä»»æ„ score æ˜¯å¦é”åˆ°è©²åº—çµ„åˆ¥é–€æª»
        function isScoreQualifiedForStore(store, score) {
            const group = (store.group || '').toString().toUpperCase();
            const thresholds = { 'A': 25000, 'B': 35000, 'C': 45000 };
            const threshold = thresholds[group] || 0;
            const s = Number(score) || 0;
            return s >= threshold;
        }

        // è¨ˆç®—æ¯å®¶é–€å¸‚çš„å¹³å‡ç©åˆ†ä¸¦å›å‚³æ¨™æº–ç«¶è³½æ’åï¼ˆåŒåˆ†åŒåæ¬¡ï¼Œä¸‹ä¸€åæ¬¡æ•¸é‡æ¸›å°‘ï¼‰
        // è¼¸å…¥ data ç‚ºè©²çµ„çš„ store é™£åˆ—ï¼Œå›å‚³ç‰©ä»¶ map: { storeName: rank }
        function computeAvgRankMap(data) {
            // å»ºç«‹åŒ…å« avg çš„æš«å­˜é™£åˆ— (8æœˆ + 9æœˆ + 10æœˆ)
            const arr = data.map(s => {
                const aug = getAugustScore(s.storeName) || 0;
                const sep = getSeptemberScore(s.storeName) || 0;
                const oct = s.amountScore || 0;
                
                // å›ºå®šé™¤ä»¥3ï¼Œæ²’æœ‰æ¥­ç¸¾å°±ç•¶ä½œ0
                const avg = Math.round((aug + sep + oct) / 3);
                return { storeName: s.storeName, avg };
            });

            // ä¾ avg é™åºæ’åˆ—ï¼ˆåˆ†æ•¸å¤§æ’å‰ï¼‰
            arr.sort((a, b) => b.avg - a.avg);

            const rankMap = {};
            for (let i = 0; i < arr.length; i++) {
                if (i > 0 && arr[i].avg === arr[i - 1].avg) {
                    // åŒåˆ†åŒåæ¬¡
                    rankMap[arr[i].storeName] = rankMap[arr[i - 1].storeName];
                } else {
                    // æ¨™æº–ç«¶è³½æ’åï¼šæ’åç‚ºç´¢å¼•+1ï¼ˆå› æ­¤ä¸Šæ–¹ä¸‰äººåŒåˆ—1ï¼Œä¸‹ä¸€åç‚º4ï¼‰
                    rankMap[arr[i].storeName] = i + 1;
                }
            }
            return rankMap;
        }

        // è¨ˆç®—å®¢æˆ¶æ•¸å¹³å‡ç©åˆ†æ’åï¼ˆåŒåˆ†åŒåæ¬¡ï¼Œä¸‹ä¸€åæ¬¡æ•¸é‡æ¸›å°‘ï¼‰
        function computeCustomerAvgRankMap(data) {
            // å»ºç«‹åŒ…å«å¹³å‡å®¢æˆ¶æ•¸ç©åˆ†çš„æš«å­˜é™£åˆ—
            const arr = data.map(s => {
                const avgScore = getAverageCustomerScore(s.storeName);
                return { storeName: s.storeName, avgScore };
            });

            // ä¾å¹³å‡ç©åˆ†é™åºæ’åˆ—ï¼ˆåˆ†æ•¸å¤§æ’å‰ï¼‰
            arr.sort((a, b) => b.avgScore - a.avgScore);

            const rankMap = {};
            let currentRank = 1;
            let currentScore = arr[0]?.avgScore;
            let sameRankCount = 0;

            arr.forEach((item, index) => {
                if (item.avgScore === currentScore) {
                    rankMap[item.storeName] = currentRank;
                    sameRankCount++;
                } else {
                    currentRank += sameRankCount;
                    currentScore = item.avgScore;
                    sameRankCount = 1;
                    rankMap[item.storeName] = currentRank;
                }
            });

            return rankMap;
        }

        function switchMainTab(tab) {
            currentMainTab = tab;
            
            // æ›´æ–°ä¸»å°èˆªç‹€æ…‹
            document.querySelectorAll('.main-nav-item').forEach(item => {
                item.classList.remove('active');
            });
            event.target.classList.add('active');
            
            // åˆ‡æ›å…§å®¹å€åŸŸ
            document.querySelectorAll('#amount-content, #customer-content, #region-content, #outsource-content, #statistics-content').forEach(content => {
                content.classList.remove('active');
            });
            document.getElementById(tab + '-content').classList.add('active');
            
            // è™•ç†å­å°èˆªé¡¯ç¤º/éš±è—
            const subNav = document.querySelector('.sub-nav');
            
            if (tab === 'outsource' || tab === 'statistics') {
                // å§”å¤–/ä¸­å’Œåˆ†æå’Œçµ±è¨ˆå„€è¡¨ç‰ˆä¸éœ€è¦å­å°èˆª
                subNav.style.display = 'none';
            } else {
                // å…¶ä»–åˆ†é é¡¯ç¤ºå­å°èˆª
                subNav.style.display = 'block';
                
                // åˆ‡æ›å­å°èˆªæ¨™ç±¤çµ„
                document.querySelectorAll('.tab-group').forEach(group => {
                    group.classList.remove('active');
                });
                document.getElementById(tab + '-tabs').classList.add('active');
            }
            
            // é‡ç½®å­å°èˆªç‹€æ…‹
            if (tab === 'amount') {
                currentGroupTab = 'group-a';
                document.querySelectorAll('#amount-tabs .group-tab').forEach(groupTab => {
                    groupTab.classList.remove('active');
                });
                document.querySelector('#amount-tabs .group-tab[onclick*="group-a"]').classList.add('active');
                
                // é¡¯ç¤ºAçµ„å…§å®¹
                document.querySelectorAll('#amount-content .tab-content').forEach(content => {
                    content.classList.remove('active');
                });
                document.getElementById('group-a').classList.add('active');
            } else if (tab === 'customer') {
                currentGroupTab = 'customer-ab';
                document.querySelectorAll('#customer-tabs .group-tab').forEach(groupTab => {
                    groupTab.classList.remove('active');
                });
                document.querySelector('#customer-tabs .group-tab[onclick*="customer-ab"]').classList.add('active');
                
                // é¡¯ç¤ºA+Bçµ„å…§å®¹
                document.querySelectorAll('#customer-content .tab-content').forEach(content => {
                    content.classList.remove('active');
                });
                document.getElementById('customer-ab').classList.add('active');
            } else if (tab === 'region') {
                currentGroupTab = 'region-ç‡Ÿä¸€';
                document.querySelectorAll('#region-tabs .group-tab').forEach(groupTab => {
                    groupTab.classList.remove('active');
                });
                document.querySelector('#region-tabs .group-tab[onclick*="region-ç‡Ÿä¸€"]').classList.add('active');
                
                // é¡¯ç¤ºç‡Ÿä¸€å…§å®¹
                document.querySelectorAll('#region-content .tab-content').forEach(content => {
                    content.classList.remove('active');
                });
                document.getElementById('region-ç‡Ÿä¸€').classList.add('active');
                
            } else if (tab === 'outsource') {
                // å§”å¤–/ä¸­å’Œåˆ†æï¼šå¡«å……è¡¨æ ¼
                currentGroupTab = 'outsource';
                // é‡ç½®æ’åºç‹€æ…‹
                currentSort.field = 'storeName';
                currentSort.direction = 'asc';
                try { populateOutsourceTable('storeName', 'asc'); } catch (e) { console.warn('populateOutsourceTable failed', e); }
            } else if (tab === 'statistics') {
                // çµ±è¨ˆå„€è¡¨ç‰ˆï¼šæ¸²æŸ“ KPI
                currentGroupTab = 'statistics';
                try { renderStatisticsDashboard(); } catch (e) { console.warn('renderStatisticsDashboard failed', e); }
            }
            
            // è¼‰å…¥å°æ‡‰æ•¸æ“š
            if (tab !== 'outsource' && tab !== 'statistics') {
                loadTabContent();
            }
        }

        function switchGroupTab(tab) {
            currentGroupTab = tab;
            
            // æ›´æ–°ç•¶å‰æ´»å‹•æ¨™ç±¤çµ„å…§çš„æ¨™ç±¤ç‹€æ…‹
            const activeTabGroup = document.querySelector('.tab-group.active');
            if (activeTabGroup) {
                activeTabGroup.querySelectorAll('.group-tab').forEach(groupTab => {
                    groupTab.classList.remove('active');
                });
                event.target.classList.add('active');
            }
            
            // åœ¨å„æ¨¡å¼ä¸‹åˆ‡æ›å­å…§å®¹
            if (currentMainTab === 'amount') {
                document.querySelectorAll('#amount-content .tab-content').forEach(content => {
                    content.classList.remove('active');
                });
                document.getElementById(tab).classList.add('active');
            } else if (currentMainTab === 'customer') {
                document.querySelectorAll('#customer-content .tab-content').forEach(content => {
                    content.classList.remove('active');
                });
                document.getElementById(tab).classList.add('active');
            } else if (currentMainTab === 'region') {
                document.querySelectorAll('#region-content .tab-content').forEach(content => {
                    content.classList.remove('active');
                });
                document.getElementById(tab).classList.add('active');
            }
            
            // è¼‰å…¥å°æ‡‰æ•¸æ“š
            loadTabContent();
        }

        function loadTabContent() {
            // è¨­å®šåˆå§‹æ’åºç‹€æ…‹ï¼Œä¸¦æ¸…é™¤æ‰€æœ‰æ’åºæ¨™è¨˜
            document.querySelectorAll('th.sortable').forEach(th => {
                th.classList.remove('sort-asc', 'sort-desc');
            });

            if (currentMainTab === 'amount') {
                if (currentGroupTab.startsWith('group-')) {
                    const group = currentGroupTab.replace('group-', '').toUpperCase();
                    // ç¯©é¸å‡ºè©²çµ„çš„è³‡æ–™
                    const groupData = competitionData.filter(store => store.group === group);
                    
                    // è¨­ç½®åˆå§‹æ’åºç‚ºå¹³å‡ç©åˆ†æ’åï¼ˆé™åºï¼‰
                    currentSort = { field: 'avgRank', direction: 'desc' };
                    // æ‰¾åˆ°å°æ‡‰çš„è¡¨é ­ä¸¦æ·»åŠ æ’åºæ¨™è¨˜
                    const header = document.querySelector(`#${currentGroupTab} th[data-field="avgRank"]`);
                    if (header) header.classList.add('sort-desc');
                    
                    // æŒ‰å¹³å‡ç©åˆ†æ’åºä¸¦é¡¯ç¤º
                    sortTable('avgRank', header);
                }
            } else if (currentMainTab === 'customer') {
                if (currentGroupTab === 'customer-ab') {
                    // ç¯©é¸A+Bçµ„æ•¸æ“š
                    const abGroupData = competitionData.filter(store => store.group === 'A' || store.group === 'B');
                    
                    // è¨­ç½®åˆå§‹æ’åºç‚ºå¹³å‡å®¢æˆ¶æ•¸æ’åï¼ˆé™åºï¼‰
                    currentSort = { field: 'customerAvgRank', direction: 'desc' };
                    // æ‰¾åˆ°å°æ‡‰çš„è¡¨é ­ä¸¦æ·»åŠ æ’åºæ¨™è¨˜
                    const header = document.querySelector('#customer-ab th[data-field="customerAvgRank"]');
                    if (header) header.classList.add('sort-desc');
                    
                    // æŒ‰å®¢æˆ¶æ•¸å¹³å‡æ’åæ’åºä¸¦é¡¯ç¤º
                    sortTable('customerAvgRank', header);
                } else if (currentGroupTab === 'customer-c') {
                    // ç¯©é¸Cçµ„æ•¸æ“š
                    const cGroupData = competitionData.filter(store => store.group === 'C');
                    
                    // è¨­ç½®åˆå§‹æ’åºç‚ºå¹³å‡å®¢æˆ¶æ•¸æ’åï¼ˆé™åºï¼‰
                    currentSort = { field: 'customerAvgRank', direction: 'desc' };
                    // æ‰¾åˆ°å°æ‡‰çš„è¡¨é ­ä¸¦æ·»åŠ æ’åºæ¨™è¨˜
                    const header = document.querySelector('#customer-c th[data-field="customerAvgRank"]');
                    if (header) header.classList.add('sort-desc');
                    
                    // æŒ‰å®¢æˆ¶æ•¸å¹³å‡æ’åæ’åºä¸¦é¡¯ç¤º
                    sortTable('customerAvgRank', header);
                }
            } else if (currentMainTab === 'region') {
                if (currentGroupTab.startsWith('region-')) {
                    const region = currentGroupTab.replace('region-', '');
                    // ç¯©é¸å‡ºè©²å€åŸŸçš„è³‡æ–™
                    const regionData = competitionData.filter(store => store.region === region);
                    
                    // è¨­ç½®åˆå§‹æ’åºç‚ºé–€å¸‚åç¨±
                    currentSort = { field: 'storeName', direction: 'asc' };
                    // æ‰¾åˆ°å°æ‡‰çš„è¡¨é ­ä¸¦æ·»åŠ æ’åºæ¨™è¨˜
                    const header = document.querySelector(`#${currentGroupTab} th[data-field="storeName"]`);
                    if (header) header.classList.add('sort-asc');
                    
                    populateRegionTableWithData(region, regionData);
                }
            }
        }

        function populateGroupTable(group) {
            const groupData = competitionData.filter(store => store.group === group);
            
            // è¨ˆç®—å¹³å‡ç©åˆ†ä¸¦æ’åº (8æœˆ + 9æœˆ + 10æœˆ)
            const avgScores = new Map();
            groupData.forEach(store => {
                const augScore = getAugustScore(store.storeName);
                const sepScore = getSeptemberScore(store.storeName);
                const octScore = store.amountScore || 0; // 10æœˆç©åˆ†
                
                let total = 0;
                let count = 0;
                
                if (typeof augScore === 'number') {
                    total += augScore;
                    count++;
                }
                if (typeof sepScore === 'number') {
                    total += sepScore;
                    count++;
                }
                if (octScore > 0) {
                    total += octScore;
                    count++;
                }
                
                const avgScore = count > 0 ? Math.round(total / count) : 0;
                avgScores.set(store.storeName, avgScore);
            });
            
            // ä¾å¹³å‡ç©åˆ†ç”±é«˜åˆ°ä½æ’åº
            if (!currentSort.field || currentSort.field === 'avgRank') {
                groupData.sort((a, b) => {
                    const aScore = avgScores.get(a.storeName);
                    const bScore = avgScores.get(b.storeName);
                    return currentSort.direction === 'asc' ? aScore - bScore : bScore - aScore;
                });
            } else {
                groupData.sort((a, b) => {
                    let aValue, bValue;
                    
                    switch (currentSort.field) {
                        case 'å®¢æˆ¶æ•¸æ’å':
                            const aAugCust = getAugustCustomerScore(a.storeName) || 0;
                            const aSepCust = getSeptemberCustomerScore(a.storeName) || 0;
                            const aOctCust = a.customerScore || 0;
                            aValue = Math.round((aAugCust + aSepCust + aOctCust) / 3);
                            
                            const bAugCust = getAugustCustomerScore(b.storeName) || 0;
                            const bSepCust = getSeptemberCustomerScore(b.storeName) || 0;
                            const bOctCust = b.customerScore || 0;
                            bValue = Math.round((bAugCust + bSepCust + bOctCust) / 3);
                            break;
                        default:
                            aValue = a[currentSort.field] || 0;
                            bValue = b[currentSort.field] || 0;
                    }
                    
                    return currentSort.direction === 'desc' ? bValue - aValue : aValue - bValue;
                });
            }
            
            populateGroupTableWithData(group, groupData);
        }

        function populateCustomerABTable() {
            // ç¯©é¸A+Bçµ„æ•¸æ“š
            const abGroupData = competitionData.filter(store => store.group === 'A' || store.group === 'B');
            populateCustomerABTableWithData(abGroupData);
        }

        function populateCustomerCTable() {
            // ç¯©é¸Cçµ„æ•¸æ“š
            const cGroupData = competitionData.filter(store => store.group === 'C');
            populateCustomerCTableWithData(cGroupData);
        }
        // å·²åˆä½µè‡³ populateRegionTableWithDataï¼Œé¿å…é‡è¤‡å®šç¾©

        function populateRegionTableWithData(region, data) {
            const tbody = document.getElementById(`region-${region}-table`);
            if (!tbody) return;
            
            tbody.innerHTML = '';
            
            // è¨ˆç®—éœ€è¦åŠ ç¸½çš„æ¬„ä½
            let totalOriginalAmount = 0;
            let totalNewAmount = 0;
            let totalOldAmount = 0;
            let totalNewCustomers = 0;
            let totalOldCustomers = 0;
            let totalAugustOriginalRevenue = 0;
            let totalSeptOriginalRevenue = 0;
            let totalOctOriginalRevenue = 0;
            
            // è¨ˆç®—è©² data çš„å¹³å‡æ’åæ˜ å°„ï¼ˆç”¨æ–¼æ’åºå¾Œçš„é¡¯ç¤ºï¼‰
            const rankMap = computeAvgRankMap(data);

            data.forEach((store) => {
                const isAmountQualified = isAmountQualifiedForStore(store);
                const isCustomerQualified = isCustomerQualifiedForStore(store, store.customerScore);
                const hasNoPerformance = store.amountScore === 0;
                
                // è¨ˆç®—é‡‘é¡ç©åˆ†ç›¸é—œè®Šé‡ (8æœˆ + 9æœˆ + 10æœˆ)
                const augScore = getAugustScore(store.storeName) || 0;
                const sepScore = getSeptemberScore(store.storeName) || 0;
                const octScore = store.amountScore || 0;
                
                const augThreshold = store.amountThreshold || store.è‡ªæˆ‘å®£å‘Šç›®æ¨™ || 0;
                const isAugQualified = isScoreQualifiedForStore(store, augScore);
                const isSepQualified = isScoreQualifiedForStore(store, sepScore);
                const isOctQualified = isAmountQualified;
                
                const augDisplay = augScore > 0 ? formatNumber(augScore) : '0';
                const sepDisplay = sepScore > 0 ? formatNumber(sepScore) : '0';
                const octDisplay = hasNoPerformance ? '<span class="performance-status">å°šç„¡ç©åˆ†</span>' : formatNumber(octScore);
                
                // å¹³å‡é‡‘é¡ç©åˆ† (å›ºå®šé™¤ä»¥3)
                const avgAmountScore = Math.round((augScore + sepScore + octScore) / 3);
                const avgDisplay = avgAmountScore > 0 ? formatNumber(avgAmountScore) : '0';
                const isAvgQualified = isScoreQualifiedForStore(store, avgAmountScore);
                
                // è¨ˆç®—è‡ªæˆ‘å®£å‘Šé”æˆç‡ï¼ˆä½¿ç”¨å¹³å‡ç©åˆ†ï¼‰
                const selfDeclaredTarget = store.è‡ªæˆ‘å®£å‘Šç›®æ¨™ || 0;
                const selfDeclaredRate = selfDeclaredTarget > 0 ? Math.round((avgAmountScore / selfDeclaredTarget) * 100) + '%' : '0%';

                // è¨ˆç®—å®¢æˆ¶æ•¸ç©åˆ†ç›¸é—œè®Šé‡ (8æœˆ + 9æœˆ + 10æœˆ)
                const augCustomerScore = getAugustCustomerScore(store.storeName) || 0;
                const sepCustomerScore = getSeptemberCustomerScore(store.storeName) || 0;
                const octCustomerScore = store.customerScore || 0;
                const avgCustomerScore = getAverageCustomerScore(store.storeName);
                
                // è¨ˆç®—åŸå§‹æ¥­ç¸¾ (8æœˆ + 9æœˆ + 10æœˆ)
                const augustOriginalRevenue = getAugustOriginalRevenue(store.storeName);
                const septOriginalRevenue = getSeptOriginalRevenue(store.storeName);
                const octOriginalRevenue = store.æ–°å®¢æ¥­ç¸¾ + store.èˆŠå®¢æ¥­ç¸¾;
                
                let rowClass = `group-${store.group.toLowerCase()}`;
                if (hasNoPerformance) rowClass += ' no-performance';
                
                const row = document.createElement('tr');
                row.className = rowClass;
                
                // ç´¯åŠ ç¸½è¨ˆ
                totalAugustOriginalRevenue += augustOriginalRevenue;
                totalSeptOriginalRevenue += septOriginalRevenue;
                totalOctOriginalRevenue += octOriginalRevenue;
                
                // ç²å–å§”å¤–/ä¸­å’Œæ•¸æ“šä¸¦è¨ˆç®—ä¸‰å€‹æœˆä¸­å’Œé‡‘é¡ä½”æ¯”
                const storeOutsourceData = getStoreData(store.storeName);
                const augZhAmount = storeOutsourceData?.august?.zhonghe?.amount || 0;
                const augOutAmount = storeOutsourceData?.august?.outsource?.amount || 0;
                const sepZhAmount = storeOutsourceData?.september?.zhonghe?.amount || 0;
                const sepOutAmount = storeOutsourceData?.september?.outsource?.amount || 0;
                const octZhAmount = storeOutsourceData?.october?.zhonghe?.amount || 0;
                const octOutAmount = storeOutsourceData?.october?.outsource?.amount || 0;
                const totalPercentage = calculatePercentage(
                    augZhAmount + sepZhAmount + octZhAmount,
                    augOutAmount + sepOutAmount + octOutAmount
                );

                row.innerHTML = `
                    <td class="store-name">${store.storeName}</td>
                    <td>${getGroupBadge(store.group, true)}</td>
                    <td class="number-cell ${isAugQualified ? 'qualified' : ''}">${augDisplay}</td>
                    <td class="number-cell ${isSepQualified ? 'qualified' : ''}">${sepDisplay}</td>
                    <td class="number-cell ${isOctQualified ? 'qualified' : ''}">${octDisplay}</td>
                    <td class="number-cell ${isAvgQualified ? 'qualified' : ''}">${avgDisplay}</td>
                    <td class="number-cell ${isCustomerQualifiedForStore(store, augCustomerScore) ? 'qualified' : ''}">${augCustomerScore}</td>
                    <td class="number-cell ${isCustomerQualifiedForStore(store, sepCustomerScore) ? 'qualified' : ''}">${sepCustomerScore}</td>
                    <td class="number-cell ${isCustomerQualified ? 'qualified' : ''}">${octCustomerScore}</td>
                    <td class="number-cell ${isCustomerQualifiedForStore(store, avgCustomerScore) ? 'qualified' : ''}">${avgCustomerScore}</td>
                    <td class="number-cell">${formatNumber(augustOriginalRevenue)}</td>
                    <td class="number-cell">${formatNumber(septOriginalRevenue)}</td>
                    <td class="number-cell">${formatNumber(octOriginalRevenue)}</td>
                    <td class="number-cell">${formatNumber(store.è‡ªæˆ‘å®£å‘Šç›®æ¨™)}</td>
                    <td class="number-cell">
                        <span class="self-declared-rate ${getSelfDeclaredRateClass(selfDeclaredRate)}">${selfDeclaredRate}</span>
                    </td>
                    <td class="number-cell"><span class="zhonghe-ratio ${getZhongheRatioClass(totalPercentage)}">${totalPercentage}</span></td>
                `;
                tbody.appendChild(row);
            });
            // æ·»åŠ ç¸½è¨ˆåˆ—
            const totalRow = document.createElement('tr');
            totalRow.className = 'total-row';
            totalRow.innerHTML = `
                <td class="store-name">ç¸½è¨ˆ (${data.length}å®¶)</td>
                <td>-</td>
                <td class="number-cell">-</td>
                <td class="number-cell">-</td>
                <td class="number-cell">-</td>
                <td class="number-cell">-</td>
                <td class="number-cell">-</td>
                <td class="number-cell">-</td>
                <td class="number-cell">-</td>
                <td class="number-cell">-</td>
                <td class="number-cell">${formatNumber(totalAugustOriginalRevenue)}</td>
                <td class="number-cell">${formatNumber(totalSeptOriginalRevenue)}</td>
                <td class="number-cell">${formatNumber(totalOctOriginalRevenue)}</td>
                <td class="number-cell">-</td>
                <td class="number-cell">-</td>
                <td class="number-cell">-</td>
            `;
            tbody.appendChild(totalRow);
            
            // æ·»åŠ å¹³å‡åˆ—
            const avgRow = document.createElement('tr');
            avgRow.className = 'average-row';
            const avgAugustOriginalRevenue = data.length > 0 ? Math.round(totalAugustOriginalRevenue / data.length) : 0;
            const avgSeptOriginalRevenue = data.length > 0 ? Math.round(totalSeptOriginalRevenue / data.length) : 0;
            const avgOctOriginalRevenue = data.length > 0 ? Math.round(totalOctOriginalRevenue / data.length) : 0;
            avgRow.innerHTML = `
                <td class="store-name">å¹³å‡</td>
                <td>-</td>
                <td class="number-cell">-</td>
                <td class="number-cell">-</td>
                <td class="number-cell">-</td>
                <td class="number-cell">-</td>
                <td class="number-cell">-</td>
                <td class="number-cell">-</td>
                <td class="number-cell">-</td>
                <td class="number-cell">-</td>
                <td class="number-cell">${formatNumber(avgAugustOriginalRevenue)}</td>
                <td class="number-cell">${formatNumber(avgSeptOriginalRevenue)}</td>
                <td class="number-cell">${formatNumber(avgOctOriginalRevenue)}</td>
                <td class="number-cell">-</td>
                <td class="number-cell">-</td>
                <td class="number-cell">-</td>
            `;
            tbody.appendChild(avgRow);
        }

        // åˆå§‹åŒ–æ’åºåŠŸèƒ½
        function initializeSorting() {
            document.addEventListener('click', function(e) {
                if (e.target.classList.contains('sortable')) {
                    const field = e.target.getAttribute('data-field');
                    sortTable(field, e.target);
                }
            });
        }

        // æ’åºè¡¨æ ¼
        function sortTable(field, headerElement) {
            // æ›´æ–°æ’åºæ–¹å‘
            if (currentSort.field === field) {
                currentSort.direction = currentSort.direction === 'asc' ? 'desc' : 'asc';
            } else {
                currentSort.direction = 'asc';
                currentSort.field = field;
            }

            // æ›´æ–°è¡¨é ­æ¨£å¼
            document.querySelectorAll('th.sortable').forEach(th => {
                th.classList.remove('sort-asc', 'sort-desc');
            });
            headerElement.classList.add(currentSort.direction === 'asc' ? 'sort-asc' : 'sort-desc');

            // ç²å–ç•¶å‰é¡¯ç¤ºçš„æ•¸æ“š
            let currentData = [];
            if (currentMainTab === 'amount') {
                const group = currentGroupTab.replace('group-', '').toUpperCase();
                currentData = competitionData.filter(store => store.group === group);
            } else if (currentMainTab === 'customer') {
                if (currentGroupTab === 'customer-ab') {
                    currentData = competitionData.filter(store => store.group === 'A' || store.group === 'B');
                } else if (currentGroupTab === 'customer-c') {
                    currentData = competitionData.filter(store => store.group === 'C');
                }
            } else if (currentMainTab === 'region') {
                const region = currentGroupTab.replace('region-', '');
                currentData = competitionData.filter(store => store.region === region);
            } else if (currentMainTab === 'outsource') {
                // å§”å¤–/ä¸­å’Œåˆ†æä½¿ç”¨ä¸åŒçš„æ•¸æ“šè™•ç†æ–¹å¼
                populateOutsourceTable(field, currentSort.direction);
                updateSortInfo(field);
                return;
            }

            // æ’åºæ•¸æ“š
            currentData.sort((a, b) => {
                let valueA, valueB;

                switch(field) {
                    case 'storeName':
                        valueA = a.storeName;
                        valueB = b.storeName;
                        break;
                    case 'region':
                        valueA = a.region;
                        valueB = b.region;
                        break;
                    case 'amountScore':
                        valueA = a.amountScore;
                        valueB = b.amountScore;
                        break;
                    case 'group':
                        valueA = a.group;
                        valueB = b.group;
                        break;
                    case 'customerScore':
                        valueA = a.customerScore;
                        valueB = b.customerScore;
                        break;
                    case 'augustCustomerScore':
                        // ä½¿ç”¨ augustCompetitionData æä¾›çš„å®¢æˆ¶æ•¸ç©åˆ†é€²è¡Œæ’åº
                        valueA = (typeof getAugustCustomerScore === 'function') ? (getAugustCustomerScore(a.storeName) || 0) : (a.augustCustomerScore || 0);
                        valueB = (typeof getAugustCustomerScore === 'function') ? (getAugustCustomerScore(b.storeName) || 0) : (b.augustCustomerScore || 0);
                        break;
                    case 'septemberCustomerScore':
                        // ä½¿ç”¨ septemberCompetitionData æä¾›çš„å®¢æˆ¶æ•¸ç©åˆ†é€²è¡Œæ’åº
                        valueA = (typeof getSeptemberCustomerScore === 'function') ? (getSeptemberCustomerScore(a.storeName) || 0) : 0;
                        valueB = (typeof getSeptemberCustomerScore === 'function') ? (getSeptemberCustomerScore(b.storeName) || 0) : 0;
                        break;
                    case 'averageCustomerScore':
                        // ä½¿ç”¨å¹³å‡å®¢æˆ¶æ•¸ç©åˆ†é€²è¡Œæ’åº
                        valueA = getAverageCustomerScore(a.storeName);
                        valueB = getAverageCustomerScore(b.storeName);
                        break;
                    case 'avgRank':
                        // ä½¿ç”¨ computeAvgRankMap ä¾†ç²å–å¹³å‡ç©åˆ†æ’å
                        const amountRankMap = computeAvgRankMap(currentData);
                        valueA = amountRankMap[a.storeName] || 0;
                        valueB = amountRankMap[b.storeName] || 0;
                        break;
                    case 'å®¢æˆ¶æ•¸æ’å':
                        valueA = a.å®¢æˆ¶æ•¸æ’å;
                        valueB = b.å®¢æˆ¶æ•¸æ’å;
                        break;
                    case 'åŸå§‹æ¥­ç¸¾':
                        valueA = a.æ–°å®¢æ¥­ç¸¾ + a.èˆŠå®¢æ¥­ç¸¾;
                        valueB = b.æ–°å®¢æ¥­ç¸¾ + b.èˆŠå®¢æ¥­ç¸¾;
                        break;
                    case 'auguståŸå§‹æ¥­ç¸¾':
                        valueA = getAugustOriginalRevenue(a.storeName);
                        valueB = getAugustOriginalRevenue(b.storeName);
                        break;
                    case 'septåŸå§‹æ¥­ç¸¾':
                        valueA = getSeptOriginalRevenue(a.storeName);
                        valueB = getSeptOriginalRevenue(b.storeName);
                        break;
                    case 'octåŸå§‹æ¥­ç¸¾':
                        valueA = a.æ–°å®¢æ¥­ç¸¾ + a.èˆŠå®¢æ¥­ç¸¾;
                        valueB = b.æ–°å®¢æ¥­ç¸¾ + b.èˆŠå®¢æ¥­ç¸¾;
                        break;
                    case 'æ–°å®¢æ¥­ç¸¾':
                        valueA = a.æ–°å®¢æ¥­ç¸¾;
                        valueB = b.æ–°å®¢æ¥­ç¸¾;
                        break;
                    case 'è‡ªæˆ‘å®£å‘Šç›®æ¨™':
                        valueA = a.è‡ªæˆ‘å®£å‘Šç›®æ¨™;
                        valueB = b.è‡ªæˆ‘å®£å‘Šç›®æ¨™;
                        break;
                    case 'è‡ªæˆ‘å®£å‘Šé”æˆç‡':
                        // ä½¿ç”¨å¹³å‡ç©åˆ†è¨ˆç®—è‡ªæˆ‘å®£å‘Šé”æˆç‡
                        const aAugForRate = getAugustScore(a.storeName) || 0;
                        const bAugForRate = getAugustScore(b.storeName) || 0;
                        const aSepForRate = getSeptemberScore(a.storeName) || 0;
                        const bSepForRate = getSeptemberScore(b.storeName) || 0;
                        const aOctForRate = a.amountScore || 0;
                        const bOctForRate = b.amountScore || 0;
                        const aAvgForRate = Math.round((aAugForRate + aSepForRate + aOctForRate) / 3);
                        const bAvgForRate = Math.round((bAugForRate + bSepForRate + bOctForRate) / 3);
                        const aTargetForRate = a.è‡ªæˆ‘å®£å‘Šç›®æ¨™ || 1; // é¿å…é™¤ä»¥0
                        const bTargetForRate = b.è‡ªæˆ‘å®£å‘Šç›®æ¨™ || 1;
                        valueA = (aAvgForRate / aTargetForRate) * 100;
                        valueB = (bAvgForRate / bTargetForRate) * 100;
                        break;
                    case 'customerAvgRank':
                        // ä½¿ç”¨å¹³å‡å®¢æˆ¶æ•¸ç©åˆ†æ’å
                        const customerRankMap = computeCustomerAvgRankMap(currentData);
                        valueA = customerRankMap[a.storeName] || Number.MAX_VALUE;
                        valueB = customerRankMap[b.storeName] || Number.MAX_VALUE;
                        break;
                    case 'èˆŠå®¢æ¥­ç¸¾':
                        valueA = a.èˆŠå®¢æ¥­ç¸¾;
                        valueB = b.èˆŠå®¢æ¥­ç¸¾;
                        break;
                    case 'æ–°å®¢æ•¸':
                        valueA = a.æ–°å®¢æ•¸;
                        valueB = b.æ–°å®¢æ•¸;
                        break;
                    case 'èˆŠå®¢æ•¸':
                        valueA = a.èˆŠå®¢æ•¸;
                        valueB = b.èˆŠå®¢æ•¸;
                        break;
                    case 'ä¸­å’Œæ¯”ä¾‹':
                        valueA = parseFloat(a.ä¸­å’Œæ¯”ä¾‹.replace('%', ''));
                        valueB = parseFloat(b.ä¸­å’Œæ¯”ä¾‹.replace('%', ''));
                        break;
                    case 'augustScore':
                        // ç›´æ¥ç²å–8æœˆä»½çš„é‡‘é¡ç©åˆ†
                        valueA = getAugustScore(a.storeName) || -1;
                        valueB = getAugustScore(b.storeName) || -1;
                        break;
                    case 'septemberScore':
                        // ç›´æ¥ç²å–9æœˆä»½çš„é‡‘é¡ç©åˆ†
                        valueA = getSeptemberScore(a.storeName) || -1;
                        valueB = getSeptemberScore(b.storeName) || -1;
                        break;
                    case 'avgScore':
                        // å¹³å‡ï¼šè¨ˆç®—8æœˆ + 9æœˆ + 10æœˆçš„å¹³å‡ç©åˆ†ï¼Œå›ºå®šé™¤ä»¥3
                        const aAug = getAugustScore(a.storeName) || 0;
                        const bAug = getAugustScore(b.storeName) || 0;
                        const aSep = getSeptemberScore(a.storeName) || 0;
                        const bSep = getSeptemberScore(b.storeName) || 0;
                        const aOct = a.amountScore || 0;
                        const bOct = b.amountScore || 0;
                        
                        valueA = Math.round((aAug + aSep + aOct) / 3);
                        valueB = Math.round((bAug + bSep + bOct) / 3);
                        break;
                    case 'augä¸­å’Œé‡‘é¡ä½”æ¯”':
                        // 8æœˆä¸­å’Œé‡‘é¡ä½”æ¯”
                        const aStoreDataAug = getStoreData(a.storeName);
                        const bStoreDataAug = getStoreData(b.storeName);
                        const aAugZh = aStoreDataAug?.august?.zhonghe?.amount || 0;
                        const aAugOut = aStoreDataAug?.august?.outsource?.amount || 0;
                        const bAugZh = bStoreDataAug?.august?.zhonghe?.amount || 0;
                        const bAugOut = bStoreDataAug?.august?.outsource?.amount || 0;
                        valueA = (aAugZh + aAugOut) === 0 ? 0 : (aAugZh / (aAugZh + aAugOut)) * 100;
                        valueB = (bAugZh + bAugOut) === 0 ? 0 : (bAugZh / (bAugZh + bAugOut)) * 100;
                        break;
                    case 'sepä¸­å’Œé‡‘é¡ä½”æ¯”':
                        // 9æœˆä¸­å’Œé‡‘é¡ä½”æ¯”
                        const aStoreDataSep = getStoreData(a.storeName);
                        const bStoreDataSep = getStoreData(b.storeName);
                        const aSepZh = aStoreDataSep?.september?.zhonghe?.amount || 0;
                        const aSepOut = aStoreDataSep?.september?.outsource?.amount || 0;
                        const bSepZh = bStoreDataSep?.september?.zhonghe?.amount || 0;
                        const bSepOut = bStoreDataSep?.september?.outsource?.amount || 0;
                        valueA = (aSepZh + aSepOut) === 0 ? 0 : (aSepZh / (aSepZh + aSepOut)) * 100;
                        valueB = (bSepZh + bSepOut) === 0 ? 0 : (bSepZh / (bSepZh + bSepOut)) * 100;
                        break;
                    case 'octä¸­å’Œé‡‘é¡ä½”æ¯”':
                        // 10æœˆä¸­å’Œé‡‘é¡ä½”æ¯”
                        const aStoreDataOct = getStoreData(a.storeName);
                        const bStoreDataOct = getStoreData(b.storeName);
                        const aOctZh = aStoreDataOct?.october?.zhonghe?.amount || 0;
                        const aOctOut = aStoreDataOct?.october?.outsource?.amount || 0;
                        const bOctZh = bStoreDataOct?.october?.zhonghe?.amount || 0;
                        const bOctOut = bStoreDataOct?.october?.outsource?.amount || 0;
                        valueA = (aOctZh + aOctOut) === 0 ? 0 : (aOctZh / (aOctZh + aOctOut)) * 100;
                        valueB = (bOctZh + bOctOut) === 0 ? 0 : (bOctZh / (bOctZh + bOctOut)) * 100;
                        break;
                    case 'totalä¸­å’Œé‡‘é¡ä½”æ¯”':
                        // ä¸‰å€‹æœˆä¸­å’Œé‡‘é¡ä½”æ¯”
                        const aStoreDataTotal = getStoreData(a.storeName);
                        const bStoreDataTotal = getStoreData(b.storeName);
                        const aTotalZh = (aStoreDataTotal?.august?.zhonghe?.amount || 0) + 
                                        (aStoreDataTotal?.september?.zhonghe?.amount || 0) + 
                                        (aStoreDataTotal?.october?.zhonghe?.amount || 0);
                        const aTotalOut = (aStoreDataTotal?.august?.outsource?.amount || 0) + 
                                         (aStoreDataTotal?.september?.outsource?.amount || 0) + 
                                         (aStoreDataTotal?.october?.outsource?.amount || 0);
                        const bTotalZh = (bStoreDataTotal?.august?.zhonghe?.amount || 0) + 
                                        (bStoreDataTotal?.september?.zhonghe?.amount || 0) + 
                                        (bStoreDataTotal?.october?.zhonghe?.amount || 0);
                        const bTotalOut = (bStoreDataTotal?.august?.outsource?.amount || 0) + 
                                         (bStoreDataTotal?.september?.outsource?.amount || 0) + 
                                         (bStoreDataTotal?.october?.outsource?.amount || 0);
                        valueA = (aTotalZh + aTotalOut) === 0 ? 0 : (aTotalZh / (aTotalZh + aTotalOut)) * 100;
                        valueB = (bTotalZh + bTotalOut) === 0 ? 0 : (bTotalZh / (bTotalZh + bTotalOut)) * 100;
                        break;
                    default:
                        return 0;
                }

                // æ¯”è¼ƒé‚è¼¯
                if (typeof valueA === 'string') {
                    return currentSort.direction === 'asc' 
                        ? valueA.localeCompare(valueB)
                        : valueB.localeCompare(valueA);
                } else {
                    return currentSort.direction === 'asc' 
                        ? valueA - valueB
                        : valueB - valueA;
                }
            });

            // é‡æ–°å¡«å……è¡¨æ ¼
            if (currentMainTab === 'amount') {
                const group = currentGroupTab.replace('group-', '').toUpperCase();
                populateGroupTableWithData(group, currentData);
            } else if (currentMainTab === 'customer') {
                if (currentGroupTab === 'customer-ab') {
                    populateCustomerABTableWithData(currentData);
                } else if (currentGroupTab === 'customer-c') {
                    populateCustomerCTableWithData(currentData);
                }
            } else if (currentMainTab === 'region') {
                const region = currentGroupTab.replace('region-', '');
                populateRegionTableWithData(region, currentData);
            }

            // æ›´æ–°æ’åºè³‡è¨Š
            updateSortInfo(field);
        }

        // ä½¿ç”¨æŒ‡å®šæ•¸æ“šå¡«å……çµ„åˆ¥è¡¨æ ¼
        function populateGroupTableWithData(group, data) {
            const tbody = document.getElementById(`group-${group.toLowerCase()}-table`);
            if (!tbody) return;
            
            tbody.innerHTML = '';
            
            // ç¸½æ˜¯è¨ˆç®—å¹³å‡ç©åˆ†æ’åæ˜ å°„
            const avgRankMap = computeAvgRankMap(data);
            const customerRankMap = currentSort.field === 'å®¢æˆ¶æ•¸æ’å' ? computeCustomerAvgRankMap(data) : null;
            
            // åˆå§‹åŒ–ç¸½è¨ˆè®Šæ•¸
            let totalAugScore = 0;
            let totalSepScore = 0;
            let totalOctScore = 0;
            let totalAvgScore = 0;
            let storeCount = data.length;
            
            data.forEach((store) => {
                const isAmountQualified = isAmountQualifiedForStore(store);
                const hasNoPerformance = store.amountScore === 0;
                
                let rowClass = `group-${store.group.toLowerCase()}`;
                if (hasNoPerformance) rowClass += ' no-performance';
                
                const row = document.createElement('tr');
                row.className = rowClass;
                
                // æ ¹æ“šç•¶å‰æ’åºæ¬„ä½é¡¯ç¤ºå°æ‡‰çš„æ’å
                let rankDisplay;
                if (currentSort.field === 'å®¢æˆ¶æ•¸æ’å') {
                    rankDisplay = customerRankMap ? customerRankMap[store.storeName] : store.å®¢æˆ¶æ•¸æ’å;
                } else {
                    // é è¨­é¡¯ç¤ºå¹³å‡ç©åˆ†æ’å
                    const avgRank = avgRankMap[store.storeName];
                    rankDisplay = avgRank;
                }
                
                // è¨ˆç®—å…«æœˆã€ä¹æœˆå’Œåæœˆçš„ç©åˆ†
                const augScore = getAugustScore(store.storeName);
                const augThreshold = store.amountThreshold || store.è‡ªæˆ‘å®£å‘Šç›®æ¨™ || 0;
                const isAugQualified = (typeof augScore === 'number' && augScore >= augThreshold);
                const augDisplay = (typeof augScore === 'number') ? formatNumber(augScore) : '-';

                const sepScore = getSeptemberScore(store.storeName);
                const isSepQualified = (typeof sepScore === 'number' && sepScore >= augThreshold);
                const sepDisplay = (typeof sepScore === 'number') ? formatNumber(sepScore) : '-';

                const octScore = store.amountScore;
                const isOctQualified = isAmountQualified;
                const octDisplay = hasNoPerformance ? '<span class="performance-status">å°šç„¡ç©åˆ†</span>' : formatNumber(octScore);

                // è¨ˆç®—å¹³å‡ç©åˆ† (8æœˆ + 9æœˆ + 10æœˆ)ï¼Œå›ºå®šé™¤ä»¥3
                const augScoreValue = typeof augScore === 'number' ? augScore : 0;
                const sepScoreValue = typeof sepScore === 'number' ? sepScore : 0;
                const octScoreValue = octScore || 0;
                const avgScore = Math.round((augScoreValue + sepScoreValue + octScoreValue) / 3);
                const avgDisplay = avgScore > 0 ? formatNumber(avgScore) : '0';
                const isAvgQualified = isScoreQualifiedForStore(store, avgScore);
                
                // è¨ˆç®—è‡ªæˆ‘å®£å‘Šé”æˆç‡ï¼ˆä½¿ç”¨å¹³å‡ç©åˆ†ï¼‰
                const selfDeclaredTarget = store.è‡ªæˆ‘å®£å‘Šç›®æ¨™ || 0;
                const selfDeclaredRate = selfDeclaredTarget > 0 ? Math.round((avgScore / selfDeclaredTarget) * 100) + '%' : '0%';

                // ç´¯åŠ ç¸½è¨ˆ
                totalAugScore += augScoreValue;
                totalSepScore += sepScoreValue;
                totalOctScore += octScoreValue;
                totalAvgScore += avgScore;
                
                // ç²å–å§”å¤–/ä¸­å’Œæ•¸æ“š
                const storeOutsourceData = getStoreData(store.storeName);
                const augZhAmount = storeOutsourceData?.august?.zhonghe?.amount || 0;
                const augOutAmount = storeOutsourceData?.august?.outsource?.amount || 0;
                const sepZhAmount = storeOutsourceData?.september?.zhonghe?.amount || 0;
                const sepOutAmount = storeOutsourceData?.september?.outsource?.amount || 0;
                const octZhAmount = storeOutsourceData?.october?.zhonghe?.amount || 0;
                const octOutAmount = storeOutsourceData?.october?.outsource?.amount || 0;
                
                // è¨ˆç®—ä¸­å’Œé‡‘é¡ä½”æ¯”
                const augPercentage = calculatePercentage(augZhAmount, augOutAmount);
                const sepPercentage = calculatePercentage(sepZhAmount, sepOutAmount);
                const octPercentage = calculatePercentage(octZhAmount, octOutAmount);
                const totalPercentage = calculatePercentage(
                    augZhAmount + sepZhAmount + octZhAmount,
                    augOutAmount + sepOutAmount + octOutAmount
                );

                row.innerHTML = `
                    <td class="number-cell">${rankDisplay}</td>
                    <td class="store-name">${store.storeName}</td>
                    <td>${getRegionBadge(store.region)}</td>
                    <td class="number-cell ${isAugQualified ? 'qualified' : ''}">${augDisplay}</td>
                    <td class="number-cell ${isSepQualified ? 'qualified' : ''}">${sepDisplay}</td>
                    <td class="number-cell ${isOctQualified ? 'qualified' : ''}">${octDisplay}</td>
                    <td class="number-cell ${isAvgQualified ? 'qualified' : ''}">${avgDisplay}</td>
                    <td class="number-cell">${formatNumber(store.è‡ªæˆ‘å®£å‘Šç›®æ¨™)}</td>
                    <td class="number-cell">
                        <span class="self-declared-rate ${getSelfDeclaredRateClass(selfDeclaredRate)}">${selfDeclaredRate}</span>
                    </td>
                    <td class="number-cell"><span class="zhonghe-ratio ${getZhongheRatioClass(augPercentage)}">${augPercentage}</span></td>
                    <td class="number-cell"><span class="zhonghe-ratio ${getZhongheRatioClass(sepPercentage)}">${sepPercentage}</span></td>
                    <td class="number-cell"><span class="zhonghe-ratio ${getZhongheRatioClass(octPercentage)}">${octPercentage}</span></td>
                    <td class="number-cell"><span class="zhonghe-ratio ${getZhongheRatioClass(totalPercentage)}">${totalPercentage}</span></td>
                `;
                tbody.appendChild(row);
            });
            
            // æ·»åŠ ç¸½è¨ˆåˆ—
            const totalRow = document.createElement('tr');
            totalRow.className = 'total-row';
            totalRow.innerHTML = `
                <td class="number-cell">-</td>
                <td class="store-name">åˆè¨ˆ (${storeCount}å®¶)</td>
                <td>-</td>
                <td class="number-cell">${formatNumber(totalAugScore)}</td>
                <td class="number-cell">${formatNumber(totalSepScore)}</td>
                <td class="number-cell">${formatNumber(totalOctScore)}</td>
                <td class="number-cell">${formatNumber(totalAvgScore)}</td>
                <td class="number-cell">-</td>
                <td class="number-cell">-</td>
                <td class="number-cell">-</td>
                <td class="number-cell">-</td>
                <td class="number-cell">-</td>
                <td class="number-cell">-</td>
            `;
            tbody.appendChild(totalRow);
        }

        // ä½¿ç”¨æŒ‡å®šæ•¸æ“šå¡«å……å®¢æˆ¶A+Bè¡¨æ ¼
        function populateCustomerABTableWithData(data) {
            const tbody = document.getElementById('customer-ab-table');
            if (!tbody) return;
            
            tbody.innerHTML = '';
            
            // è¨ˆç®—å¹³å‡å®¢æˆ¶æ•¸ç©åˆ†æ’å
            const customerAvgRankMap = computeCustomerAvgRankMap(data);
            
            // åˆå§‹åŒ–ç¸½è¨ˆ
            let totalNewCustomers = 0;
            let totalOldCustomers = 0;
            
            data.forEach((store, index) => {
                const hasNoPerformance = store.customerScore === 0;
                // ç´¯åŠ ç¸½è¨ˆ
                totalNewCustomers += Number(store.æ–°å®¢æ•¸) || 0;
                totalOldCustomers += Number(store.èˆŠå®¢æ•¸) || 0;

                let rowClass = `group-${store.group.toLowerCase()}`;
                if (hasNoPerformance) rowClass += ' no-performance';

                const row = document.createElement('tr');
                row.className = rowClass;

                // é¡¯ç¤ºå¹³å‡å®¢æˆ¶æ•¸æ’å
                const rankDisplay = customerAvgRankMap[store.storeName] || store.å®¢æˆ¶æ•¸æ’å;

                // ç²å–å„å€‹éšæ®µçš„ç©åˆ†ï¼Œä¸¦åˆ†åˆ¥åˆ¤æ–·æ˜¯å¦é”æ¨™
                const augScore = getAugustCustomerScore(store.storeName) || 0;
                const sepScore = getSeptemberCustomerScore(store.storeName) || 0;
                const octScore = store.customerScore || 0;
                const avgScore = getAverageCustomerScore(store.storeName);
                
                // ç²å–å§”å¤–/ä¸­å’Œæ•¸æ“š
                const storeOutsourceData = getStoreData(store.storeName);
                const augZhAmount = storeOutsourceData?.august?.zhonghe?.amount || 0;
                const augOutAmount = storeOutsourceData?.august?.outsource?.amount || 0;
                const sepZhAmount = storeOutsourceData?.september?.zhonghe?.amount || 0;
                const sepOutAmount = storeOutsourceData?.september?.outsource?.amount || 0;
                const octZhAmount = storeOutsourceData?.october?.zhonghe?.amount || 0;
                const octOutAmount = storeOutsourceData?.october?.outsource?.amount || 0;
                
                // è¨ˆç®—ä¸­å’Œé‡‘é¡ä½”æ¯”
                const augPercentage = calculatePercentage(augZhAmount, augOutAmount);
                const sepPercentage = calculatePercentage(sepZhAmount, sepOutAmount);
                const octPercentage = calculatePercentage(octZhAmount, octOutAmount);
                const totalPercentage = calculatePercentage(
                    augZhAmount + sepZhAmount + octZhAmount,
                    augOutAmount + sepOutAmount + octOutAmount
                );

                row.innerHTML = `
                    <td class="number-cell">${rankDisplay}</td>
                    <td class="store-name">${store.storeName}</td>
                    <td>${getGroupBadge(store.group)}</td>
                    <td>${getRegionBadge(store.region)}</td>
                    <td class="number-cell ${isCustomerQualifiedForStore(store, augScore) ? 'qualified' : ''}">${augScore}</td>
                    <td class="number-cell ${isCustomerQualifiedForStore(store, sepScore) ? 'qualified' : ''}">${sepScore}</td>
                    <td class="number-cell ${isCustomerQualifiedForStore(store, octScore) ? 'qualified' : ''}">${octScore}</td>
                    <td class="number-cell ${isCustomerQualifiedForStore(store, avgScore) ? 'qualified' : ''}">${avgScore}</td>
                    <td class="number-cell"><span class="zhonghe-ratio ${getZhongheRatioClass(augPercentage)}">${augPercentage}</span></td>
                    <td class="number-cell"><span class="zhonghe-ratio ${getZhongheRatioClass(sepPercentage)}">${sepPercentage}</span></td>
                    <td class="number-cell"><span class="zhonghe-ratio ${getZhongheRatioClass(octPercentage)}">${octPercentage}</span></td>
                    <td class="number-cell"><span class="zhonghe-ratio ${getZhongheRatioClass(totalPercentage)}">${totalPercentage}</span></td>
                `;
                tbody.appendChild(row);
            });
        }

        // ä½¿ç”¨æŒ‡å®šæ•¸æ“šå¡«å……å®¢æˆ¶Cçµ„è¡¨æ ¼
        function populateCustomerCTableWithData(data) {
            const tbody = document.getElementById('customer-c-table');
            if (!tbody) return;
            
            tbody.innerHTML = '';
            
            // è¨ˆç®—å¹³å‡å®¢æˆ¶æ•¸ç©åˆ†æ’å
            const customerAvgRankMap = computeCustomerAvgRankMap(data);
            
            // åˆå§‹åŒ–ç¸½è¨ˆ
            let totalNewCustomers = 0;
            let totalOldCustomers = 0;
            
            data.forEach((store, index) => {
                const hasNoPerformance = store.customerScore === 0;
                // ç´¯åŠ ç¸½è¨ˆ
                totalNewCustomers += Number(store.æ–°å®¢æ•¸) || 0;
                totalOldCustomers += Number(store.èˆŠå®¢æ•¸) || 0;

                let rowClass = `group-${store.group.toLowerCase()}`;
                if (hasNoPerformance) rowClass += ' no-performance';

                const row = document.createElement('tr');
                row.className = rowClass;

                // é¡¯ç¤ºå¹³å‡å®¢æˆ¶æ•¸æ’å
                const rankDisplay = customerAvgRankMap[store.storeName] || store.å®¢æˆ¶æ•¸æ’å;

                // ç²å–å„å€‹éšæ®µçš„ç©åˆ†ï¼Œä¸¦åˆ†åˆ¥åˆ¤æ–·æ˜¯å¦é”æ¨™
                const augScore = getAugustCustomerScore(store.storeName) || 0;
                const sepScore = getSeptemberCustomerScore(store.storeName) || 0;
                const octScore = store.customerScore || 0;
                const avgScore = getAverageCustomerScore(store.storeName);
                
                // ç²å–å§”å¤–/ä¸­å’Œæ•¸æ“š
                const storeOutsourceData = getStoreData(store.storeName);
                const augZhAmount = storeOutsourceData?.august?.zhonghe?.amount || 0;
                const augOutAmount = storeOutsourceData?.august?.outsource?.amount || 0;
                const sepZhAmount = storeOutsourceData?.september?.zhonghe?.amount || 0;
                const sepOutAmount = storeOutsourceData?.september?.outsource?.amount || 0;
                const octZhAmount = storeOutsourceData?.october?.zhonghe?.amount || 0;
                const octOutAmount = storeOutsourceData?.october?.outsource?.amount || 0;
                
                // è¨ˆç®—ä¸­å’Œé‡‘é¡ä½”æ¯”
                const augPercentage = calculatePercentage(augZhAmount, augOutAmount);
                const sepPercentage = calculatePercentage(sepZhAmount, sepOutAmount);
                const octPercentage = calculatePercentage(octZhAmount, octOutAmount);
                const totalPercentage = calculatePercentage(
                    augZhAmount + sepZhAmount + octZhAmount,
                    augOutAmount + sepOutAmount + octOutAmount
                );

                row.innerHTML = `
                    <td class="number-cell">${rankDisplay}</td>
                    <td class="store-name">${store.storeName}</td>
                    <td>${getGroupBadge(store.group)}</td>
                    <td>${getRegionBadge(store.region)}</td>
                    <td class="number-cell ${isCustomerQualifiedForStore(store, augScore) ? 'qualified' : ''}">${augScore}</td>
                    <td class="number-cell ${isCustomerQualifiedForStore(store, sepScore) ? 'qualified' : ''}">${sepScore}</td>
                    <td class="number-cell ${isCustomerQualifiedForStore(store, octScore) ? 'qualified' : ''}">${octScore}</td>
                    <td class="number-cell ${isCustomerQualifiedForStore(store, avgScore) ? 'qualified' : ''}">${avgScore}</td>
                    <td class="number-cell"><span class="zhonghe-ratio ${getZhongheRatioClass(augPercentage)}">${augPercentage}</span></td>
                    <td class="number-cell"><span class="zhonghe-ratio ${getZhongheRatioClass(sepPercentage)}">${sepPercentage}</span></td>
                    <td class="number-cell"><span class="zhonghe-ratio ${getZhongheRatioClass(octPercentage)}">${octPercentage}</span></td>
                    <td class="number-cell"><span class="zhonghe-ratio ${getZhongheRatioClass(totalPercentage)}">${totalPercentage}</span></td>
                `;
                tbody.appendChild(row);
            });
        }

        // æ›´æ–°æ’åºè³‡è¨Š
        function updateSortInfo(field) {
            const fieldNames = {
                'storeName': 'é–€å¸‚åç¨±',
                'region': 'å€åŸŸ',
                'group': 'çµ„åˆ¥',
                'amountScore': '10æœˆé‡‘é¡ç©åˆ†',
                'augustScore': '8æœˆé‡‘é¡ç©åˆ†',
                'septemberScore': '9æœˆé‡‘é¡ç©åˆ†',
                'avgScore': 'å¹³å‡é‡‘é¡ç©åˆ†',
                'avgRank': 'å¹³å‡ç©åˆ†æ’å',
                'customerScore': '10æœˆå®¢æˆ¶æ•¸ç©åˆ†',
                'augustCustomerScore': '8æœˆå®¢æˆ¶æ•¸ç©åˆ†',
                'septemberCustomerScore': '9æœˆå®¢æˆ¶æ•¸ç©åˆ†',
                'averageCustomerScore': 'å¹³å‡å®¢æˆ¶æ•¸ç©åˆ†',
                'auguståŸå§‹æ¥­ç¸¾': '8æœˆåŸå§‹æ¥­ç¸¾',
                'septåŸå§‹æ¥­ç¸¾': '9æœˆåŸå§‹æ¥­ç¸¾',
                'octåŸå§‹æ¥­ç¸¾': '10æœˆåŸå§‹æ¥­ç¸¾',
                'æ–°å®¢æ¥­ç¸¾': 'æ–°å®¢æ¥­ç¸¾',
                'èˆŠå®¢æ¥­ç¸¾': 'èˆŠå®¢æ¥­ç¸¾',
                'è‡ªæˆ‘å®£å‘Šç›®æ¨™': 'è‡ªæˆ‘å®£å‘Šç›®æ¨™',
                'è‡ªæˆ‘å®£å‘Šé”æˆç‡': 'è‡ªæˆ‘å®£å‘Šé”æˆç‡',
                'æ–°å®¢æ•¸': 'æ–°å®¢æ•¸',
                'èˆŠå®¢æ•¸': 'èˆŠå®¢æ•¸',
                'ä¸­å’Œæ¯”ä¾‹': 'ä¸­å’Œç™¼åŒ…æ¯”ä¾‹',
                'å®¢æˆ¶æ•¸æ’å': 'å®¢æˆ¶æ•¸æ’å',
                'åŸå§‹æ¥­ç¸¾': 'åŸå§‹æ¥­ç¸¾',
                'augä¸­å’Œé‡‘é¡ä½”æ¯”': '8æœˆä¸­å’Œé‡‘é¡ä½”æ¯”',
                'sepä¸­å’Œé‡‘é¡ä½”æ¯”': '9æœˆä¸­å’Œé‡‘é¡ä½”æ¯”',
                'octä¸­å’Œé‡‘é¡ä½”æ¯”': '10æœˆä¸­å’Œé‡‘é¡ä½”æ¯”',
                'totalä¸­å’Œé‡‘é¡ä½”æ¯”': 'ä¸‰å€‹æœˆä¸­å’Œé‡‘é¡ä½”æ¯”',
                'augé‡‘é¡': '8æœˆ(ä¸­å’Œ/å§”å¤–)',
                'sepé‡‘é¡': '9æœˆ(ä¸­å’Œ/å§”å¤–)',
                'octé‡‘é¡': '10æœˆ(ä¸­å’Œ/å§”å¤–)',
                'totalé‡‘é¡': '8+9+10æœˆ(ä¸­å’Œ/å§”å¤–)'
            };
            
            const direction = currentSort.direction === 'asc' ? 'å‡åº' : 'é™åº';
            let sortInfo = document.getElementById(`sort-info-${currentGroupTab}`);
            
            // å¦‚æœæ˜¯å§”å¤–/ä¸­å’Œåˆ†ææ¨™ç±¤é ï¼Œä½¿ç”¨ç‰¹å®šçš„ sort-info å…ƒç´ 
            if (currentMainTab === 'outsource') {
                sortInfo = document.getElementById('sort-info-outsource');
            }
            
            if (sortInfo) {
                sortInfo.textContent = `ç›®å‰æ’åºï¼šä¾${fieldNames[field]} (${direction})`;
            }
        }

        // æ›´æ–°çµ„åˆ¥çµ±è¨ˆè³‡è¨Š
        function updateGroupStats() {
            // è¨ˆç®—å„çµ„çš„é‡‘é¡ç©åˆ†ç¸½å’Œ
            const groups = ['A', 'B', 'C'];
            groups.forEach(group => {
                const groupData = competitionData.filter(store => store.group === group);
                const totalAmount = groupData.reduce((sum, store) => sum + store.amountScore, 0);
                // æ›´æ–°çµ„åˆ¥æ¨™ç±¤ä¸­çš„é‡‘é¡ç¸½å’Œ
                const amountElement = document.getElementById(`group-${group.toLowerCase()}-amount`);
                if (amountElement) {
                    amountElement.textContent = formatNumber(totalAmount);
                }
                // éš±è—åŸæœ‰çš„çµ±è¨ˆå€å¡Š
                const statsElement = document.getElementById(`group-${group.toLowerCase()}-stats`);
                if (statsElement) {
                    statsElement.style.display = 'none';
                }
            });
        }

        // æ›´æ–°çµ±è¨ˆè³‡è¨Š
        function updateStatisticsInfo() {
            const totalAmount = document.getElementById('total-amount');
            const growthRate = document.getElementById('growth-rate');
            
            if (totalAmount && growthRate && window.competitionStatistics) {
                totalAmount.textContent = formatNumber(window.competitionStatistics.åŸå§‹ç¸½æ¥­ç¸¾åŠ ç¸½);
                const growth = ((window.competitionStatistics.åŸå§‹ç¸½æ¥­ç¸¾åŠ ç¸½ - 300909) / 300909 * 100).toFixed(1);
                growthRate.textContent = `${growth}%`;
                growthRate.parentElement.classList.add(growth >= 0 ? 'positive' : 'negative');
            }
        }

        // ç²å–8æœˆä»½çš„è³‡æ–™ (å®‰å…¨å–ç”¨ï¼Œè‹¥æ‰¾ä¸åˆ°å›å‚³ null)
        function getAugustData(storeName) {
            if (typeof augustCompetitionData === 'undefined') {
                // augustCompetitionData å¯èƒ½å°šæœªè¼‰å…¥
                console.warn('augustCompetitionData is undefined');
                return null;
            }
            if (!Array.isArray(augustCompetitionData)) {
                console.warn('augustCompetitionData is not an array:', augustCompetitionData);
                return null;
            }
            return augustCompetitionData.find(s => s.storeName === storeName) || null;
        }

        // ç²å–8æœˆä»½çš„é‡‘é¡ç©åˆ†ï¼ˆè‹¥ä¸å­˜åœ¨å›å‚³ nullï¼‰
        function getAugustScore(storeName) {
            const store = getAugustData(storeName);
            if (!store) return null;
            return typeof store.amountScore !== 'undefined' ? Number(store.amountScore) : null;
        }

        // ç²å–9æœˆä»½çš„è³‡æ–™ (å®‰å…¨å–ç”¨ï¼Œè‹¥æ‰¾ä¸åˆ°å›å‚³ null)
        function getSeptemberData(storeName) {
            if (typeof septemberCompetitionData === 'undefined') {
                console.warn('septemberCompetitionData is undefined');
                return null;
            }
            if (!Array.isArray(septemberCompetitionData)) {
                console.warn('septemberCompetitionData is not an array:', septemberCompetitionData);
                return null;
            }
            return septemberCompetitionData.find(s => s.storeName === storeName) || null;
        }

        // ç²å–9æœˆä»½çš„é‡‘é¡ç©åˆ†ï¼ˆè‹¥ä¸å­˜åœ¨å›å‚³ nullï¼‰
        function getSeptemberScore(storeName) {
            const store = getSeptemberData(storeName);
            if (!store) return null;
            return typeof store.amountScore !== 'undefined' ? Number(store.amountScore) : null;
        }

        // ç²å–9æœˆä»½çš„å®¢æˆ¶æ•¸ç©åˆ†ï¼ˆè‹¥ä¸å­˜åœ¨å›å‚³ nullï¼‰
        function getSeptemberCustomerScore(storeName) {
            const store = getSeptemberData(storeName);
            if (!store) return null;
            return typeof store.customerScore !== 'undefined' ? Number(store.customerScore) : null;
        }

        // ç²å–8æœˆä»½çš„å®¢æˆ¶æ•¸ç©åˆ†ï¼ˆè‹¥ä¸å­˜åœ¨å›å‚³ nullï¼‰
        function getAugustCustomerScore(storeName) {
            const store = getAugustData(storeName);
            if (!store) return null;
            return typeof store.customerScore !== 'undefined' ? Number(store.customerScore) : null;
        }

        // è¨ˆç®—8æœˆå’Œ9æœˆçš„å¹³å‡å®¢æˆ¶æ•¸ç©åˆ†
        function getAverageCustomerScore(storeName) {
            const augustScore = getAugustCustomerScore(storeName) || 0;
            const septemberScore = getSeptemberCustomerScore(storeName) || 0;
            const octoberStore = competitionData.find(s => s.storeName === storeName);
            const octoberScore = octoberStore ? (Number(octoberStore.customerScore) || 0) : 0;
            
            // å›ºå®šé™¤ä»¥3ï¼Œæ²’æœ‰æ¥­ç¸¾å°±ç•¶ä½œ0
            return Math.round((augustScore + septemberScore + octoberScore) / 3);
        }

        // ç²å–8æœˆä»½çš„åŸå§‹æ¥­ç¸¾ï¼ˆæ–°å®¢æ¥­ç¸¾ + èˆŠå®¢æ¥­ç¸¾ï¼‰
        function getAugustOriginalRevenue(storeName) {
            const store = getAugustData(storeName);
            if (!store) return 0;
            const newCustomer = Number(store.æ–°å®¢æ¥­ç¸¾) || 0;
            const oldCustomer = Number(store.èˆŠå®¢æ¥­ç¸¾) || 0;
            return newCustomer + oldCustomer;
        }

        // ç²å–9æœˆä»½çš„åŸå§‹æ¥­ç¸¾ï¼ˆæ–°å®¢æ¥­ç¸¾ + èˆŠå®¢æ¥­ç¸¾ï¼‰
        function getSeptOriginalRevenue(storeName) {
            const store = getSeptemberData(storeName);
            if (!store) return 0;
            const newCustomer = Number(store.æ–°å®¢æ¥­ç¸¾) || 0;
            const oldCustomer = Number(store.èˆŠå®¢æ¥­ç¸¾) || 0;
            return newCustomer + oldCustomer;
        }

        // æ¸²æŸ“çµ±è¨ˆå„€è¡¨ç‰ˆ KPI
        function renderStatisticsDashboard() {
            if (typeof competitionData === 'undefined' || typeof augustCompetitionData === 'undefined') return;
            const allStores = competitionData;
            const storeCount = allStores.length;
            // åˆè¨ˆ
            let augSum = 0, septSum = 0, octSum = 0;
            let augNewCount = 0, augOldCount = 0;
            let septNewCount = 0, septOldCount = 0;
            let octNewCount = 0, octOldCount = 0;
            let augNewRev = 0, augOldRev = 0;
            let septNewRev = 0, septOldRev = 0;
            let octNewRev = 0, octOldRev = 0;
            
            allStores.forEach(s => {
                // 8æœˆè³‡æ–™
                const aug = getAugustData(s.storeName) || {};
                const augNew = Number(aug.æ–°å®¢æ•¸) || 0;
                const augOld = Number(aug.èˆŠå®¢æ•¸) || 0;
                const augNewAmt = Number(aug.æ–°å®¢æ¥­ç¸¾) || 0;
                const augOldAmt = Number(aug.èˆŠå®¢æ¥­ç¸¾) || 0;
                augNewCount += augNew;
                augOldCount += augOld;
                augNewRev += augNewAmt;
                augOldRev += augOldAmt;
                augSum += (augNewAmt + augOldAmt);
                
                // 9æœˆè³‡æ–™
                const sept = getSeptemberData(s.storeName) || {};
                const septNew = Number(sept.æ–°å®¢æ•¸) || 0;
                const septOld = Number(sept.èˆŠå®¢æ•¸) || 0;
                const septNewAmt = Number(sept.æ–°å®¢æ¥­ç¸¾) || 0;
                const septOldAmt = Number(sept.èˆŠå®¢æ¥­ç¸¾) || 0;
                septNewCount += septNew;
                septOldCount += septOld;
                septNewRev += septNewAmt;
                septOldRev += septOldAmt;
                septSum += (septNewAmt + septOldAmt);
                
                // 10æœˆè³‡æ–™
                const oct = competitionData.find(x => x.storeName === s.storeName) || {};
                const octNew = Number(oct.æ–°å®¢æ•¸) || 0;
                const octOld = Number(oct.èˆŠå®¢æ•¸) || 0;
                const octNewAmt = Number(oct.æ–°å®¢æ¥­ç¸¾) || 0;
                const octOldAmt = Number(oct.èˆŠå®¢æ¥­ç¸¾) || 0;
                octNewCount += octNew;
                octOldCount += octOld;
                octNewRev += octNewAmt;
                octOldRev += octOldAmt;
                octSum += (octNewAmt + octOldAmt);
            });
            
            const augAvg = storeCount ? Math.round(augSum / storeCount) : 0;
            const septAvg = storeCount ? Math.round(septSum / storeCount) : 0;
            const octAvg = storeCount ? Math.round(octSum / storeCount) : 0;
            
            // å®¢å–®åƒ¹ï¼ˆARPUï¼‰
            const augNewArpu = augNewCount ? Math.round(augNewRev / augNewCount) : 0;
            const augOldArpu = augOldCount ? Math.round(augOldRev / augOldCount) : 0;
            const septNewArpu = septNewCount ? Math.round(septNewRev / septNewCount) : 0;
            const septOldArpu = septOldCount ? Math.round(septOldRev / septOldCount) : 0;
            const octNewArpu = octNewCount ? Math.round(octNewRev / octNewCount) : 0;
            const octOldArpu = octOldCount ? Math.round(octOldRev / octOldCount) : 0;
            
            const baseline = 300909;
            const augAch = baseline ? ((augSum / baseline) * 100).toFixed(1) : '0.0';
            const septAch = baseline ? ((septSum / baseline) * 100).toFixed(1) : '0.0';
            const octAch = baseline ? ((octSum / baseline) * 100).toFixed(1) : '0.0';

            // å¯«å…¥ DOM
            const byId = id => document.getElementById(id);
            const setText = (id, val) => { const el = byId(id); if (el) el.textContent = typeof val === 'number' ? val.toLocaleString() : val; };
            setText('kpi-store-count', storeCount);
            
            // 8æœˆ
            setText('kpi-aug-sum', augSum);
            setText('kpi-aug-avg', augAvg);
            setText('kpi-aug-achievement-rate', `${augAch}%`);
            setText('kpi-aug-new-count', augNewCount);
            setText('kpi-aug-old-count', augOldCount);
            setText('kpi-aug-new-rev', augNewRev);
            setText('kpi-aug-old-rev', augOldRev);
            setText('kpi-aug-new-arpu', augNewArpu);
            setText('kpi-aug-old-arpu', augOldArpu);
            
            // 9æœˆ
            setText('kpi-sept-sum', septSum);
            setText('kpi-sept-avg', septAvg);
            setText('kpi-sept-achievement-rate', `${septAch}%`);
            setText('kpi-sept-new-count', septNewCount);
            setText('kpi-sept-old-count', septOldCount);
            setText('kpi-sept-new-rev', septNewRev);
            setText('kpi-sept-old-rev', septOldRev);
            setText('kpi-sept-new-arpu', septNewArpu);
            setText('kpi-sept-old-arpu', septOldArpu);
            
            // 10æœˆ
            setText('kpi-oct-sum', octSum);
            setText('kpi-oct-avg', octAvg);
            setText('kpi-oct-achievement-rate', `${octAch}%`);
            setText('kpi-oct-new-count', octNewCount);
            setText('kpi-oct-old-count', octOldCount);
            setText('kpi-oct-new-rev', octNewRev);
            setText('kpi-oct-old-rev', octOldRev);
            setText('kpi-oct-new-arpu', octNewArpu);
            setText('kpi-oct-old-arpu', octOldArpu);
            
            // è¨ˆç®—å§”å¤–/ä¸­å’Œçµ±è¨ˆ
            let augOutCount = 0, augOutAmount = 0, augZhCount = 0, augZhAmount = 0;
            let sepOutCount = 0, sepOutAmount = 0, sepZhCount = 0, sepZhAmount = 0;
            let octOutCount = 0, octOutAmount = 0, octZhCount = 0, octZhAmount = 0;
            
            if (typeof storeData !== 'undefined') {
                competitionData.forEach(store => {
                    const storeInfo = getStoreData(store.storeName);
                    if (storeInfo) {
                        augOutCount += storeInfo.august?.outsource?.count || 0;
                        augOutAmount += storeInfo.august?.outsource?.amount || 0;
                        augZhCount += storeInfo.august?.zhonghe?.count || 0;
                        augZhAmount += storeInfo.august?.zhonghe?.amount || 0;
                        
                        sepOutCount += storeInfo.september?.outsource?.count || 0;
                        sepOutAmount += storeInfo.september?.outsource?.amount || 0;
                        sepZhCount += storeInfo.september?.zhonghe?.count || 0;
                        sepZhAmount += storeInfo.september?.zhonghe?.amount || 0;
                        
                        octOutCount += storeInfo.october?.outsource?.count || 0;
                        octOutAmount += storeInfo.october?.outsource?.amount || 0;
                        octZhCount += storeInfo.october?.zhonghe?.count || 0;
                        octZhAmount += storeInfo.october?.zhonghe?.amount || 0;
                    }
                });
                
                // æ›´æ–°å‰ä¸‰è¡Œçš„ä¸­å’Œ/å§”å¤–å¡ç‰‡
                // 8æœˆ
                setText('kpi-aug-zh-amount', augZhAmount);
                setText('kpi-aug-out-amount', augOutAmount);
                setText('kpi-aug-zh-count', augZhCount);
                setText('kpi-aug-out-count', augOutCount);
                
                // 9æœˆ
                setText('kpi-sept-zh-amount', sepZhAmount);
                setText('kpi-sept-out-amount', sepOutAmount);
                setText('kpi-sept-zh-count', sepZhCount);
                setText('kpi-sept-out-count', sepOutCount);
                
                // 10æœˆ
                setText('kpi-oct-zh-amount', octZhAmount);
                setText('kpi-oct-out-amount', octOutAmount);
                setText('kpi-oct-zh-count', octZhCount);
                setText('kpi-oct-out-count', octOutCount);
            }
        }
        
        // ç²å–å§”å¤–/ä¸­å’Œæ•¸æ“š
        function getStoreData(storeName) {
            if (typeof storeData === 'undefined') return null;
            return storeData.find(store => store.storeName === storeName);
        }
        
        // è¨ˆç®—ç™¾åˆ†æ¯”ï¼ˆåªè¿”å›ç™¾åˆ†æ¯”æ•¸å­—ï¼Œä¾‹å¦‚ "86%"ï¼Œå››æ¨äº”å…¥åˆ°æ•´æ•¸ï¼‰
        function calculatePercentage(zhonghe, outsource) {
            const zh = zhonghe || 0;
            const out = outsource || 0;
            const total = zh + out;
            if (total === 0) return '0%';
            return Math.round((zh / total) * 100) + '%';
        }
        
        // å¡«å……å§”å¤–/ä¸­å’Œè¡¨æ ¼
        function populateOutsourceTable(sortField = 'storeName', sortDirection = 'asc') {
            console.log('=== populateOutsourceTable ===');
            console.log('sortField:', sortField, '| sortDirection:', sortDirection);
            
            const tbody = document.getElementById('outsource-table');
            if (!tbody) {
                console.error('outsource-table not found!');
                return;
            }
            
            tbody.innerHTML = '';
            
            // æª¢æŸ¥è³‡æ–™æ˜¯å¦è¼‰å…¥
            if (typeof storeData === 'undefined') {
                tbody.innerHTML = '<tr><td colspan="11" style="text-align: center; padding: 20px; color: #e74c3c;">âŒ å§”å¤–/ä¸­å’Œæ•¸æ“šå°šæœªè¼‰å…¥ï¼Œè«‹ç¨å¾Œé‡è©¦</td></tr>';
                console.error('storeData is undefined');
                return;
            }
            
            if (!Array.isArray(storeData) || storeData.length === 0) {
                tbody.innerHTML = '<tr><td colspan="11" style="text-align: center; padding: 20px; color: #e74c3c;">âŒ å§”å¤–/ä¸­å’Œæ•¸æ“šç‚ºç©º</td></tr>';
                console.error('storeData is empty or not an array');
                return;
            }
            
            if (!competitionData || competitionData.length === 0) {
                tbody.innerHTML = '<tr><td colspan="11" style="text-align: center; padding: 20px; color: #e74c3c;">âŒ ç«¶è³½æ•¸æ“šå°šæœªè¼‰å…¥</td></tr>';
                console.error('competitionData is empty');
                return;
            }
            
            // è¨ˆç®—é‡‘é¡èˆ‡ä»¶æ•¸åˆä½µé¡¯ç¤ºï¼ˆä¸­å’Œé‡‘é¡(ä¸­å’Œä»¶æ•¸) / å§”å¤–é‡‘é¡(å§”å¤–ä»¶æ•¸)ï¼‰
            function calculateCombinedDetail(zhAmount, zhCount, outAmount, outCount) {
                const formattedZhAmount = formatNumber(zhAmount || 0);
                const formattedOutAmount = formatNumber(outAmount || 0);
                const zhCountNum = zhCount || 0;
                const outCountNum = outCount || 0;
                return `${formattedZhAmount}(${zhCountNum}) / ${formattedOutAmount}(${outCountNum})`;
            }
            
            // è¨ˆç®—ä½”æ¯”æ•¸å€¼ï¼ˆç”¨æ–¼é¡è‰²åˆ¤æ–·ï¼‰
            function calculateRatioValue(zhonghe, outsource) {
                const zh = zhonghe || 0;
                const out = outsource || 0;
                const total = zh + out;
                if (total === 0) return 0;
                return (zh / total) * 100;
            }
            
            // åˆå§‹åŒ–ç¸½è¨ˆè®Šæ•¸
            let totalAugZhCount = 0, totalAugOutCount = 0, totalAugZhAmount = 0, totalAugOutAmount = 0;
            let totalSepZhCount = 0, totalSepOutCount = 0, totalSepZhAmount = 0, totalSepOutAmount = 0;
            let totalOctZhCount = 0, totalOctOutCount = 0, totalOctZhAmount = 0, totalOctOutAmount = 0;
            
            // åˆä½µè³‡æ–™
            const mergedData = competitionData.map(store => {
                const storeInfo = getStoreData(store.storeName);
                
                // 8æœˆæ•¸æ“š
                const augZhCount = storeInfo?.august?.zhonghe?.count || 0;
                const augOutCount = storeInfo?.august?.outsource?.count || 0;
                const augZhAmount = storeInfo?.august?.zhonghe?.amount || 0;
                const augOutAmount = storeInfo?.august?.outsource?.amount || 0;
                
                // 9æœˆæ•¸æ“š
                const sepZhCount = storeInfo?.september?.zhonghe?.count || 0;
                const sepOutCount = storeInfo?.september?.outsource?.count || 0;
                const sepZhAmount = storeInfo?.september?.zhonghe?.amount || 0;
                const sepOutAmount = storeInfo?.september?.outsource?.amount || 0;
                
                // 10æœˆæ•¸æ“š
                const octZhCount = storeInfo?.october?.zhonghe?.count || 0;
                const octOutCount = storeInfo?.october?.outsource?.count || 0;
                const octZhAmount = storeInfo?.october?.zhonghe?.amount || 0;
                const octOutAmount = storeInfo?.october?.outsource?.amount || 0;
                
                // ç´¯åŠ ç¸½è¨ˆ
                totalAugZhCount += augZhCount;
                totalAugOutCount += augOutCount;
                totalAugZhAmount += augZhAmount;
                totalAugOutAmount += augOutAmount;
                totalSepZhCount += sepZhCount;
                totalSepOutCount += sepOutCount;
                totalSepZhAmount += sepZhAmount;
                totalSepOutAmount += sepOutAmount;
                totalOctZhCount += octZhCount;
                totalOctOutCount += octOutCount;
                totalOctZhAmount += octZhAmount;
                totalOctOutAmount += octOutAmount;
                
                return {
                    storeName: store.storeName,
                    group: store.group,
                    region: store.region,
                    // ç™¾åˆ†æ¯”æ¬„ä½ï¼ˆæœ‰é¡è‰²ï¼‰
                    augPercentage: calculatePercentage(augZhAmount, augOutAmount),
                    augRatioValue: calculateRatioValue(augZhAmount, augOutAmount),
                    sepPercentage: calculatePercentage(sepZhAmount, sepOutAmount),
                    sepRatioValue: calculateRatioValue(sepZhAmount, sepOutAmount),
                    octPercentage: calculatePercentage(octZhAmount, octOutAmount),
                    octRatioValue: calculateRatioValue(octZhAmount, octOutAmount),
                    totalPercentage: calculatePercentage(augZhAmount + sepZhAmount + octZhAmount, augOutAmount + sepOutAmount + octOutAmount),
                    totalRatioValue: calculateRatioValue(augZhAmount + sepZhAmount + octZhAmount, augOutAmount + sepOutAmount + octOutAmount),
                    // åˆä½µæ˜ç´°æ¬„ä½ï¼ˆé‡‘é¡+ä»¶æ•¸ï¼Œç„¡é¡è‰²ï¼‰
                    augCombined: calculateCombinedDetail(augZhAmount, augZhCount, augOutAmount, augOutCount),
                    sepCombined: calculateCombinedDetail(sepZhAmount, sepZhCount, sepOutAmount, sepOutCount),
                    octCombined: calculateCombinedDetail(octZhAmount, octZhCount, octOutAmount, octOutCount),
                    totalCombined: calculateCombinedDetail(
                        augZhAmount + sepZhAmount + octZhAmount, 
                        augZhCount + sepZhCount + octZhCount,
                        augOutAmount + sepOutAmount + octOutAmount, 
                        augOutCount + sepOutCount + octOutCount
                    )
                };
            });
            
            // æ’åº
            mergedData.sort((a, b) => {
                let valueA, valueB;
                
                switch(sortField) {
                    case 'storeName':
                        valueA = a.storeName;
                        valueB = b.storeName;
                        break;
                    case 'group':
                        valueA = a.group;
                        valueB = b.group;
                        break;
                    case 'region':
                        valueA = a.region;
                        valueB = b.region;
                        break;
                    case 'augä¸­å’Œé‡‘é¡ä½”æ¯”':
                        valueA = a.augRatioValue;
                        valueB = b.augRatioValue;
                        break;
                    case 'sepä¸­å’Œé‡‘é¡ä½”æ¯”':
                        valueA = a.sepRatioValue;
                        valueB = b.sepRatioValue;
                        break;
                    case 'octä¸­å’Œé‡‘é¡ä½”æ¯”':
                        valueA = a.octRatioValue;
                        valueB = b.octRatioValue;
                        break;
                    case 'totalä¸­å’Œé‡‘é¡ä½”æ¯”':
                        valueA = a.totalRatioValue;
                        valueB = b.totalRatioValue;
                        break;
                    case 'augé‡‘é¡':
                    case 'sepé‡‘é¡':
                    case 'octé‡‘é¡':
                    case 'totalé‡‘é¡':
                        // åˆä½µæ¬„ä½æš«ä¸æ”¯æ´æ’åºï¼Œä½¿ç”¨é–€å¸‚åç¨±
                        valueA = a.storeName;
                        valueB = b.storeName;
                        break;
                    default:
                        valueA = a.storeName;
                        valueB = b.storeName;
                }
                
                // æ¯”è¼ƒé‚è¼¯
                if (typeof valueA === 'string') {
                    return sortDirection === 'asc' 
                        ? valueA.localeCompare(valueB)
                        : valueB.localeCompare(valueA);
                } else {
                    return sortDirection === 'asc' 
                        ? valueA - valueB
                        : valueB - valueA;
                }
            });
            
            // èª¿è©¦ï¼šé¡¯ç¤ºæ’åºå¾Œçš„å‰5å€‹çµæœ
            console.log('Sorted results (first 5):');
            mergedData.slice(0, 5).forEach((store, i) => {
                console.log(`${i+1}. ${store.storeName} - aug:${store.augPercentage} (${store.augRatioValue})`);
            });
            
            // å¡«å……è¡¨æ ¼
            mergedData.forEach(store => {
                const row = tbody.insertRow();
                row.className = `group-${store.group.toLowerCase()}`;
                
                row.innerHTML = `
                    <td class="store-name">${store.storeName}</td>
                    <td style="text-align: center;">${getGroupBadge(store.group, true)}</td>
                    <td>${getRegionBadge(store.region)}</td>
                    <td class="number-cell"><span class="zhonghe-ratio ${getZhongheRatioClass(store.augPercentage)}">${store.augPercentage}</span></td>
                    <td class="number-cell"><span class="zhonghe-ratio ${getZhongheRatioClass(store.sepPercentage)}">${store.sepPercentage}</span></td>
                    <td class="number-cell"><span class="zhonghe-ratio ${getZhongheRatioClass(store.octPercentage)}">${store.octPercentage}</span></td>
                    <td class="number-cell"><span class="zhonghe-ratio ${getZhongheRatioClass(store.totalPercentage)}">${store.totalPercentage}</span></td>
                    <td class="number-cell">${store.augCombined}</td>
                    <td class="number-cell">${store.sepCombined}</td>
                    <td class="number-cell">${store.octCombined}</td>
                    <td class="number-cell">${store.totalCombined}</td>
                `;
            });
            
            // è¨ˆç®—ç¸½è¨ˆä½”æ¯”å’Œåˆä½µæ˜ç´°
            const totalAugPercentage = calculatePercentage(totalAugZhAmount, totalAugOutAmount);
            const totalAugCombined = calculateCombinedDetail(totalAugZhAmount, totalAugZhCount, totalAugOutAmount, totalAugOutCount);
            
            const totalSepPercentage = calculatePercentage(totalSepZhAmount, totalSepOutAmount);
            const totalSepCombined = calculateCombinedDetail(totalSepZhAmount, totalSepZhCount, totalSepOutAmount, totalSepOutCount);
            
            const totalOctPercentage = calculatePercentage(totalOctZhAmount, totalOctOutAmount);
            const totalOctCombined = calculateCombinedDetail(totalOctZhAmount, totalOctZhCount, totalOctOutAmount, totalOctOutCount);
            
            const grandTotalPercentage = calculatePercentage(
                totalAugZhAmount + totalSepZhAmount + totalOctZhAmount,
                totalAugOutAmount + totalSepOutAmount + totalOctOutAmount
            );
            
            const grandTotalCombined = calculateCombinedDetail(
                totalAugZhAmount + totalSepZhAmount + totalOctZhAmount,
                totalAugZhCount + totalSepZhCount + totalOctZhCount,
                totalAugOutAmount + totalSepOutAmount + totalOctOutAmount,
                totalAugOutCount + totalSepOutCount + totalOctOutCount
            );
            
            // åŠ å…¥ç¸½è¨ˆåˆ—
            const totalRow = tbody.insertRow();
            totalRow.className = 'total-row';
            totalRow.innerHTML = `
                <td class="store-name">åˆè¨ˆ (${mergedData.length}å®¶)</td>
                <td colspan="2">-</td>
                <td class="number-cell"><span class="zhonghe-ratio ${getZhongheRatioClass(totalAugPercentage)}">${totalAugPercentage}</span></td>
                <td class="number-cell"><span class="zhonghe-ratio ${getZhongheRatioClass(totalSepPercentage)}">${totalSepPercentage}</span></td>
                <td class="number-cell"><span class="zhonghe-ratio ${getZhongheRatioClass(totalOctPercentage)}">${totalOctPercentage}</span></td>
                <td class="number-cell"><span class="zhonghe-ratio ${getZhongheRatioClass(grandTotalPercentage)}">${grandTotalPercentage}</span></td>
                <td class="number-cell">${totalAugCombined}</td>
                <td class="number-cell">${totalSepCombined}</td>
                <td class="number-cell">${totalOctCombined}</td>
                <td class="number-cell">${grandTotalCombined}</td>
            `;
        }
        
        // å®¢æˆ¶æ•¸ç©åˆ†é–€æª»åˆ¤æ–·ï¼šA/Bçµ„ç‚º60ï¼ŒCçµ„ç‚º30
        function isCustomerQualifiedForStore(store, score) {
            const group = (store.group || '').toString().toUpperCase();
            const threshold = (group === 'C') ? 30 : 60;
            const s = (typeof score === 'number') ? score : Number(score) || 0;
            return s >= threshold;
        }
        // åˆå§‹åŒ–é é¢ï¼ˆåœ¨ DOMContentLoaded å¾ŒåŸ·è¡Œï¼‰
        document.addEventListener('DOMContentLoaded', function() {
            console.log('DOM ready â€” initializing page');

            // åŸºæœ¬æª¢æŸ¥ï¼šç¢ºä¿è³‡æ–™æª”å·²ç”±<script>è¼‰å…¥
            const missing = [];
            if (typeof competitionData === 'undefined') missing.push('competition-data.js');
            if (typeof augustCompetitionData === 'undefined') missing.push('competition-data-aug.js');
            if (typeof septemberCompetitionData === 'undefined') missing.push('competition-data-sep.js');
            if (typeof storeData === 'undefined') missing.push('store_data_js.js');

            if (missing.length) {
                console.error('Missing data files:', missing.join(', '));
                document.querySelector('.container').innerHTML = `
                    <div style="padding: 50px; text-align: center; color: #e74c3c;">
                        <h2>âŒ æ•¸æ“šè¼‰å…¥å¤±æ•—</h2>
                        <p>ç¼ºå°‘ä¸‹åˆ—è³‡æ–™æª”ï¼š${missing.join(', ')}</p>
                        <p>è«‹ç¢ºèªé€™äº›æª”æ¡ˆèˆ‡ HTML ä½æ–¼åŒä¸€ç›®éŒ„ï¼Œä¸¦æ­£ç¢ºè¼‰å…¥ã€‚</p>
                    </div>
                `;
                return;
            }

            // ä¸€åˆ‡æ­£å¸¸ï¼šè¼‰å…¥åˆå§‹ç•«é¢èˆ‡åŠŸèƒ½
            try {
                loadTabContent();
                initializeSorting();
                updateStatisticsInfo();
                updateGroupStats();
            } catch (err) {
                console.error('Error during initialization:', err);
                document.querySelector('.container').innerHTML = `
                    <div style="padding: 50px; text-align: center; color: #e74c3c;">
                        <h2>âŒ åˆå§‹åŒ–å¤±æ•—</h2>
                        <pre style="text-align:left; max-width:800px; margin:0 auto;">${err}</pre>
                    </div>
                `;
            }
        });
    </script>
</body>
</html>
                    