<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>0901-0907æ¨™ç±¤æ¥­ç¸¾ç«¶è³½æˆ°å ±</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Microsoft JhengHei', Arial, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 20px;
            min-height: 100vh;
        }
        
        .container {
            max-width: 1600px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            overflow: hidden;
        }
        
        .header {
            background: linear-gradient(135deg, #2c3e50 0%, #3498db 100%);
            color: white;
            padding: 10px;
            text-align: center;
        }
        
        .header h1 {
            font-size: 2em;
            margin-bottom: 5px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }
        
        .statistics-info {
            margin-top: 0px;
            font-size: 1em;
            color: #666;
        }

        .total-amount {
            color: #2196f3;
            font-weight: bold;
        }

        .baseline {
            color: #666;
        }

        .growth-rate {
            font-weight: bold;
        }

        .growth-rate.positive {
            color: #4caf50;
        }

        .growth-rate.negative {
            color: #f44336;
        }

        .update-time {
            background: #e3f2fd;
            padding: 12px;
            text-align: center;
            font-weight: bold;
            color: #1976d2;
            border-bottom: 2px solid #2196f3;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }
        
        .calendar-icon {
            color: #dc3545;
            font-size: 16px;
        }


        /* ä¸»å°èˆª - é‡‘é¡ç©åˆ† vs å®¢æˆ¶æ•¸ç©åˆ† */
        .main-nav {
            display: flex;
            background: #34495e;
            color: white;
            overflow: hidden;
        }
        
        .main-nav-item {
            flex: 1;
            padding: 8px;
            text-align: center;
            font-size: 14px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            border: none;
            background: #34495e;
            color: white;
        }
        
        .main-nav-item:hover {
            background: #2c3e50;
        }
        
        .main-nav-item.active {
            background: #3498db;
            border-bottom: 3px solid #e74c3c;
        }
        
        .main-nav-item:not(:last-child)::after {
            content: '';
            position: absolute;
            right: 0;
            top: 25%;
            height: 50%;
            width: 1px;
            background: rgba(255,255,255,0.3);
        }
        
        /* å­å°èˆª - çµ„åˆ¥é¸æ“‡ */
        .sub-nav {
            background: #34495e;
            border-bottom: 1px solid #2c3e50;
            padding: 0;
        }
        
        /* æ¨™ç±¤çµ„é¡¯ç¤ºæ§åˆ¶ */
        .tab-group {
            display: none;
            gap: 0;
        }
        
        .tab-group.active {
            display: flex;
        }
        
        .group-tabs {
            display: flex;
            justify-content: center;
            gap: 0;
            overflow-x: auto;
        }
        
        .group-tab {
            padding: 12px 18px;
            background: #34495e;
            color: white;
            border: none;
            border-bottom: 3px solid transparent;
            font-size: 0.95em;
            cursor: pointer;
            transition: all 0.3s ease;
            white-space: nowrap;
        }
        
        .group-tab span {
            font-weight: normal;
            opacity: 0.9;
            margin-left: 5px;
            font-size: 0.9em;
        }
        
        .group-tab:hover {
            background: #2c3e50;
        }
        
        .group-tab.active {
            background: #3498db;
            border-bottom-color: #e74c3c;
        }
        
        .tab-content {
            display: none;
            padding: 0;
        }
        
        .tab-content.active {
            display: block;
        }
        
        .table-container {
            overflow-x: auto;
            max-height: 600px;
            overflow-y: auto;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
            font-size: 13px;
        }
        
        th {
            background: linear-gradient(135deg, #34495e 0%, #2c3e50 100%);
            color: white;
            padding: 12px 6px;
            text-align: center;
            font-weight: bold;
            position: sticky;
            top: 0;
            z-index: 10;
            border-right: 1px solid #2c3e50;
            font-size: 12px;
            cursor: pointer;
            user-select: none;
            transition: background-color 0.2s ease;
        }
        
        th:hover {
            background: linear-gradient(135deg, #3498db 0%, #2980b9 100%);
        }
        
        th.sortable::after {
            content: ' â†•ï¸';
            font-size: 12px;
            margin-left: 5px;
        }
        
        th.sort-asc::after {
            content: ' â†‘';
            color: #e74c3c;
            font-weight: bold;
        }
        
        th.sort-desc::after {
            content: ' â†“';
            color: #e74c3c;
            font-weight: bold;
        }
        
        td {
            padding: 10px 6px;
            text-align: center;
            border-bottom: 1px solid #ecf0f1;
            border-right: 1px solid #ecf0f1;
            font-size: 14px;
        }
        
        tr:nth-child(even) {
            background-color: #f8f9fa;
        }
        
        tr:hover {
            background-color: #e3f2fd;
            transition: all 0.2s ease;
        }
        
        .rank-1, .rank-2, .rank-3 { font-weight: bold; }
        
        .group-a { border-left: 4px solid #2196F3; }
        .group-b { border-left: 4px solid #FF9800; }
        .group-c { border-left: 4px solid #9C27B0; }
        
        .score-excellent { color: #27ae60; font-weight: bold; }
        .score-good { color: #f39c12; font-weight: bold; }
        .score-poor { color: #e74c3c; }
        
        .performance-status {
            font-weight: bold;
            padding: 2px 4px;
            border-radius: 3px;
            font-size: 0.9em;
            background: #f8d7da;
            color: #721c24;
        }
        
        .store-name {
            font-weight: bold;
            color: #2c3e50;
            text-align: center;
            max-width: 140px;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }
        
        .group-badge {
            display: inline-block;
            padding: 3px 6px;
            border-radius: 12px;
            font-size: 12px;
            font-weight: bold;
            color: white;
            margin-left: 3px;
        }
        
        .badge-a { background: #2196F3; }
        .badge-b { background: #FF9800; }
        .badge-c { background: #9C27B0; }
        
        .region-badge {
            display: inline-block;
            padding: 2px 5px;
            border-radius: 8px;
            font-size: 12px;
            font-weight: bold;
            color: white;
            margin-left: 2px;
        }
        
        .region-æ–°å‰µ { background: #e74c3c; }
        .region-ç‡Ÿä¸€ { background: #9b59b6; }
        .region-ç‡ŸäºŒ { background: #3498db; }
        .region-ç‡Ÿä¸‰ { background: #1abc9c; }
        .region-åŒ—å€ { background: #f39c12; }
        .region-ä¸­å€ { background: #27ae60; }
        .region-å—å€ { background: #e67e22; }
        
        .number-cell {
            font-family: 'Courier New', monospace;
            font-weight: bold;
        }
        
        .qualified {
            background: #d4edda !important;
            color: #155724;
            font-weight: bold;
        }
        
        .threshold-info {
            font-size: 16px;
            color: #6c757d;
            margin-top: 10px;
            padding: 2px;
            background: #f8f9fa;
            border-radius: 5px;
        }
        
        .sort-info {
            font-size: 12px;
            color: #3498db;
            background: #ebf3fd;
            padding: 8px;
            border-radius: 5px;
            margin-bottom: 5px;
            text-align: center;
        }
        
        /* è‡ªæˆ‘å®£å‘Šé”æˆç‡æ¨£å¼ */
        .self-declared-rate {
            font-weight: bold;
            padding: 2px 4px;
            border-radius: 3px;
        }

        .performance-status {
            display: inline-block;
            padding: 2px 6px;
            border-radius: 3px;
            background-color: #fff3cd;
            color: #856404;
            font-size: 0.9em;
        }
        
        .rate-excellent { background: #d4edda; color: #155724; }
        .rate-good { background: #fff3cd; color: #856404; }
        .rate-poor { background: #f8d7da; color: #721c24; }
        
        /* ä¸­å’Œæ¯”ä¾‹æ¨£å¼ */
        .zhonghe-ratio {
            font-size: 13px;
            padding: 2px 4px;
            border-radius: 3px;
            font-weight: bold;
        }
        
        .ratio-high { background: #d4edda; color: #155724; }
        .ratio-medium { background: #fff3cd; color: #856404; }
        .ratio-low { background: #f8d7da; color: #721c24; }
        
        .ratio-high::after {
            content: ' âœ…';
            margin-left: 4px;
        }

        /* ç¸½è¨ˆåˆ—æ¨£å¼ */
        .total-row {
            background-color: #f8f9fa !important;
            font-weight: bold;
        }
        
        .total-row td {
            border-top: 2px solid #dee2e6;
        }

        /* çµ„åˆ¥çµ±è¨ˆä¿¡æ¯æ¨£å¼ */
        [id$="-stats"] {
            margin: 5px 0;
            font-size: 0.9em;
            color: #1976d2;
            background-color: #e3f2fd;
            padding: 3px 8px;
            border-radius: 4px;
            display: inline-block;
        }
        
        /* æ–°å¢é”æ¨™çµ±è¨ˆå€å¡Š */
        .achievement-stats {
            background: #fff3e0;
            padding: 15px;
            margin: 15px 20px;
            border-radius: 8px;
            border-left: 4px solid #ff9800;
        }
        
        .achievement-stats h4 {
            color: #e65100;
            margin-bottom: 10px;
            font-size: 14px;
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 10px;
        }
        
        .stat-item {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 12px;
        }
        
        .stat-icon {
            font-size: 16px;
        }
        .qualified::after {
            content: ' âœ…';
            margin-left: 4px;
        }

        @media (max-width: 768px) {
            .header h1 { font-size: 1.8em; }
            table { font-size: 11px; }
            th, td { padding: 6px 3px; }
            .store-name { max-width: 100px; }
            .group-tab { padding: 10px 15px; font-size: 0.9em; }
            .main-nav { flex-direction: column; }
            .group-tabs { flex-wrap: wrap; }
        }

    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸ† 0901-0907æ¨™ç±¤ç«¶è³½æˆ°å ±</h1>
        </div>
        
        <!-- æ•¸æ“šæ›´æ–°æ™‚é–“ -->
        <div class="update-time">
            <span class="calendar-icon">ğŸ“…</span>
            æ•¸æ“šæ›´æ–°æ™‚é–“ï¼š2024å¹´9æœˆ8æ—¥
        </div>
        
        <!-- ä¸»å°èˆª - é‡‘é¡ç©åˆ† vs å®¢æˆ¶æ•¸ç©åˆ† -->
        <div class="main-nav">
            <button class="main-nav-item active" onclick="switchMainTab('amount')">
                é‡‘é¡ç©åˆ†è³½
            </button>
            <button class="main-nav-item" onclick="switchMainTab('customer')">
                å®¢æˆ¶æ•¸ç©åˆ†è³½
            </button>
            <button class="main-nav-item" onclick="switchMainTab('region')">
                å€åŸŸåˆ†æ
            </button>
        </div>
        
        <!-- å­å°èˆª - çµ„åˆ¥é¸æ“‡ -->
        <div class="sub-nav">
            <div class="group-tabs">
                <!-- é‡‘é¡ç©åˆ†æ™‚é¡¯ç¤ºçš„æ¨™ç±¤ -->
                <div id="amount-tabs" class="tab-group active">
                    <button class="group-tab active" onclick="switchGroupTab('group-a')">â­ Açµ„-æ–°æ˜ŸæŒ‘æˆ°çµ„(14å®¶) | æœ¬æœŸé‡‘é¡ç©åˆ†ç¸½åˆï¼š<span id="group-a-amount">è¼‰å…¥ä¸­...</span></button>
                    <button class="group-tab" onclick="switchGroupTab('group-b')">ğŸš€ Bçµ„-é£›è€€æˆé•·çµ„(15å®¶) | æœ¬æœŸé‡‘é¡ç©åˆ†ç¸½åˆï¼š<span id="group-b-amount">è¼‰å…¥ä¸­...</span></button>
                    <button class="group-tab" onclick="switchGroupTab('group-c')">ğŸ‘‘ Cçµ„-ç¶“å…¸èè‹±çµ„(15å®¶) | æœ¬æœŸé‡‘é¡ç©åˆ†ç¸½åˆï¼š<span id="group-c-amount">è¼‰å…¥ä¸­...</span></button>
                </div>
                
                <!-- å®¢æˆ¶æ•¸ç©åˆ†æ™‚é¡¯ç¤ºçš„æ¨™ç±¤ -->
                <div id="customer-tabs" class="tab-group">
                    <button class="group-tab active" onclick="switchGroupTab('customer-ab')">â­ğŸš€ A+Bçµ„åˆä½µåˆ†è³½</button>
                    <button class="group-tab" onclick="switchGroupTab('customer-c')">ğŸ‘‘ Cçµ„åˆ†è³½</button>
                </div>
                <!-- å€åŸŸåˆ†ææ™‚é¡¯ç¤ºçš„æ¨™ç±¤ -->
                <div id="region-tabs" class="tab-group">
                    <button class="group-tab active" onclick="switchGroupTab('region-ç‡Ÿä¸€')">ğŸ¢ ç‡Ÿä¸€</button>
                    <button class="group-tab" onclick="switchGroupTab('region-ç‡ŸäºŒ')">ğŸ¢ ç‡ŸäºŒ</button>
                    <button class="group-tab" onclick="switchGroupTab('region-ç‡Ÿä¸‰')">ğŸ¢ ç‡Ÿä¸‰</button>
                    <button class="group-tab" onclick="switchGroupTab('region-åŒ—å€')">ğŸŒ åŒ—å€</button>
                    <button class="group-tab" onclick="switchGroupTab('region-ä¸­å€')">ğŸŒ ä¸­å€</button>
                    <button class="group-tab" onclick="switchGroupTab('region-å—å€')">ğŸŒ å—å€</button>
                    <button class="group-tab" onclick="switchGroupTab('region-æ–°å‰µ')">ğŸš€ æ–°å‰µ</button>
                </div>
            </div>
        </div>
        
        <!-- é‡‘é¡ç©åˆ†å…§å®¹å€ -->
        <div id="amount-content" class="tab-content active">
            <!-- Açµ„åˆ†é  -->
            <div id="group-a" class="tab-content active">
                
                <div class="threshold-info">
                    <div>æ¥­ç¸¾ç©åˆ†é–€æª» 25,000åˆ† | å®¢æˆ¶æ•¸ç©åˆ†é–€æª» 60åˆ†</div>
                </div>
                <div class="sort-info" id="sort-info-group-a">ç›®å‰æ’åºï¼šä¾å¹³å‡ç©åˆ†æ’å</div>
                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th class="sortable" data-field="é‡‘é¡æ’å">å¹³å‡ç©åˆ†æ’å</th>
                                <th class="sortable" data-field="storeName">é–€å¸‚åç¨±</th>
                                <th class="sortable" data-field="region">å€åŸŸ</th>
                                <th class="sortable" data-field="augustScore">8æœˆé‡‘é¡ç©åˆ†</th>
                                <th class="sortable" data-field="amountScore">9æœˆé‡‘é¡ç©åˆ†</th>
                                <th class="sortable" data-field="avgScore">å¹³å‡ç©åˆ†</th>
                                <th class="sortable" data-field="è‡ªæˆ‘å®£å‘Šç›®æ¨™">è‡ªæˆ‘å®£å‘Šç›®æ¨™</th>
                                <th class="sortable" data-field="è‡ªæˆ‘å®£å‘Šé”æˆç‡">è‡ªæˆ‘å®£å‘Šé”æˆç‡</th>
                                <th class="sortable" data-field="æ–°å®¢æ¥­ç¸¾">æ–°å®¢æ¥­ç¸¾</th>
                                <th class="sortable" data-field="èˆŠå®¢æ¥­ç¸¾">èˆŠå®¢æ¥­ç¸¾</th>
                                <th class="sortable" data-field="ä¸­å’Œæ¯”ä¾‹">ä¸­å’Œç™¼åŒ…æ¯”ä¾‹</th>
                            </tr>
                        </thead>
                        <tbody id="group-a-table">
                        </tbody>
                    </table>
                </div>
            </div>
            
            <!-- Bçµ„åˆ†é  -->
            <div id="group-b" class="tab-content">
            
                <div class="threshold-info">
                    <div>æ¥­ç¸¾ç©åˆ†é–€æª» 35,000åˆ† | å®¢æˆ¶æ•¸ç©åˆ†é–€æª» 60åˆ†</div>
                </div>
                <div class="sort-info" id="sort-info-group-b">ç›®å‰æ’åºï¼šä¾å¹³å‡ç©åˆ†æ’å</div>
                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th class="sortable" data-field="é‡‘é¡æ’å">å¹³å‡ç©åˆ†æ’å</th>
                                <th class="sortable" data-field="storeName">é–€å¸‚åç¨±</th>
                                <th class="sortable" data-field="region">å€åŸŸ</th>
                                <th class="sortable" data-field="augustScore">8æœˆé‡‘é¡ç©åˆ†</th>
                                <th class="sortable" data-field="amountScore">9æœˆé‡‘é¡ç©åˆ†</th>
                                <th class="sortable" data-field="avgScore">å¹³å‡ç©åˆ†</th>
                                <th class="sortable" data-field="è‡ªæˆ‘å®£å‘Šç›®æ¨™">è‡ªæˆ‘å®£å‘Šç›®æ¨™</th>
                                <th class="sortable" data-field="è‡ªæˆ‘å®£å‘Šé”æˆç‡">è‡ªæˆ‘å®£å‘Šé”æˆç‡</th>
                                <th class="sortable" data-field="æ–°å®¢æ¥­ç¸¾">æ–°å®¢æ¥­ç¸¾</th>
                                <th class="sortable" data-field="èˆŠå®¢æ¥­ç¸¾">èˆŠå®¢æ¥­ç¸¾</th>
                                <th class="sortable" data-field="ä¸­å’Œæ¯”ä¾‹">ä¸­å’Œç™¼åŒ…æ¯”ä¾‹</th>
                                
                            </tr>
                        </thead>
                        <tbody id="group-b-table">
                        </tbody>
                    </table>
                </div>
            </div>
            
            <div id="group-c" class="tab-content">
                
                <div class="threshold-info">
                    <div>æ¥­ç¸¾ç©åˆ†é–€æª» 45,000åˆ† | å®¢æˆ¶æ•¸ç©åˆ†é–€æª» 30åˆ†</div>
                </div>
                <div class="sort-info" id="sort-info-group-c">ç›®å‰æ’åºï¼šä¾å¹³å‡ç©åˆ†æ’å</div>
                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th class="sortable" data-field="é‡‘é¡æ’å">å¹³å‡ç©åˆ†æ’å</th>
                                <th class="sortable" data-field="storeName">é–€å¸‚åç¨±</th>
                                <th class="sortable" data-field="region">å€åŸŸ</th>
                                <th class="sortable" data-field="augustScore">8æœˆé‡‘é¡ç©åˆ†</th>
                                <th class="sortable" data-field="amountScore">9æœˆé‡‘é¡ç©åˆ†</th>
                                <th class="sortable" data-field="avgScore">å¹³å‡ç©åˆ†</th>
                                <th class="sortable" data-field="è‡ªæˆ‘å®£å‘Šç›®æ¨™">è‡ªæˆ‘å®£å‘Šç›®æ¨™</th>
                                <th class="sortable" data-field="è‡ªæˆ‘å®£å‘Šé”æˆç‡">è‡ªæˆ‘å®£å‘Šé”æˆç‡</th>
                                <th class="sortable" data-field="æ–°å®¢æ¥­ç¸¾">æ–°å®¢æ¥­ç¸¾</th>
                                <th class="sortable" data-field="èˆŠå®¢æ¥­ç¸¾">èˆŠå®¢æ¥­ç¸¾</th>
                                <th class="sortable" data-field="ä¸­å’Œæ¯”ä¾‹">ä¸­å’Œç™¼åŒ…æ¯”ä¾‹</th>
                                
                            </tr>
                        </thead>
                        <tbody id="group-c-table">
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
        
        <!-- å®¢æˆ¶æ•¸ç©åˆ†å…§å®¹å€ -->
        <div id="customer-content" class="tab-content">
            <div class="threshold-info">
                <strong>ğŸ‘¥ å®¢æˆ¶æ•¸ç©åˆ†ç«¶è³½ï¼š</strong> A+Bçµ„åˆä½µç«¶è³½(å®¢æˆ¶æ•¸ç©åˆ†é–€æª»ï¼š60åˆ†) | Cçµ„ç¨ç«‹ç«¶è³½(å®¢æˆ¶æ•¸ç©åˆ†é–€æª»ï¼š30åˆ†)<br>
                <strong>ğŸ“Š ç©åˆ†è¨ˆç®—ï¼š</strong> å®¢æˆ¶ç©åˆ† = èˆŠå®¢æ•¸Ã—1 + æ–°å®¢æ•¸Ã—3
            </div>
            
            <!-- A+Bçµ„åˆä½µåˆ†è³½ -->
            <div id="customer-ab" class="tab-content active">
                <div class="sort-info">ç›®å‰æ’åºï¼šä¾å®¢æˆ¶æ•¸æ’å (å›ºå®š)</div>
                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th class="sortable" data-field="å®¢æˆ¶æ•¸æ’å">å®¢æˆ¶æ•¸æ’å</th>
                                <th class="sortable" data-field="storeName">é–€å¸‚åç¨±</th>
                                <th class="sortable" data-field="group">çµ„åˆ¥</th>
                                <th class="sortable" data-field="region">å€åŸŸ</th>
                                <th class="sortable" data-field="customerScore">å®¢æˆ¶æ•¸ç©åˆ†</th>
                                <th class="sortable" data-field="æ–°å®¢æ•¸">æ–°å®¢æ•¸</th>
                                <th class="sortable" data-field="èˆŠå®¢æ•¸">èˆŠå®¢æ•¸</th>
                                <th class="sortable" data-field="ä¸­å’Œæ¯”ä¾‹">ä¸­å’Œç™¼åŒ…æ¯”ä¾‹</th> 
                            </tr>
                        </thead>
                        <tbody id="customer-ab-table">
                        </tbody>
                    </table>
                </div>
            </div>
            
            <!-- Cçµ„ç¨ç«‹åˆ†è³½ -->
            <div id="customer-c" class="tab-content">
                <div class="sort-info">ç›®å‰æ’åºï¼šä¾å®¢æˆ¶æ•¸æ’å (å›ºå®š)</div>
                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th class="sortable" data-field="å®¢æˆ¶æ•¸æ’å">å®¢æˆ¶æ•¸æ’å</th>
                                <th class="sortable" data-field="storeName">é–€å¸‚åç¨±</th>
                                <th class="sortable" data-field="group">çµ„åˆ¥</th>
                                <th class="sortable" data-field="region">å€åŸŸ</th>
                                <th class="sortable" data-field="customerScore">å®¢æˆ¶æ•¸ç©åˆ†</th>
                                <th class="sortable" data-field="æ–°å®¢æ•¸">æ–°å®¢æ•¸</th>
                                <th class="sortable" data-field="èˆŠå®¢æ•¸">èˆŠå®¢æ•¸</th>
                                <th class="sortable" data-field="ä¸­å’Œæ¯”ä¾‹">ä¸­å’Œç™¼åŒ…æ¯”ä¾‹</th> 
                            </tr>
                        </thead>
                        <tbody id="customer-c-table">
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
        <!-- å€åŸŸåˆ†æå…§å®¹å€ -->
        <div id="region-content" class="tab-content">
            <div class="threshold-info">
                <div class="statistics-info">
                    <span class="total-amount">é–€å¸‚ç›®å‰åŠ ç¸½ç™¼å°æˆæœ¬ï¼š<span id="total-amount"></span></span> | 
                    <span class="baseline">2025ä¸ŠåŠå¹´æœˆå‡ç™¼å°æˆæœ¬ï¼š300,909</span> | 
                    <span class="growth-rate">æˆé•·ç‡ï¼š<span id="growth-rate"></span></span>
                </div>
            </div>
            
            <!-- ç‡Ÿä¸€ -->
            <div id="region-ç‡Ÿä¸€" class="tab-content active">
                <div class="sort-info" id="sort-info-region-ç‡Ÿä¸€">ç›®å‰æ’åºï¼šä¾é‡‘é¡æ’å (å›ºå®š)</div>
                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th class="sortable" data-field="é‡‘é¡æ’å">é‡‘é¡æ’å</th>
                                <th class="sortable" data-field="storeName">é–€å¸‚åç¨±</th>
                                <th class="sortable" data-field="group">çµ„åˆ¥</th>
                                <th class="sortable" data-field="amountScore">é‡‘é¡ç©åˆ†</th>
                                <th class="sortable" data-field="customerScore">å®¢æˆ¶æ•¸ç©åˆ†</th>
                                <th class="sortable" data-field="è‡ªæˆ‘å®£å‘Šç›®æ¨™">è‡ªæˆ‘å®£å‘Šç›®æ¨™</th>
                                <th class="sortable" data-field="è‡ªæˆ‘å®£å‘Šé”æˆç‡">è‡ªæˆ‘å®£å‘Šé”æˆç‡</th>
                                <th class="sortable" data-field="åŸå§‹æ¥­ç¸¾">åŸå§‹æ¥­ç¸¾</th>
                                <th class="sortable" data-field="æ–°å®¢æ¥­ç¸¾">æ–°å®¢æ¥­ç¸¾</th>
                                <th class="sortable" data-field="èˆŠå®¢æ¥­ç¸¾">èˆŠå®¢æ¥­ç¸¾</th>                                   
                                <th class="sortable" data-field="æ–°å®¢æ•¸">æ–°å®¢æ•¸</th>
                                <th class="sortable" data-field="èˆŠå®¢æ•¸">èˆŠå®¢æ•¸</th>
                                <th class="sortable" data-field="ä¸­å’Œæ¯”ä¾‹">ä¸­å’Œç™¼åŒ…æ¯”ç‡</th>
                            </tr>
                        </thead>
                        <tbody id="region-ç‡Ÿä¸€-table">
                        </tbody>
                    </table>
                </div>
            </div>
            
            <!-- ç‡ŸäºŒ -->
            <div id="region-ç‡ŸäºŒ" class="tab-content">
                <div class="sort-info" id="sort-info-region-ç‡ŸäºŒ">ç›®å‰æ’åºï¼šä¾é‡‘é¡æ’å (å›ºå®š)</div>
                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th class="sortable" data-field="é‡‘é¡æ’å">é‡‘é¡æ’å</th>
                                <th class="sortable" data-field="storeName">é–€å¸‚åç¨±</th>
                                <th class="sortable" data-field="group">çµ„åˆ¥</th>
                                <th class="sortable" data-field="amountScore">é‡‘é¡ç©åˆ†</th>
                                <th class="sortable" data-field="customerScore">å®¢æˆ¶æ•¸ç©åˆ†</th>
                                <th class="sortable" data-field="è‡ªæˆ‘å®£å‘Šç›®æ¨™">è‡ªæˆ‘å®£å‘Šç›®æ¨™</th>
                                <th class="sortable" data-field="è‡ªæˆ‘å®£å‘Šé”æˆç‡">è‡ªæˆ‘å®£å‘Šé”æˆç‡</th>
                                <th class="sortable" data-field="åŸå§‹æ¥­ç¸¾">åŸå§‹æ¥­ç¸¾</th>
                                <th class="sortable" data-field="æ–°å®¢æ¥­ç¸¾">æ–°å®¢æ¥­ç¸¾</th>
                                <th class="sortable" data-field="èˆŠå®¢æ¥­ç¸¾">èˆŠå®¢æ¥­ç¸¾</th>
                                <th class="sortable" data-field="æ–°å®¢æ•¸">æ–°å®¢æ•¸</th>
                                <th class="sortable" data-field="èˆŠå®¢æ•¸">èˆŠå®¢æ•¸</th>
                                <th class="sortable" data-field="ä¸­å’Œæ¯”ä¾‹">ä¸­å’Œç™¼åŒ…æ¯”ç‡</th>
                            </tr>
                        </thead>
                        <tbody id="region-ç‡ŸäºŒ-table">
                        </tbody>
                    </table>
                </div>
            </div>
            
            <!-- ç‡Ÿä¸‰ -->
            <div id="region-ç‡Ÿä¸‰" class="tab-content">
                <div class="sort-info" id="sort-info-region-ç‡Ÿä¸‰">ç›®å‰æ’åºï¼šä¾é‡‘é¡æ’å (å›ºå®š)</div>
                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th class="sortable" data-field="é‡‘é¡æ’å">é‡‘é¡æ’å</th>
                                <th class="sortable" data-field="storeName">é–€å¸‚åç¨±</th>
                                <th class="sortable" data-field="group">çµ„åˆ¥</th>
                                <th class="sortable" data-field="amountScore">é‡‘é¡ç©åˆ†</th>
                                <th class="sortable" data-field="customerScore">å®¢æˆ¶æ•¸ç©åˆ†</th>
                                <th class="sortable" data-field="è‡ªæˆ‘å®£å‘Šç›®æ¨™">è‡ªæˆ‘å®£å‘Šç›®æ¨™</th>
                                <th class="sortable" data-field="è‡ªæˆ‘å®£å‘Šé”æˆç‡">è‡ªæˆ‘å®£å‘Šé”æˆç‡</th>
                                <th class="sortable" data-field="åŸå§‹æ¥­ç¸¾">åŸå§‹æ¥­ç¸¾</th>
                                <th class="sortable" data-field="æ–°å®¢æ¥­ç¸¾">æ–°å®¢æ¥­ç¸¾</th>
                                <th class="sortable" data-field="èˆŠå®¢æ¥­ç¸¾">èˆŠå®¢æ¥­ç¸¾</th>
                                <th class="sortable" data-field="æ–°å®¢æ•¸">æ–°å®¢æ•¸</th>
                                <th class="sortable" data-field="èˆŠå®¢æ•¸">èˆŠå®¢æ•¸</th>
                                <th class="sortable" data-field="ä¸­å’Œæ¯”ä¾‹">ä¸­å’Œç™¼åŒ…æ¯”ç‡</th>
                            </tr>
                        </thead>
                        <tbody id="region-ç‡Ÿä¸‰-table">
                        </tbody>
                    </table>
                </div>
            </div>
            
            <!-- åŒ—å€ -->
            <div id="region-åŒ—å€" class="tab-content">
                <div class="sort-info" id="sort-info-region-åŒ—å€">ç›®å‰æ’åºï¼šä¾é‡‘é¡æ’å (å›ºå®š)</div>
                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th class="sortable" data-field="é‡‘é¡æ’å">é‡‘é¡æ’å</th>
                                <th class="sortable" data-field="storeName">é–€å¸‚åç¨±</th>
                                <th class="sortable" data-field="group">çµ„åˆ¥</th>
                                <th class="sortable" data-field="amountScore">é‡‘é¡ç©åˆ†</th>
                                <th class="sortable" data-field="customerScore">å®¢æˆ¶æ•¸ç©åˆ†</th>
                                <th class="sortable" data-field="è‡ªæˆ‘å®£å‘Šç›®æ¨™">è‡ªæˆ‘å®£å‘Šç›®æ¨™</th>
                                <th class="sortable" data-field="è‡ªæˆ‘å®£å‘Šé”æˆç‡">è‡ªæˆ‘å®£å‘Šé”æˆç‡</th>
                                <th class="sortable" data-field="åŸå§‹æ¥­ç¸¾">åŸå§‹æ¥­ç¸¾</th>
                                <th class="sortable" data-field="æ–°å®¢æ¥­ç¸¾">æ–°å®¢æ¥­ç¸¾</th>
                                <th class="sortable" data-field="èˆŠå®¢æ¥­ç¸¾">èˆŠå®¢æ¥­ç¸¾</th>
                                <th class="sortable" data-field="æ–°å®¢æ•¸">æ–°å®¢æ•¸</th>
                                <th class="sortable" data-field="èˆŠå®¢æ•¸">èˆŠå®¢æ•¸</th>
                                <th class="sortable" data-field="ä¸­å’Œæ¯”ä¾‹">ä¸­å’Œç™¼åŒ…æ¯”ç‡</th>
                            </tr>
                        </thead>
                        <tbody id="region-åŒ—å€-table">
                        </tbody>
                    </table>
                </div>
            </div>
            
            <!-- ä¸­å€ -->
            <div id="region-ä¸­å€" class="tab-content">
                <div class="sort-info" id="sort-info-region-ä¸­å€">ç›®å‰æ’åºï¼šä¾é‡‘é¡æ’å (å›ºå®š)</div>
                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th class="sortable" data-field="é‡‘é¡æ’å">é‡‘é¡æ’å</th>
                                <th class="sortable" data-field="storeName">é–€å¸‚åç¨±</th>
                                <th class="sortable" data-field="group">çµ„åˆ¥</th>
                                <th class="sortable" data-field="amountScore">é‡‘é¡ç©åˆ†</th>
                                <th class="sortable" data-field="customerScore">å®¢æˆ¶æ•¸ç©åˆ†</th>
                                <th class="sortable" data-field="è‡ªæˆ‘å®£å‘Šç›®æ¨™">è‡ªæˆ‘å®£å‘Šç›®æ¨™</th>
                                <th class="sortable" data-field="è‡ªæˆ‘å®£å‘Šé”æˆç‡">è‡ªæˆ‘å®£å‘Šé”æˆç‡</th>
                                <th class="sortable" data-field="åŸå§‹æ¥­ç¸¾">åŸå§‹æ¥­ç¸¾</th>
                                <th class="sortable" data-field="æ–°å®¢æ¥­ç¸¾">æ–°å®¢æ¥­ç¸¾</th>
                                <th class="sortable" data-field="èˆŠå®¢æ¥­ç¸¾">èˆŠå®¢æ¥­ç¸¾</th>
                                <th class="sortable" data-field="æ–°å®¢æ•¸">æ–°å®¢æ•¸</th>
                                <th class="sortable" data-field="èˆŠå®¢æ•¸">èˆŠå®¢æ•¸</th>
                                <th class="sortable" data-field="ä¸­å’Œæ¯”ä¾‹">ä¸­å’Œç™¼åŒ…æ¯”ç‡</th>
                            </tr>
                        </thead>
                        <tbody id="region-ä¸­å€-table">
                        </tbody>
                    </table>
                </div>
            </div>
            
            <!-- å—å€ -->
            <div id="region-å—å€" class="tab-content">
                <div class="sort-info" id="sort-info-region-å—å€">ç›®å‰æ’åºï¼šä¾é‡‘é¡æ’å (å›ºå®š)</div>
                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th class="sortable" data-field="é‡‘é¡æ’å">é‡‘é¡æ’å</th>
                                <th class="sortable" data-field="storeName">é–€å¸‚åç¨±</th>
                                <th class="sortable" data-field="group">çµ„åˆ¥</th>
                                <th class="sortable" data-field="amountScore">é‡‘é¡ç©åˆ†</th>
                                <th class="sortable" data-field="customerScore">å®¢æˆ¶æ•¸ç©åˆ†</th>
                                <th class="sortable" data-field="è‡ªæˆ‘å®£å‘Šç›®æ¨™">è‡ªæˆ‘å®£å‘Šç›®æ¨™</th>
                                <th class="sortable" data-field="è‡ªæˆ‘å®£å‘Šé”æˆç‡">è‡ªæˆ‘å®£å‘Šé”æˆç‡</th>
                                <th class="sortable" data-field="åŸå§‹æ¥­ç¸¾">åŸå§‹æ¥­ç¸¾</th>
                                <th class="sortable" data-field="æ–°å®¢æ¥­ç¸¾">æ–°å®¢æ¥­ç¸¾</th>
                                <th class="sortable" data-field="èˆŠå®¢æ¥­ç¸¾">èˆŠå®¢æ¥­ç¸¾</th>
                                <th class="sortable" data-field="æ–°å®¢æ•¸">æ–°å®¢æ•¸</th>
                                <th class="sortable" data-field="èˆŠå®¢æ•¸">èˆŠå®¢æ•¸</th>
                                <th class="sortable" data-field="ä¸­å’Œæ¯”ä¾‹">ä¸­å’Œç™¼åŒ…æ¯”ç‡</th>
                            </tr>
                        </thead>
                        <tbody id="region-å—å€-table">
                        </tbody>
                    </table>
                </div>
            </div>
            
            <!-- æ–°å‰µ -->
            <div id="region-æ–°å‰µ" class="tab-content">
                <div class="sort-info" id="sort-info-region-æ–°å‰µ">ç›®å‰æ’åºï¼šä¾é‡‘é¡æ’å (å›ºå®š)</div>
                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th class="sortable" data-field="é‡‘é¡æ’å">é‡‘é¡æ’å</th>
                                <th class="sortable" data-field="storeName">é–€å¸‚åç¨±</th>
                                <th class="sortable" data-field="group">çµ„åˆ¥</th>
                                <th class="sortable" data-field="amountScore">é‡‘é¡ç©åˆ†</th>
                                <th class="sortable" data-field="customerScore">å®¢æˆ¶æ•¸ç©åˆ†</th>
                                <th class="sortable" data-field="è‡ªæˆ‘å®£å‘Šç›®æ¨™">è‡ªæˆ‘å®£å‘Šç›®æ¨™</th>
                                <th class="sortable" data-field="è‡ªæˆ‘å®£å‘Šé”æˆç‡">è‡ªæˆ‘å®£å‘Šé”æˆç‡</th>
                                <th class="sortable" data-field="åŸå§‹æ¥­ç¸¾">åŸå§‹æ¥­ç¸¾</th>
                                <th class="sortable" data-field="æ–°å®¢æ¥­ç¸¾">æ–°å®¢æ¥­ç¸¾</th>
                                <th class="sortable" data-field="èˆŠå®¢æ¥­ç¸¾">èˆŠå®¢æ¥­ç¸¾</th>
                                <th class="sortable" data-field="æ–°å®¢æ•¸">æ–°å®¢æ•¸</th>
                                <th class="sortable" data-field="èˆŠå®¢æ•¸">èˆŠå®¢æ•¸</th>
                                <th class="sortable" data-field="ä¸­å’Œæ¯”ä¾‹">ä¸­å’Œç™¼åŒ…æ¯”ç‡</th>
                            </tr>
                        </thead>
                        <tbody id="region-æ–°å‰µ-table">
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
    
    <!-- å¼•å…¥å¤–éƒ¨æ•¸æ“šæ–‡ä»¶ -->
    <script>
        // ç•¶è…³æœ¬è¼‰å…¥å®Œæˆæ™‚çš„è™•ç†å‡½æ•¸
        function onScriptsLoaded() {
            if (typeof competitionData !== 'undefined' && typeof augustCompetitionData !== 'undefined') {
                initializePage();
            }
        }

        // åˆå§‹åŒ–é é¢
        function initializePage() {
            currentMainTab = 'amount';
            switchMainTab('amount');
        }
    </script>
    <script src="competition-data.js" onload="onScriptsLoaded()"></script>
    <script src="competition-data-aug.js" onload="onScriptsLoaded()"></script>
    
    <script>
        // ç•¶å‰æ´»å‹•åˆ†é 
        let currentMainTab = 'amount';
        let currentGroupTab = 'group-a';
        let currentSort = { field: null, direction: 'asc' };

        function getRankMedal(rank) {
            switch(rank) {
                case 1: return 'ğŸ¥‡';
                case 2: return 'ğŸ¥ˆ';
                case 3: return 'ğŸ¥‰';
                default: return rank;
            }
        }

        function getGroupBadge(group) {
            const badges = {
                'A': '<span class="group-badge badge-a">â­æ–°æ˜Ÿ</span>',
                'B': '<span class="group-badge badge-b">ğŸš€é£›è€€</span>',
                'C': '<span class="group-badge badge-c">ğŸ‘‘èè‹±</span>'
            };
            return badges[group] || '';
        }

        function getRegionBadge(region) {
            return `<span class="region-badge region-${region}">${region}</span>`;
        }

        function getZhongheRatioClass(ratio) {
            const numRatio = parseFloat(ratio.replace('%', ''));
            if (numRatio >= 80) return 'ratio-high';
            if (numRatio >= 50) return 'ratio-medium';
            return 'ratio-low';
        }

        function getSelfDeclaredRateClass(rate) {
            const numRate = parseFloat(rate.replace('%', ''));
            if (numRate >= 80) return 'rate-excellent';
            if (numRate >= 50) return 'rate-good';
            return 'rate-poor';
        }

        function formatNumber(num) {
            return num.toLocaleString();
        }

        // æ ¹æ“šçµ„åˆ¥åˆ¤å®šæ¥­ç¸¾ç©åˆ†æ˜¯å¦é”æ¨™ï¼šA>=25000, B>=35000, C>=45000
        function isAmountQualifiedForStore(store) {
            const group = (store.group || '').toString().toUpperCase();
            const thresholds = { 'A': 25000, 'B': 35000, 'C': 45000 };
            const threshold = thresholds[group] || 0;
            const score = Number(store.amountScore) || 0;
            return score >= threshold;
        }

        // åˆ¤å®šä»»æ„ score æ˜¯å¦é”åˆ°è©²åº—çµ„åˆ¥é–€æª»
        function isScoreQualifiedForStore(store, score) {
            const group = (store.group || '').toString().toUpperCase();
            const thresholds = { 'A': 25000, 'B': 35000, 'C': 45000 };
            const threshold = thresholds[group] || 0;
            const s = Number(score) || 0;
            return s >= threshold;
        }

        // è¨ˆç®—æ¯å®¶é–€å¸‚çš„å¹³å‡ç©åˆ†ä¸¦å›å‚³æ¨™æº–ç«¶è³½æ’åï¼ˆåŒåˆ†åŒåæ¬¡ï¼Œä¸‹ä¸€åæ¬¡æ•¸é‡æ¸›å°‘ï¼‰
        // è¼¸å…¥ data ç‚ºè©²çµ„çš„ store é™£åˆ—ï¼Œå›å‚³ç‰©ä»¶ map: { storeName: rank }
        function computeAvgRankMap(data) {
            // å»ºç«‹åŒ…å« avg çš„æš«å­˜é™£åˆ—
            const arr = data.map(s => {
                const aug = getAugustScore(s.storeName);
                const sept = s.amountScore || 0;
                const avg = (typeof aug === 'number') ? Math.round((aug + sept) / 2) : sept;
                return { storeName: s.storeName, avg };
            });

            // ä¾ avg é™åºæ’åˆ—ï¼ˆåˆ†æ•¸å¤§æ’å‰ï¼‰
            arr.sort((a, b) => b.avg - a.avg);

            const rankMap = {};
            for (let i = 0; i < arr.length; i++) {
                if (i > 0 && arr[i].avg === arr[i - 1].avg) {
                    // åŒåˆ†åŒåæ¬¡
                    rankMap[arr[i].storeName] = rankMap[arr[i - 1].storeName];
                } else {
                    // æ¨™æº–ç«¶è³½æ’åï¼šæ’åç‚ºç´¢å¼•+1ï¼ˆå› æ­¤ä¸Šæ–¹ä¸‰äººåŒåˆ—1ï¼Œä¸‹ä¸€åç‚º4ï¼‰
                    rankMap[arr[i].storeName] = i + 1;
                }
            }
            return rankMap;
        }

        function switchMainTab(tab) {
            currentMainTab = tab;
            
            // æ›´æ–°ä¸»å°èˆªç‹€æ…‹
            document.querySelectorAll('.main-nav-item').forEach(item => {
                item.classList.remove('active');
            });
            event.target.classList.add('active');
            
            // åˆ‡æ›å…§å®¹å€åŸŸ
            document.querySelectorAll('#amount-content, #customer-content, #region-content').forEach(content => {
                content.classList.remove('active');
            });
            document.getElementById(tab + '-content').classList.add('active');
            
            // åˆ‡æ›å­å°èˆªæ¨™ç±¤çµ„
            document.querySelectorAll('.tab-group').forEach(group => {
                group.classList.remove('active');
            });
            document.getElementById(tab + '-tabs').classList.add('active');
            
            // é‡ç½®å­å°èˆªç‹€æ…‹
            if (tab === 'amount') {
                currentGroupTab = 'group-a';
                document.querySelectorAll('#amount-tabs .group-tab').forEach(groupTab => {
                    groupTab.classList.remove('active');
                });
                document.querySelector('#amount-tabs .group-tab[onclick*="group-a"]').classList.add('active');
                
                // é¡¯ç¤ºAçµ„å…§å®¹
                document.querySelectorAll('#amount-content .tab-content').forEach(content => {
                    content.classList.remove('active');
                });
                document.getElementById('group-a').classList.add('active');
            } else if (tab === 'customer') {
                currentGroupTab = 'customer-ab';
                document.querySelectorAll('#customer-tabs .group-tab').forEach(groupTab => {
                    groupTab.classList.remove('active');
                });
                document.querySelector('#customer-tabs .group-tab[onclick*="customer-ab"]').classList.add('active');
                
                // é¡¯ç¤ºA+Bçµ„å…§å®¹
                document.querySelectorAll('#customer-content .tab-content').forEach(content => {
                    content.classList.remove('active');
                });
                document.getElementById('customer-ab').classList.add('active');
            } else if (tab === 'region') {
                currentGroupTab = 'region-ç‡Ÿä¸€';
                document.querySelectorAll('#region-tabs .group-tab').forEach(groupTab => {
                    groupTab.classList.remove('active');
                });
                document.querySelector('#region-tabs .group-tab[onclick*="region-ç‡Ÿä¸€"]').classList.add('active');
                
                // é¡¯ç¤ºç‡Ÿä¸€å…§å®¹
                document.querySelectorAll('#region-content .tab-content').forEach(content => {
                    content.classList.remove('active');
                });
                document.getElementById('region-ç‡Ÿä¸€').classList.add('active');
                
            }
            
            // è¼‰å…¥å°æ‡‰æ•¸æ“š
            loadTabContent();
        }

        function switchGroupTab(tab) {
            currentGroupTab = tab;
            
            // æ›´æ–°ç•¶å‰æ´»å‹•æ¨™ç±¤çµ„å…§çš„æ¨™ç±¤ç‹€æ…‹
            const activeTabGroup = document.querySelector('.tab-group.active');
            if (activeTabGroup) {
                activeTabGroup.querySelectorAll('.group-tab').forEach(groupTab => {
                    groupTab.classList.remove('active');
                });
                event.target.classList.add('active');
            }
            
            // åœ¨å„æ¨¡å¼ä¸‹åˆ‡æ›å­å…§å®¹
            if (currentMainTab === 'amount') {
                document.querySelectorAll('#amount-content .tab-content').forEach(content => {
                    content.classList.remove('active');
                });
                document.getElementById(tab).classList.add('active');
            } else if (currentMainTab === 'customer') {
                document.querySelectorAll('#customer-content .tab-content').forEach(content => {
                    content.classList.remove('active');
                });
                document.getElementById(tab).classList.add('active');
            } else if (currentMainTab === 'region') {
                document.querySelectorAll('#region-content .tab-content').forEach(content => {
                    content.classList.remove('active');
                });
                document.getElementById(tab).classList.add('active');
            }
            
            // è¼‰å…¥å°æ‡‰æ•¸æ“š
            loadTabContent();
        }

        function loadTabContent() {
            // é‡ç½®æ’åºç‹€æ…‹
            currentSort = { field: null, direction: 'asc' };
            document.querySelectorAll('th.sortable').forEach(th => {
                th.classList.remove('sort-asc', 'sort-desc');
            });

            if (currentMainTab === 'amount') {
                if (currentGroupTab.startsWith('group-')) {
                    const group = currentGroupTab.replace('group-', '').toUpperCase();
                    populateGroupTable(group);
                }
            } else if (currentMainTab === 'customer') {
                if (currentGroupTab === 'customer-ab') {
                    populateCustomerABTable();
                } else if (currentGroupTab === 'customer-c') {
                    populateCustomerCTable();
                }
            } else if (currentMainTab === 'region') {
                if (currentGroupTab.startsWith('region-')) {
                    const region = currentGroupTab.replace('region-', '');
                    populateRegionTable(region);
                }
            }
        }

        function populateGroupTable(group) {
            const tbody = document.getElementById(`group-${group.toLowerCase()}-table`);
            if (!tbody) return;
            
            tbody.innerHTML = '';

            const groupData = competitionData.filter(store => store.group === group);
            // ä»¥å¹³å‡ç©åˆ†æ’åºï¼ˆé è¨­ï¼‰ä¸¦è¨ˆç®—æ’åæ˜ å°„
            const rankMap = computeAvgRankMap(groupData);
            groupData.sort((a, b) => {
                const aAvg = (typeof getAugustScore(a.storeName) === 'number') ? Math.round((getAugustScore(a.storeName) + (a.amountScore || 0)) / 2) : (a.amountScore || 0);
                const bAvg = (typeof getAugustScore(b.storeName) === 'number') ? Math.round((getAugustScore(b.storeName) + (b.amountScore || 0)) / 2) : (b.amountScore || 0);
                return bAvg - aAvg; // é«˜åˆ†åœ¨å‰
            });
            
            groupData.forEach((store) => {
                const isAmountQualified = isAmountQualifiedForStore(store);
                const hasNoPerformance = store.amountScore === 0;
                
                let rowClass = `group-${store.group.toLowerCase()}`;
                // é‡‘éŠ€éŠ…ç‰Œæ•ˆæœåªåœ¨é è¨­æ’åºä¸”å‰ä¸‰åæ™‚é¡¯ç¤º
                if ((currentSort.field === null || currentSort.field === 'é‡‘é¡æ’å') && store.é‡‘é¡æ’å <= 3 && !hasNoPerformance) {
                    rowClass += ` rank-${store.é‡‘é¡æ’å}`;
                }
                
                const row = document.createElement('tr');
                row.className = rowClass;
                
                // é¡¯ç¤ºä»¥å¹³å‡ç©åˆ†è¨ˆç®—çš„æ’åï¼ˆåŒåˆ†åŒåæ¬¡ï¼Œä¸‹ä¸€åæ¬¡æ•¸é‡æ¸›å°‘ï¼‰
                const avgRank = rankMap[store.storeName] || store.é‡‘é¡æ’å;
                const rankDisplay = ((currentSort.field === null || currentSort.field === 'é‡‘é¡æ’å') && avgRank <= 3 && !hasNoPerformance)
                    ? getRankMedal(avgRank)
                    : avgRank;
                
                // å–å¾—å…«æœˆä»½ç©åˆ†ï¼Œè¨ˆç®—å¹³å‡
                const augScore = getAugustScore(store.storeName);
                const augThreshold = store.amountThreshold || store.è‡ªæˆ‘å®£å‘Šç›®æ¨™ || 0;
                const isAugQualified = (typeof augScore === 'number' && augScore >= augThreshold);
                const augDisplay = (typeof augScore === 'number') ? formatNumber(augScore) : '-';

                const septScore = store.amountScore;
                const isSeptQualified = isAmountQualified;
                const septDisplay = hasNoPerformance ? '<span class="performance-status">å°šç„¡ç©åˆ†</span>' : formatNumber(septScore);

                const avgScore = (typeof augScore === 'number') ? Math.round(((augScore || 0) + (septScore || 0)) / 2) : septScore;
                const avgDisplay = typeof avgScore === 'number' ? formatNumber(avgScore) : '-';
                const isAvgQualified = isScoreQualifiedForStore(store, avgScore);

                row.innerHTML = `
                    <td class="number-cell">${rankDisplay}</td>
                    <td class="store-name">${store.storeName}</td>
                    <td>${getRegionBadge(store.region)}</td>
                    <td class="number-cell ${isAugQualified ? 'qualified' : ''}">${augDisplay}</td>
                    <td class="number-cell ${isSeptQualified ? 'qualified' : ''}">${septDisplay}</td>
                    <td class="number-cell ${isAvgQualified ? 'qualified' : ''}">${avgDisplay}</td>
                    <td class="number-cell">${formatNumber(store.è‡ªæˆ‘å®£å‘Šç›®æ¨™)}</td>
                    <td class="number-cell">
                        <span class="self-declared-rate ${getSelfDeclaredRateClass(store.è‡ªæˆ‘å®£å‘Šé”æˆç‡)}">${store.è‡ªæˆ‘å®£å‘Šé”æˆç‡}</span>
                    </td>
                    <td class="number-cell">${formatNumber(store.æ–°å®¢æ¥­ç¸¾)}</td>
                    <td class="number-cell">${formatNumber(store.èˆŠå®¢æ¥­ç¸¾)}</td>
                    <td class="number-cell"><span class="zhonghe-ratio ${getZhongheRatioClass(store.ä¸­å’Œæ¯”ä¾‹)}">${store.ä¸­å’Œæ¯”ä¾‹}</span></td>
                `;
                tbody.appendChild(row);
            });
        }

        function populateCustomerABTable() {
            const tbody = document.getElementById('customer-ab-table');
            if (!tbody) return;
            
            tbody.innerHTML = '';
            
            // ç¯©é¸A+Bçµ„æ•¸æ“š
            const abGroupData = competitionData.filter(store => store.group === 'A' || store.group === 'B');
            // æŒ‰å®¢æˆ¶æ•¸æ’åæ’åºï¼ˆé è¨­ï¼‰
            abGroupData.sort((a, b) => a.å®¢æˆ¶æ•¸æ’å - b.å®¢æˆ¶æ•¸æ’å);
            
            abGroupData.forEach((store) => {
                const isCustomerQualified = store.å®¢æˆ¶æ•¸é–€æª»é”æˆç‡ === 'YES';
                const hasNoPerformance = store.customerScore === 0;

                let rowClass = `group-${store.group.toLowerCase()}`;
                if (hasNoPerformance) rowClass += ' no-performance';
                // é‡‘éŠ€éŠ…ç‰Œæ•ˆæœåªåœ¨é è¨­æ’åºä¸”å‰ä¸‰åæ™‚é¡¯ç¤º
                if ((currentSort.field === null || currentSort.field === 'å®¢æˆ¶æ•¸æ’å') && store.å®¢æˆ¶æ•¸æ’å <= 3 && !hasNoPerformance) {
                    rowClass += ` rank-${store.å®¢æˆ¶æ•¸æ’å}`;
                }

                const row = document.createElement('tr'); 
                row.className = rowClass;

                // å§‹çµ‚é¡¯ç¤ºåŸå§‹é‡‘é¡æ’åï¼Œä¸å—æ’åºå½±éŸ¿
                const rankDisplay = ((currentSort.field === null || currentSort.field === 'å®¢æˆ¶æ•¸æ’å') && store.å®¢æˆ¶æ•¸æ’å <= 3 && !hasNoPerformance) 
                    ? getRankMedal(store.å®¢æˆ¶æ•¸æ’å) 
                    : store.å®¢æˆ¶æ•¸æ’å;

                row.innerHTML = `
                    <td class="number-cell">${rankDisplay}</td>
                    <td class="store-name">${store.storeName}</td>
                    <td>${getGroupBadge(store.group)}</td>
                    <td>${getRegionBadge(store.region)}</td>
                    <td class="number-cell ${isCustomerQualified ? 'qualified' : ''}">${store.customerScore}</td>
                    <td class="number-cell">${store.æ–°å®¢æ•¸}</td>
                    <td class="number-cell">${store.èˆŠå®¢æ•¸}</td>
                    <td class="number-cell"><span class="zhonghe-ratio ${getZhongheRatioClass(store.ä¸­å’Œæ¯”ä¾‹)}">${store.ä¸­å’Œæ¯”ä¾‹}</span></td>
                `;
                tbody.appendChild(row);
            });
        }

        function populateCustomerCTable() {
            const tbody = document.getElementById('customer-c-table');
            if (!tbody) return;
            
            tbody.innerHTML = '';
            
            // ç¯©é¸Cçµ„æ•¸æ“š
            const cGroupData = competitionData.filter(store => store.group === 'C');
            // æŒ‰å®¢æˆ¶æ•¸æ’åæ’åºï¼ˆé è¨­ï¼‰
            cGroupData.sort((a, b) => a.å®¢æˆ¶æ•¸æ’å - b.å®¢æˆ¶æ•¸æ’å);
            
            cGroupData.forEach((store) => {
                const isCustomerQualified = store.å®¢æˆ¶æ•¸é–€æª»é”æˆç‡ === 'YES';
                const hasNoPerformance = store.customerScore === 0;

                let rowClass = `group-${store.group.toLowerCase()}`;
                if (hasNoPerformance) rowClass += ' no-performance';
                // é‡‘éŠ€éŠ…ç‰Œæ•ˆæœåªåœ¨é è¨­æ’åºä¸”å‰ä¸‰åæ™‚é¡¯ç¤º
                if ((currentSort.field === null || currentSort.field === 'å®¢æˆ¶æ•¸æ’å') && store.å®¢æˆ¶æ•¸æ’å <= 3 && !hasNoPerformance) {
                    rowClass += ` rank-${store.å®¢æˆ¶æ•¸æ’å}`;
                }
                
                const row = document.createElement('tr');  
                row.className = rowClass;

                const rankDisplay = ((currentSort.field === null || currentSort.field === 'å®¢æˆ¶æ•¸æ’å') && store.å®¢æˆ¶æ•¸æ’å <= 3 && !hasNoPerformance) 
                    ? getRankMedal(store.å®¢æˆ¶æ•¸æ’å) 
                    : store.å®¢æˆ¶æ•¸æ’å;

                row.innerHTML = `
                    <td class="number-cell">${rankDisplay}</td>
                    <td class="store-name">${store.storeName}</td>
                    <td>${getGroupBadge(store.group)}</td>
                    <td>${getRegionBadge(store.region)}</td>
                    <td class="number-cell ${isCustomerQualified ? 'qualified' : ''}">${store.customerScore}</td>
                    <td class="number-cell">${store.æ–°å®¢æ•¸}</td>
                    <td class="number-cell">${store.èˆŠå®¢æ•¸}</td>
                    <td class="number-cell"><span class="zhonghe-ratio ${getZhongheRatioClass(store.ä¸­å’Œæ¯”ä¾‹)}">${store.ä¸­å’Œæ¯”ä¾‹}</span></td>
                `;
                tbody.appendChild(row);
            });
        }
        function populateRegionTable(region) {
            const tbody = document.getElementById(`region-${region}-table`);
            if (!tbody) return;
            
            tbody.innerHTML = '';
            
            const regionData = competitionData.filter(store => store.region === region);
            // æŒ‰é‡‘é¡æ’åæ’åºï¼ˆé è¨­ï¼‰
            regionData.sort((a, b) => a.é‡‘é¡æ’å - b.é‡‘é¡æ’å);
            
            // åˆå§‹åŒ–ç¸½è¨ˆå€¼
            let totalOriginalAmount = 0;
            let totalNewAmount = 0;
            let totalOldAmount = 0;
            let totalNewCustomers = 0;
            let totalOldCustomers = 0;
            
            regionData.forEach((store) => {
                const isAmountQualified = isAmountQualifiedForStore(store);
                const isCustomerQualified = store.å®¢æˆ¶æ•¸é–€æª»é”æˆç‡ === 'YES';
                const hasNoPerformance = store.amountScore === 0;
                
                // ç´¯åŠ ç¸½è¨ˆ
                const originalAmount = store.æ–°å®¢æ¥­ç¸¾ + store.èˆŠå®¢æ¥­ç¸¾;
                totalOriginalAmount += originalAmount;
                totalNewAmount += store.æ–°å®¢æ¥­ç¸¾;
                totalOldAmount += store.èˆŠå®¢æ¥­ç¸¾;
                totalNewCustomers += store.æ–°å®¢æ•¸;
                totalOldCustomers += store.èˆŠå®¢æ•¸;
                
                let rowClass = `group-${store.group.toLowerCase()}`;
                if (hasNoPerformance) rowClass += ' no-performance';
                
                const row = document.createElement('tr');
                row.className = rowClass;
                
                row.innerHTML = `
                    <td class="number-cell">${store.é‡‘é¡æ’å}</td>
                    <td class="store-name">${store.storeName}</td>
                    <td>${getGroupBadge(store.group)}</td>
                    <td class="number-cell ${isAmountQualified ? 'qualified' : ''}">${formatNumber(store.amountScore)}</td>
                    <td class="number-cell ${isCustomerQualified ? 'qualified' : ''}">${store.customerScore}</td>
                    <td class="number-cell">${formatNumber(store.è‡ªæˆ‘å®£å‘Šç›®æ¨™)}</td>
                    <td class="number-cell">
                        <span class="self-declared-rate ${getSelfDeclaredRateClass(store.è‡ªæˆ‘å®£å‘Šé”æˆç‡)}">${store.è‡ªæˆ‘å®£å‘Šé”æˆç‡}</span>
                    </td>
                    <td class="number-cell">${formatNumber(originalAmount)}</td>
                    <td class="number-cell">${formatNumber(store.æ–°å®¢æ¥­ç¸¾)}</td>
                    <td class="number-cell">${formatNumber(store.èˆŠå®¢æ¥­ç¸¾)}</td>
                    <td class="number-cell">${store.æ–°å®¢æ•¸}</td>
                    <td class="number-cell">${store.èˆŠå®¢æ•¸}</td>
                    <td class="number-cell"><span class="zhonghe-ratio ${getZhongheRatioClass(store.ä¸­å’Œæ¯”ä¾‹)}">${store.ä¸­å’Œæ¯”ä¾‹}</span></td>
                `;
                tbody.appendChild(row);
            });
            
            // æ·»åŠ ç¸½è¨ˆåˆ—
            const totalRow = document.createElement('tr');
            totalRow.className = 'total-row';
            const storeCount = regionData.length;
            const avgOriginalAmount = storeCount > 0 ? Math.round(totalOriginalAmount / storeCount) : 0;
            
            totalRow.innerHTML = `
                <td class="number-cell">-</td>
                <td class="store-name">ç¸½è¨ˆ (${storeCount}å®¶)</td>
                <td>-</td>
                <td class="number-cell">-</td>
                <td class="number-cell">-</td>
                <td class="number-cell">-</td>
                <td class="number-cell">-</td>
                <td class="number-cell">
                    ${formatNumber(totalOriginalAmount)}
                    <br>
                    <span style="font-size: 0.85em; color: #666;">
                        å¹³å‡: ${formatNumber(avgOriginalAmount)}
                    </span>
                </td>
                <td class="number-cell">${formatNumber(totalNewAmount)}</td>
                <td class="number-cell">${formatNumber(totalOldAmount)}</td>
                <td class="number-cell">${totalNewCustomers}</td>
                <td class="number-cell">${totalOldCustomers}</td>
                <td class="number-cell">-</td>
            `;
            tbody.appendChild(totalRow);
        }

        function populateRegionTableWithData(region, data) {
            const tbody = document.getElementById(`region-${region}-table`);
            if (!tbody) return;
            
            tbody.innerHTML = '';
            
            // è¨ˆç®—éœ€è¦åŠ ç¸½çš„æ¬„ä½
            let totalOriginalAmount = 0;
            let totalNewAmount = 0;
            let totalOldAmount = 0;
            let totalNewCustomers = 0;
            let totalOldCustomers = 0;
            
            // è¨ˆç®—è©² data çš„å¹³å‡æ’åæ˜ å°„ï¼ˆç”¨æ–¼æ’åºå¾Œçš„é¡¯ç¤ºï¼‰
            const rankMap = computeAvgRankMap(data);

            data.forEach((store) => {
                const isAmountQualified = isAmountQualifiedForStore(store);
                const isCustomerQualified = store.å®¢æˆ¶æ•¸é–€æª»é”æˆç‡ === 'YES';
                const hasNoPerformance = store.amountScore === 0;
                
                let rowClass = `group-${store.group.toLowerCase()}`;
                if (hasNoPerformance) rowClass += ' no-performance';
                if ((currentSort.field === null || currentSort.field === 'é‡‘é¡æ’å') && store.é‡‘é¡æ’å <= 3 && !hasNoPerformance) {
                    rowClass += ` rank-${store.é‡‘é¡æ’å}`;
                }
                const row = document.createElement('tr');
                row.className = rowClass;
                // å€åŸŸåˆ†æä¸­çš„æ’åé¡¯ç¤º
                const rankDisplay = ((currentSort.field === null || currentSort.field === 'é‡‘é¡æ’å') && store.é‡‘é¡æ’å <= 3 && !hasNoPerformance) 
                    ? getRankMedal(store.é‡‘é¡æ’å) 
                    : store.é‡‘é¡æ’å;

                // ç´¯åŠ ç¸½è¨ˆ
                const originalAmount = store.æ–°å®¢æ¥­ç¸¾ + store.èˆŠå®¢æ¥­ç¸¾;
                totalOriginalAmount += originalAmount;
                totalNewAmount += store.æ–°å®¢æ¥­ç¸¾;
                totalOldAmount += store.èˆŠå®¢æ¥­ç¸¾;
                totalNewCustomers += store.æ–°å®¢æ•¸;
                totalOldCustomers += store.èˆŠå®¢æ•¸;

                row.innerHTML = `
                    <td class="number-cell">${store.é‡‘é¡æ’å}</td>
                    <td class="store-name">${store.storeName}</td>
                    <td>${getGroupBadge(store.group)}</td>
                    <td class="number-cell ${isAmountQualified ? 'qualified' : ''}">${formatNumber(store.amountScore)}</td>
                    <td class="number-cell ${isCustomerQualified ? 'qualified' : ''}">${store.customerScore}</td>
                    <td class="number-cell">${formatNumber(store.è‡ªæˆ‘å®£å‘Šç›®æ¨™)}</td>
                    <td class="number-cell">
                        <span class="self-declared-rate ${getSelfDeclaredRateClass(store.è‡ªæˆ‘å®£å‘Šé”æˆç‡)}">${store.è‡ªæˆ‘å®£å‘Šé”æˆç‡}</span>
                    </td>
                    <td class="number-cell">${formatNumber(originalAmount)}</td>
                    <td class="number-cell">${formatNumber(store.æ–°å®¢æ¥­ç¸¾)}</td>
                    <td class="number-cell">${formatNumber(store.èˆŠå®¢æ¥­ç¸¾)}</td>
                    <td class="number-cell">${store.æ–°å®¢æ•¸}</td>
                    <td class="number-cell">${store.èˆŠå®¢æ•¸}</td>
                    <td class="number-cell"><span class="zhonghe-ratio ${getZhongheRatioClass(store.ä¸­å’Œæ¯”ä¾‹)}">${store.ä¸­å’Œæ¯”ä¾‹}</span></td>
                `;
                tbody.appendChild(row);
            });
        }

        // åˆå§‹åŒ–æ’åºåŠŸèƒ½
        function initializeSorting() {
            document.addEventListener('click', function(e) {
                if (e.target.classList.contains('sortable')) {
                    const field = e.target.getAttribute('data-field');
                    sortTable(field, e.target);
                }
            });
        }

        // æ’åºè¡¨æ ¼
        function sortTable(field, headerElement) {
            // æ›´æ–°æ’åºæ–¹å‘
            if (currentSort.field === field) {
                currentSort.direction = currentSort.direction === 'asc' ? 'desc' : 'asc';
            } else {
                currentSort.direction = 'asc';
                currentSort.field = field;
            }

            // æ›´æ–°è¡¨é ­æ¨£å¼
            document.querySelectorAll('th.sortable').forEach(th => {
                th.classList.remove('sort-asc', 'sort-desc');
            });
            headerElement.classList.add(currentSort.direction === 'asc' ? 'sort-asc' : 'sort-desc');

            // ç²å–ç•¶å‰é¡¯ç¤ºçš„æ•¸æ“š
            let currentData = [];
            if (currentMainTab === 'amount') {
                const group = currentGroupTab.replace('group-', '').toUpperCase();
                currentData = competitionData.filter(store => store.group === group);
            } else if (currentMainTab === 'customer') {
                if (currentGroupTab === 'customer-ab') {
                    currentData = competitionData.filter(store => store.group === 'A' || store.group === 'B');
                } else if (currentGroupTab === 'customer-c') {
                    currentData = competitionData.filter(store => store.group === 'C');
                }
            } else if (currentMainTab === 'region') {
                const region = currentGroupTab.replace('region-', '');
                currentData = competitionData.filter(store => store.region === region);
            }

            // æ’åºæ•¸æ“š
            currentData.sort((a, b) => {
                let valueA, valueB;

                switch(field) {
                    case 'storeName':
                        valueA = a.storeName;
                        valueB = b.storeName;
                        break;
                    case 'region':
                        valueA = a.region;
                        valueB = b.region;
                        break;
                    case 'amountScore':
                        valueA = a.amountScore;
                        valueB = b.amountScore;
                        break;
                    case 'group':
                        valueA = a.group;
                        valueB = b.group;
                        break;
                    case 'customerScore':
                        valueA = a.customerScore;
                        valueB = b.customerScore;
                        break;
                    case 'é‡‘é¡æ’å':
                        valueA = a.é‡‘é¡æ’å;
                        valueB = b.é‡‘é¡æ’å;
                        break;
                    case 'å®¢æˆ¶æ•¸æ’å':
                        valueA = a.å®¢æˆ¶æ•¸æ’å;
                        valueB = b.å®¢æˆ¶æ•¸æ’å;
                        break;
                    case 'åŸå§‹æ¥­ç¸¾':
                        valueA = a.æ–°å®¢æ¥­ç¸¾ + a.èˆŠå®¢æ¥­ç¸¾;
                        valueB = b.æ–°å®¢æ¥­ç¸¾ + b.èˆŠå®¢æ¥­ç¸¾;
                        break;
                    case 'æ–°å®¢æ¥­ç¸¾':
                        valueA = a.æ–°å®¢æ¥­ç¸¾;
                        valueB = b.æ–°å®¢æ¥­ç¸¾;
                        break;
                    case 'è‡ªæˆ‘å®£å‘Šç›®æ¨™':
                        valueA = a.è‡ªæˆ‘å®£å‘Šç›®æ¨™;
                        valueB = b.è‡ªæˆ‘å®£å‘Šç›®æ¨™;
                        break;
                    case 'è‡ªæˆ‘å®£å‘Šé”æˆç‡':
                        valueA = parseFloat(a.è‡ªæˆ‘å®£å‘Šé”æˆç‡.replace('%', ''));
                        valueB = parseFloat(b.è‡ªæˆ‘å®£å‘Šé”æˆç‡.replace('%', ''));
                        break;
                    case 'èˆŠå®¢æ¥­ç¸¾':
                        valueA = a.èˆŠå®¢æ¥­ç¸¾;
                        valueB = b.èˆŠå®¢æ¥­ç¸¾;
                        break;
                    case 'æ–°å®¢æ•¸':
                        valueA = a.æ–°å®¢æ•¸;
                        valueB = b.æ–°å®¢æ•¸;
                        break;
                    case 'èˆŠå®¢æ•¸':
                        valueA = a.èˆŠå®¢æ•¸;
                        valueB = b.èˆŠå®¢æ•¸;
                        break;
                    case 'ä¸­å’Œæ¯”ä¾‹':
                        valueA = parseFloat(a.ä¸­å’Œæ¯”ä¾‹.replace('%', ''));
                        valueB = parseFloat(b.ä¸­å’Œæ¯”ä¾‹.replace('%', ''));
                        break;
                    case 'augustScore':
                        // ç›´æ¥ç²å–8æœˆä»½çš„é‡‘é¡ç©åˆ†
                        const augustStoreA = augustCompetitionData.find(store => store.storeName === a.storeName);
                        const augustStoreB = augustCompetitionData.find(store => store.storeName === b.storeName);
                        valueA = augustStoreA ? augustStoreA.amountScore : -1;
                        valueB = augustStoreB ? augustStoreB.amountScore : -1;
                        break;
                    case 'avgScore':
                        // å¹³å‡ï¼šè‹¥æœ‰8æœˆæ•¸æ“šå‰‡å–(8æœˆ + 9æœˆ)/2ï¼Œå¦å‰‡åªç”¨9æœˆ
                        const aAug = (augustCompetitionData.find(s => s.storeName === a.storeName) || {}).amountScore;
                        const bAug = (augustCompetitionData.find(s => s.storeName === b.storeName) || {}).amountScore;
                        const aSept = a.amountScore || 0;
                        const bSept = b.amountScore || 0;
                        valueA = (typeof aAug === 'number') ? Math.round((aAug + aSept) / 2) : aSept;
                        valueB = (typeof bAug === 'number') ? Math.round((bAug + bSept) / 2) : bSept;
                        break;
                    default:
                        return 0;
                }

                // æ¯”è¼ƒé‚è¼¯
                if (typeof valueA === 'string') {
                    return currentSort.direction === 'asc' 
                        ? valueA.localeCompare(valueB)
                        : valueB.localeCompare(valueA);
                } else {
                    return currentSort.direction === 'asc' 
                        ? valueA - valueB
                        : valueB - valueA;
                }
            });

            // é‡æ–°å¡«å……è¡¨æ ¼
            if (currentMainTab === 'amount') {
                const group = currentGroupTab.replace('group-', '').toUpperCase();
                populateGroupTableWithData(group, currentData);
            } else if (currentMainTab === 'customer') {
                if (currentGroupTab === 'customer-ab') {
                    populateCustomerABTableWithData(currentData);
                } else if (currentGroupTab === 'customer-c') {
                    populateCustomerCTableWithData(currentData);
                }
            } else if (currentMainTab === 'region') {
                const region = currentGroupTab.replace('region-', '');
                populateRegionTableWithData(region, currentData);
            }

            // æ›´æ–°æ’åºè³‡è¨Š
            updateSortInfo(field);
        }

        // ä½¿ç”¨æŒ‡å®šæ•¸æ“šå¡«å……çµ„åˆ¥è¡¨æ ¼
        function populateGroupTableWithData(group, data) {
            const tbody = document.getElementById(`group-${group.toLowerCase()}-table`);
            if (!tbody) return;
            
            tbody.innerHTML = '';
            
            // è¨ˆç®—è©² data çš„å¹³å‡æ’åæ˜ å°„ï¼ˆç”¨æ–¼æ’åºå¾Œçš„é¡¯ç¤ºï¼‰
            const rankMap = computeAvgRankMap(data);
            
            data.forEach((store) => {
                const isAmountQualified = isAmountQualifiedForStore(store);
                const hasNoPerformance = store.amountScore === 0;
                
                let rowClass = `group-${store.group.toLowerCase()}`;
                // é‡‘éŠ€éŠ…ç‰Œæ•ˆæœåªåœ¨é è¨­æ’åºä¸”å‰ä¸‰åæ™‚é¡¯ç¤º
                if ((currentSort.field === null || currentSort.field === 'é‡‘é¡æ’å') && store.é‡‘é¡æ’å <= 3 && !hasNoPerformance) {
                    rowClass += ` rank-${store.é‡‘é¡æ’å}`;
                }
                
                const row = document.createElement('tr');
                row.className = rowClass;
                
                // é¡¯ç¤ºä»¥å¹³å‡ç©åˆ†è¨ˆç®—çš„æ’åï¼ˆåŒåˆ†åŒåæ¬¡ï¼Œä¸‹ä¸€åæ¬¡æ•¸é‡æ¸›å°‘ï¼‰
                const avgRank = rankMap[store.storeName] || store.é‡‘é¡æ’å;
                const rankDisplay = ((currentSort.field === null || currentSort.field === 'é‡‘é¡æ’å') && avgRank <= 3 && !hasNoPerformance)
                    ? getRankMedal(avgRank)
                    : avgRank;
                
                // å–å¾—å…«æœˆä»½ç©åˆ†ï¼Œè¨ˆç®—å¹³å‡
                const augScore = getAugustScore(store.storeName);
                const isAugQualified = isAmountQualified;
                const augDisplay = (typeof augScore === 'number') ? formatNumber(augScore) : '-';

                const septScore = store.amountScore;
                const isSeptQualified = isAmountQualified;
                const septDisplay = formatNumber(septScore);

                const avgScore = (typeof augScore === 'number') ? Math.round(((augScore || 0) + (septScore || 0)) / 2) : septScore;
                const avgDisplay = typeof avgScore === 'number' ? formatNumber(avgScore) : '-';
                const isAvgQualified = isScoreQualifiedForStore(store, avgScore);

                row.innerHTML = `
                    <td class="number-cell">${rankDisplay}</td>
                    <td class="store-name">${store.storeName}</td>
                    <td>${getRegionBadge(store.region)}</td>
                    <td class="number-cell ${isAugQualified ? 'qualified' : ''}">${augDisplay}</td>
                    <td class="number-cell ${isSeptQualified ? 'qualified' : ''}">${septDisplay}</td>
                    <td class="number-cell ${isAvgQualified ? 'qualified' : ''}">${avgDisplay}</td>
                    <td class="number-cell">${formatNumber(store.è‡ªæˆ‘å®£å‘Šç›®æ¨™)}</td>
                    <td class="number-cell">
                        <span class="self-declared-rate ${getSelfDeclaredRateClass(store.è‡ªæˆ‘å®£å‘Šé”æˆç‡)}">${store.è‡ªæˆ‘å®£å‘Šé”æˆç‡}</span>
                    </td>
                    <td class="number-cell">${formatNumber(store.æ–°å®¢æ¥­ç¸¾)}</td>
                    <td class="number-cell">${formatNumber(store.èˆŠå®¢æ¥­ç¸¾)}</td>
                    <td class="number-cell"><span class="zhonghe-ratio ${getZhongheRatioClass(store.ä¸­å’Œæ¯”ä¾‹)}">${store.ä¸­å’Œæ¯”ä¾‹}</span></td>
                `;
                tbody.appendChild(row);
            });
        }

        // ä½¿ç”¨æŒ‡å®šæ•¸æ“šå¡«å……å®¢æˆ¶A+Bè¡¨æ ¼
        function populateCustomerABTableWithData(data) {
            const tbody = document.getElementById('customer-ab-table');
            if (!tbody) return;
            
            tbody.innerHTML = '';
            
            data.forEach((store, index) => {
                const isCustomerQualified = store.å®¢æˆ¶æ•¸é–€æª»é”æˆç‡ === 'YES';
                const hasNoPerformance = store.customerScore === 0;
                
                let rowClass = `group-${store.group.toLowerCase()}`;
                if (hasNoPerformance) rowClass += ' no-performance';
                // é‡‘éŠ€éŠ…ç‰Œæ•ˆæœåªåœ¨é è¨­æ’åºä¸”å‰ä¸‰åæ™‚é¡¯ç¤º
                if ((currentSort.field === null || currentSort.field === 'å®¢æˆ¶æ•¸æ’å') && store.å®¢æˆ¶æ•¸æ’å <= 3 && !hasNoPerformance) {
                    rowClass += ` rank-${store.å®¢æˆ¶æ•¸æ’å}`;
                }
                
                const row = document.createElement('tr');
                row.className = rowClass;
                
                // å§‹çµ‚é¡¯ç¤ºåŸå§‹å®¢æˆ¶æ•¸æ’åï¼Œä¸å—æ’åºå½±éŸ¿
                const rankDisplay = ((currentSort.field === null || currentSort.field === 'å®¢æˆ¶æ•¸æ’å') && store.å®¢æˆ¶æ•¸æ’å <= 3 && !hasNoPerformance) 
                    ? getRankMedal(store.å®¢æˆ¶æ•¸æ’å) 
                    : store.å®¢æˆ¶æ•¸æ’å;
                
                row.innerHTML = `
                    <td class="number-cell">${rankDisplay}</td>
                    <td class="store-name">${store.storeName}</td>
                    <td>${getGroupBadge(store.group)}</td>
                    <td>${getRegionBadge(store.region)}</td>
                    <td class="number-cell ${isCustomerQualified ? 'qualified' : ''}">${store.customerScore}</td>
                    <td class="number-cell">${store.æ–°å®¢æ•¸}</td>
                    <td class="number-cell">${store.èˆŠå®¢æ•¸}</td>
                    <td class="number-cell"><span class="zhonghe-ratio ${getZhongheRatioClass(store.ä¸­å’Œæ¯”ä¾‹)}">${store.ä¸­å’Œæ¯”ä¾‹}</span></td>

                `;
                tbody.appendChild(row);
            });
        }

        // ä½¿ç”¨æŒ‡å®šæ•¸æ“šå¡«å……å®¢æˆ¶Cçµ„è¡¨æ ¼
        function populateCustomerCTableWithData(data) {
            const tbody = document.getElementById('customer-c-table');
            if (!tbody) return;
            
            tbody.innerHTML = '';
            
            data.forEach((store, index) => {
                const isCustomerQualified = store.å®¢æˆ¶æ•¸é–€æª»é”æˆç‡ === 'YES';
                const hasNoPerformance = store.customerScore === 0;
                
                let rowClass = `group-${store.group.toLowerCase()}`;
                if (hasNoPerformance) rowClass += ' no-performance';
                // é‡‘éŠ€éŠ…ç‰Œæ•ˆæœåªåœ¨é è¨­æ’åºä¸”å‰ä¸‰åæ™‚é¡¯ç¤º
                if ((currentSort.field === null || currentSort.field === 'å®¢æˆ¶æ•¸æ’å') && store.å®¢æˆ¶æ•¸æ’å <= 3 && !hasNoPerformance) {
                    rowClass += ` rank-${store.å®¢æˆ¶æ•¸æ’å}`;
                }
                
                const row = document.createElement('tr');
                row.className = rowClass;
                
                // å§‹çµ‚é¡¯ç¤ºåŸå§‹å®¢æˆ¶æ•¸æ’åï¼Œä¸å—æ’åºå½±éŸ¿
                const rankDisplay = ((currentSort.field === null || currentSort.field === 'å®¢æˆ¶æ•¸æ’å') && store.å®¢æˆ¶æ•¸æ’å <= 3 && !hasNoPerformance) 
                    ? getRankMedal(store.å®¢æˆ¶æ•¸æ’å) 
                    : store.å®¢æˆ¶æ•¸æ’å;
                
                row.innerHTML = `
                    <td class="number-cell">${rankDisplay}</td>
                    <td class="store-name">${store.storeName}</td>
                    <td>${getGroupBadge(store.group)}</td>
                    <td>${getRegionBadge(store.region)}</td>
                    <td class="number-cell ${isCustomerQualified ? 'qualified' : ''}">${store.customerScore}</td>
                    <td class="number-cell">${store.æ–°å®¢æ•¸}</td>
                    <td class="number-cell">${store.èˆŠå®¢æ•¸}</td>
                    <td class="number-cell"><span class="zhonghe-ratio ${getZhongheRatioClass(store.ä¸­å’Œæ¯”ä¾‹)}">${store.ä¸­å’Œæ¯”ä¾‹}</span></td>
                `;
                tbody.appendChild(row);
            });

            // æ·»åŠ ç¸½è¨ˆåˆ—
            const totalRow = document.createElement('tr');
            totalRow.className = 'total-row';
            totalRow.innerHTML = `
                <td class="number-cell">-</td>
                <td class="store-name">ç¸½è¨ˆ</td>
                <td>-</td>
                <td class="number-cell">-</td>
                <td class="number-cell">-</td>
                <td class="number-cell">-</td>
                <td class="number-cell">-</td>
                <td class="number-cell">${formatNumber(totalOriginalAmount)}</td>
                <td class="number-cell">${formatNumber(totalNewAmount)}</td>
                <td class="number-cell">${formatNumber(totalOldAmount)}</td>
                <td class="number-cell">${totalNewCustomers}</td>
                <td class="number-cell">${totalOldCustomers}</td>
                <td class="number-cell">-</td>
            `;
            tbody.appendChild(totalRow);
        }

        // æ›´æ–°æ’åºè³‡è¨Š
        function updateSortInfo(field) {
            const fieldNames = {
                'storeName': 'é–€å¸‚åç¨±',
                'region': 'å€åŸŸ',
                'group': 'çµ„åˆ¥',
                'amountScore': '9æœˆé‡‘é¡ç©åˆ†',
                'augustScore': '8æœˆé‡‘é¡ç©åˆ†',
                'avgScore': 'å¹³å‡ç©åˆ†',
                'customerScore': 'å®¢æˆ¶æ•¸ç©åˆ†',
                'æ–°å®¢æ¥­ç¸¾': 'æ–°å®¢æ¥­ç¸¾',
                'èˆŠå®¢æ¥­ç¸¾': 'èˆŠå®¢æ¥­ç¸¾',
                'è‡ªæˆ‘å®£å‘Šç›®æ¨™': 'è‡ªæˆ‘å®£å‘Šç›®æ¨™',
                'è‡ªæˆ‘å®£å‘Šé”æˆç‡': 'è‡ªæˆ‘å®£å‘Šé”æˆç‡',
                'æ–°å®¢æ•¸': 'æ–°å®¢æ•¸',
                'èˆŠå®¢æ•¸': 'èˆŠå®¢æ•¸',
                'ä¸­å’Œæ¯”ä¾‹': 'ä¸­å’Œç™¼åŒ…æ¯”ä¾‹',
                'é‡‘é¡æ’å': 'é‡‘é¡æ’å',
                'å®¢æˆ¶æ•¸æ’å': 'å®¢æˆ¶æ•¸æ’å',
                'åŸå§‹æ¥­ç¸¾': 'åŸå§‹æ¥­ç¸¾'

            };
            
            const direction = currentSort.direction === 'asc' ? 'å‡åº' : 'é™åº';
            const sortInfo = document.getElementById(`sort-info-${currentGroupTab}`);
            
            if (sortInfo) {
                sortInfo.textContent = `ç›®å‰æ’åºï¼šä¾${fieldNames[field]} (${direction})`;
            }
        }

        // æ›´æ–°çµ„åˆ¥çµ±è¨ˆè³‡è¨Š
        function updateGroupStats() {
            // è¨ˆç®—å„çµ„çš„é‡‘é¡ç©åˆ†ç¸½å’Œ
            const groups = ['A', 'B', 'C'];
            groups.forEach(group => {
                const groupData = competitionData.filter(store => store.group === group);
                const totalAmount = groupData.reduce((sum, store) => sum + store.amountScore, 0);
                // æ›´æ–°çµ„åˆ¥æ¨™ç±¤ä¸­çš„é‡‘é¡ç¸½å’Œ
                const amountElement = document.getElementById(`group-${group.toLowerCase()}-amount`);
                if (amountElement) {
                    amountElement.textContent = formatNumber(totalAmount);
                }
                // éš±è—åŸæœ‰çš„çµ±è¨ˆå€å¡Š
                const statsElement = document.getElementById(`group-${group.toLowerCase()}-stats`);
                if (statsElement) {
                    statsElement.style.display = 'none';
                }
            });
        }

        // æ›´æ–°çµ±è¨ˆè³‡è¨Š
        function updateStatisticsInfo() {
            const totalAmount = document.getElementById('total-amount');
            const growthRate = document.getElementById('growth-rate');
            
            if (totalAmount && growthRate && window.competitionStatistics) {
                totalAmount.textContent = formatNumber(window.competitionStatistics.åŸå§‹ç¸½æ¥­ç¸¾åŠ ç¸½);
                const growth = ((window.competitionStatistics.åŸå§‹ç¸½æ¥­ç¸¾åŠ ç¸½ - 300909) / 300909 * 100).toFixed(1);
                growthRate.textContent = `${growth}%`;
                growthRate.parentElement.classList.add(growth >= 0 ? 'positive' : 'negative');
            }
        }

        // ç²å–8æœˆä»½çš„é‡‘é¡ç©åˆ†
        function getAugustScore(storeName) {
            try {
                if (typeof augustCompetitionData === 'undefined') {
                    console.error('augustCompetitionData is undefined');
                    return '-';
                }
                if (!Array.isArray(augustCompetitionData)) {
                    console.error('augustCompetitionData is not an array:', augustCompetitionData);
                    return '-';
                }
                console.log('Looking for store:', storeName, 'in', augustCompetitionData.length, 'stores');
                const augustStore = augustCompetitionData.find(store => store.storeName === storeName);
                if (!augustStore) {
                    console.log('Store not found:', storeName);
                    return '-';
                }
                const score = augustStore.amountScore;
                console.log('Found score:', score, 'for store:', storeName);
                return score;
            } catch (error) {
                console.error('Error in getAugustScore:', error);
                return '-';
            }
        }

        // åˆå§‹åŒ–é é¢ï¼ˆåœ¨ DOMContentLoaded å¾ŒåŸ·è¡Œï¼‰
        document.addEventListener('DOMContentLoaded', function() {
            console.log('DOM ready â€” initializing page');

            // åŸºæœ¬æª¢æŸ¥ï¼šç¢ºä¿è³‡æ–™æª”å·²ç”±<script>è¼‰å…¥
            const missing = [];
            if (typeof competitionData === 'undefined') missing.push('competition-data.js');
            if (typeof augustCompetitionData === 'undefined') missing.push('competition-data-aug.js');

            if (missing.length) {
                console.error('Missing data files:', missing.join(', '));
                document.querySelector('.container').innerHTML = `
                    <div style="padding: 50px; text-align: center; color: #e74c3c;">
                        <h2>âŒ æ•¸æ“šè¼‰å…¥å¤±æ•—</h2>
                        <p>ç¼ºå°‘ä¸‹åˆ—è³‡æ–™æª”ï¼š${missing.join(', ')}</p>
                        <p>è«‹ç¢ºèªé€™äº›æª”æ¡ˆèˆ‡ HTML ä½æ–¼åŒä¸€ç›®éŒ„ï¼Œä¸¦æ­£ç¢ºè¼‰å…¥ã€‚</p>
                    </div>
                `;
                return;
            }

            // ä¸€åˆ‡æ­£å¸¸ï¼šè¼‰å…¥åˆå§‹ç•«é¢èˆ‡åŠŸèƒ½
            try {
                loadTabContent();
                initializeSorting();
                updateStatisticsInfo();
                updateGroupStats();
            } catch (err) {
                console.error('Error during initialization:', err);
                document.querySelector('.container').innerHTML = `
                    <div style="padding: 50px; text-align: center; color: #e74c3c;">
                        <h2>âŒ åˆå§‹åŒ–å¤±æ•—</h2>
                        <pre style="text-align:left; max-width:800px; margin:0 auto;">${err}</pre>
                    </div>
                `;
            }
        });
    </script>
</body>
</html>
                    